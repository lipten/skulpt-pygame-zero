(function () {function Mb(a){return a&&a.__esModule?{d:a.default}:{d:a}}function Ac(name){var err=new Error("Cannot find module '"+name+"'");err.code="MODULE_NOT_FOUND";throw err}var Bc=this;var Nb={};var ra={};var Yd,Ob,ha={};!function(e,t){"object"==typeof ha?ha=t(function(){try{return Ac("poly-decomp")}catch(e){}}()):"function"==typeof Ob&&Ob.amd?Ob("Matter",["poly-decomp"],t):"object"==typeof ha?(Yd=t(function(){try{return Ac("poly-decomp")}catch(e){}}()),ha.Matter=Yd):e.Matter=t(e.decomp)}(ha,function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t){var n={};e.exports=n,function(){n._nextId=0,n._seed=0,n._nowStartTime=+new Date,n.extend=function(e,t){var i,o;"boolean"==typeof t?(i=2,o=t):(i=1,o=!0);for(var r=i;r<arguments.length;r++){var s=arguments[r];if(s)for(var a in s)o&&s[a]&&s[a].constructor===Object?e[a]&&e[a].constructor!==Object?e[a]=s[a]:(e[a]=e[a]||{},n.extend(e[a],o,s[a])):e[a]=s[a]}return e},n.clone=function(e,t){return n.extend({},t,e)},n.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},n.values=function(e){var t=[];if(Object.keys){for(var n=Object.keys(e),i=0;i<n.length;i++)t.push(e[n[i]]);return t}for(var o in e)t.push(e[o]);return t},n.get=function(e,t,n,i){t=t.split(".").slice(n,i);for(var o=0;o<t.length;o+=1)e=e[t[o]];return e},n.set=function(e,t,i,o,r){var s=t.split(".").slice(o,r);return n.get(e,t,0,-1)[s[s.length-1]]=i,i},n.shuffle=function(e){for(var t=e.length-1;t>0;t--){var i=Math.floor(n.random()*(t+1)),o=e[t];e[t]=e[i],e[i]=o}return e},n.choose=function(e){return e[Math.floor(n.random()*e.length)]},n.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.isFunction=function(e){return"function"==typeof e},n.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},n.isString=function(e){return"[object String]"===toString.call(e)},n.clamp=function(e,t,n){return e<t?t:e>n?n:e},n.sign=function(e){return e<0?-1:1},n.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-n._nowStartTime},n.random=function(t,n){return n=void 0!==n?n:1,(t=void 0!==t?t:0)+e()*(n-t)};var e=function(){return n._seed=(9301*n._seed+49297)%233280,n._seed/233280};n.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},n.logLevel=1,n.log=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.info=function(){console&&n.logLevel>0&&n.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.warn=function(){console&&n.logLevel>0&&n.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},n.nextId=function(){return n._nextId++},n.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},n.map=function(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i+=1)n.push(t(e[i]));return n},n.topologicalSort=function(e){var t=[],i=[],o=[];for(var r in e)i[r]||o[r]||n._topologicalSort(r,i,o,e,t);return t},n._topologicalSort=function(e,t,i,o,r){var s=o[e]||[];i[e]=!0;for(var a=0;a<s.length;a+=1){var l=s[a];i[l]||t[l]||n._topologicalSort(l,t,i,o,r)}i[e]=!1,t[e]=!0,r.push(e)},n.chain=function(){for(var e=[],t=0;t<arguments.length;t+=1){var n=arguments[t];n._chained?e.push.apply(e,n._chained):e.push(n)}var i=function(){for(var t,n=new Array(arguments.length),i=0,o=arguments.length;i<o;i++)n[i]=arguments[i];for(i=0;i<e.length;i+=1){var r=e[i].apply(t,n);void 0!==r&&(t=r)}return t};return i._chained=e,i},n.chainPathBefore=function(e,t,i){return n.set(e,t,n.chain(i,n.get(e,t)))},n.chainPathAfter=function(e,t,i){return n.set(e,t,n.chain(n.get(e,t),i))}}()},function(e,t){var n={};e.exports=n,n.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var i=0;i<t.length;i++){var o=t[i];o.x>e.max.x&&(e.max.x=o.x),o.x<e.min.x&&(e.min.x=o.x),o.y>e.max.y&&(e.max.y=o.y),o.y<e.min.y&&(e.min.y=o.y)}n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var n=e.max.x-e.min.x,i=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+i}},function(e,t){var n={};e.exports=n,n.create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,n){var i=Math.cos(t),o=Math.sin(t);n||(n={});var r=e.x*i-e.y*o;return n.y=e.x*o+e.y*i,n.x=r,n},n.rotateAbout=function(e,t,n,i){var o=Math.cos(t),r=Math.sin(t);i||(i={});var s=n.x+((e.x-n.x)*o-(e.y-n.y)*r);return i.y=n.y+((e.x-n.x)*r+(e.y-n.y)*o),i.x=s,i},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},n.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},n.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(e,t,n){var i={};e.exports=i;var o=n(2),r=n(0);i.create=function(e,t){for(var n=[],i=0;i<e.length;i++){var o=e[i],r={x:o.x,y:o.y,index:i,body:t,isInternal:!1};n.push(r)}return n},i.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function(e,t,i){n.push({x:parseFloat(t),y:parseFloat(i)})}),i.create(n,t)},i.centre=function(e){for(var t,n,r,s=i.area(e,!0),a={x:0,y:0},l=0;l<e.length;l++)r=(l+1)%e.length,t=o.cross(e[l],e[r]),n=o.mult(o.add(e[l],e[r]),t),a=o.add(a,n);return o.div(a,6*s)},i.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return o.div(t,e.length)},i.area=function(e,t){for(var n=0,i=e.length-1,o=0;o<e.length;o++)n+=(e[i].x-e[o].x)*(e[i].y+e[o].y),i=o;return t?n/2:Math.abs(n)/2},i.inertia=function(e,t){for(var n,i,r=0,s=0,a=e,l=0;l<a.length;l++)i=(l+1)%a.length,r+=(n=Math.abs(o.cross(a[i],a[l])))*(o.dot(a[i],a[i])+o.dot(a[i],a[l])+o.dot(a[l],a[l])),s+=n;return t/6*(r/s)},i.translate=function(e,t,n){var i;if(n)for(i=0;i<e.length;i++)e[i].x+=t.x*n,e[i].y+=t.y*n;else for(i=0;i<e.length;i++)e[i].x+=t.x,e[i].y+=t.y;return e},i.rotate=function(e,t,n){if(0!==t){for(var i=Math.cos(t),o=Math.sin(t),r=0;r<e.length;r++){var s=e[r],a=s.x-n.x,l=s.y-n.y;s.x=n.x+(a*i-l*o),s.y=n.y+(a*o+l*i)}return e}},i.contains=function(e,t){for(var n=0;n<e.length;n++){var i=e[n],o=e[(n+1)%e.length];if((t.x-i.x)*(o.y-i.y)+(t.y-i.y)*(i.x-o.x)>0)return!1}return!0},i.scale=function(e,t,n,r){if(1===t&&1===n)return e;var s,a;r=r||i.centre(e);for(var l=0;l<e.length;l++)s=e[l],a=o.sub(s,r),e[l].x=r.x+a.x*t,e[l].y=r.y+a.y*n;return e},i.chamfer=function(e,t,n,i,s){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,i=i||2,s=s||14;for(var a=[],l=0;l<e.length;l++){var c=e[l-1>=0?l-1:e.length-1],d=e[l],u=e[(l+1)%e.length],p=t[l<t.length?l:t.length-1];if(0!==p){var f=o.normalise({x:d.y-c.y,y:c.x-d.x}),v=o.normalise({x:u.y-d.y,y:d.x-u.x}),m=Math.sqrt(2*Math.pow(p,2)),y=o.mult(r.clone(f),p),g=o.normalise(o.mult(o.add(f,v),.5)),x=o.sub(d,o.mult(g,m)),h=n;-1===n&&(h=1.75*Math.pow(p,.32)),(h=r.clamp(h,i,s))%2==1&&(h+=1);for(var b=Math.acos(o.dot(f,v))/h,w=0;w<h;w++)a.push(o.add(o.rotate(y,b*w),x))}else a.push(d)}return a},i.clockwiseSort=function(e){var t=i.mean(e);return e.sort(function(e,n){return o.angle(t,e)-o.angle(t,n)}),e},i.isConvex=function(e){var t,n,i,o,r=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(i=(t+2)%s,o=(e[n=(t+1)%s].x-e[t].x)*(e[i].y-e[n].y),(o-=(e[n].y-e[t].y)*(e[i].x-e[n].x))<0?r|=1:o>0&&(r|=2),3===r)return!1;return 0!==r||null},i.hull=function(e){var t,n,i=[],r=[];for((e=e.slice(0)).sort(function(e,t){var n=e.x-t.x;return 0!==n?n:e.y-t.y}),n=0;n<e.length;n+=1){for(t=e[n];r.length>=2&&o.cross3(r[r.length-2],r[r.length-1],t)<=0;)r.pop();r.push(t)}for(n=e.length-1;n>=0;n-=1){for(t=e[n];i.length>=2&&o.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}return i.pop(),r.pop(),i.concat(r)}},function(e,t,n){var i={};e.exports=i;var o=n(0);i.on=function(e,t,n){for(var i,o=t.split(" "),r=0;r<o.length;r++)i=o[r],e.events=e.events||{},e.events[i]=e.events[i]||[],e.events[i].push(n);return n},i.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=o.keys(e.events).join(" "));for(var i=t.split(" "),r=0;r<i.length;r++){var s=e.events[i[r]],a=[];if(n&&s)for(var l=0;l<s.length;l++)s[l]!==n&&a.push(s[l]);e.events[i[r]]=a}}else e.events={}},i.trigger=function(e,t,n){var i,r,s,a,l=e.events;if(l&&o.keys(l).length>0){n||(n={}),i=t.split(" ");for(var c=0;c<i.length;c++)if(s=l[r=i[c]]){(a=o.clone(n,!1)).name=r,a.source=e;for(var d=0;d<s.length;d++)s[d].apply(e,[a])}}}},function(e,t,n){var i={};e.exports=i;var o=n(4),r=n(0),s=n(1),a=n(6);i.create=function(e){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},e)},i.setModified=function(e,t,n,o){if(e.isModified=t,n&&e.parent&&i.setModified(e.parent,t,n,o),o)for(var r=0;r<e.composites.length;r++){var s=e.composites[r];i.setModified(s,t,n,o)}},i.add=function(e,t){var n=[].concat(t);o.trigger(e,"beforeAdd",{object:t});for(var s=0;s<n.length;s++){var a=n[s];switch(a.type){case"body":if(a.parent!==a){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(e,a);break;case"constraint":i.addConstraint(e,a);break;case"composite":i.addComposite(e,a);break;case"mouseConstraint":i.addConstraint(e,a.constraint);}}return o.trigger(e,"afterAdd",{object:t}),e},i.remove=function(e,t,n){var r=[].concat(t);o.trigger(e,"beforeRemove",{object:t});for(var s=0;s<r.length;s++){var a=r[s];switch(a.type){case"body":i.removeBody(e,a,n);break;case"constraint":i.removeConstraint(e,a,n);break;case"composite":i.removeComposite(e,a,n);break;case"mouseConstraint":i.removeConstraint(e,a.constraint);}}return o.trigger(e,"afterRemove",{object:t}),e},i.addComposite=function(e,t){return e.composites.push(t),t.parent=e,i.setModified(e,!0,!0,!1),e},i.removeComposite=function(e,t,n){var o=r.indexOf(e.composites,t);if(-1!==o&&(i.removeCompositeAt(e,o),i.setModified(e,!0,!0,!1)),n)for(var s=0;s<e.composites.length;s++)i.removeComposite(e.composites[s],t,!0);return e},i.removeCompositeAt=function(e,t){return e.composites.splice(t,1),i.setModified(e,!0,!0,!1),e},i.addBody=function(e,t){return e.bodies.push(t),i.setModified(e,!0,!0,!1),e},i.removeBody=function(e,t,n){var o=r.indexOf(e.bodies,t);if(-1!==o&&(i.removeBodyAt(e,o),i.setModified(e,!0,!0,!1)),n)for(var s=0;s<e.composites.length;s++)i.removeBody(e.composites[s],t,!0);return e},i.removeBodyAt=function(e,t){return e.bodies.splice(t,1),i.setModified(e,!0,!0,!1),e},i.addConstraint=function(e,t){return e.constraints.push(t),i.setModified(e,!0,!0,!1),e},i.removeConstraint=function(e,t,n){var o=r.indexOf(e.constraints,t);if(-1!==o&&i.removeConstraintAt(e,o),n)for(var s=0;s<e.composites.length;s++)i.removeConstraint(e.composites[s],t,!0);return e},i.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),i.setModified(e,!0,!0,!1),e},i.clear=function(e,t,n){if(n)for(var o=0;o<e.composites.length;o++)i.clear(e.composites[o],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,i.setModified(e,!0,!0,!1),e},i.allBodies=function(e){for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(i.allBodies(e.composites[n]));return t},i.allConstraints=function(e){for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(i.allConstraints(e.composites[n]));return t},i.allComposites=function(e){for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(i.allComposites(e.composites[n]));return t},i.get=function(e,t,n){var o,r;switch(n){case"body":o=i.allBodies(e);break;case"constraint":o=i.allConstraints(e);break;case"composite":o=i.allComposites(e).concat(e);}return o?0===(r=o.filter(function(e){return e.id.toString()===t.toString()})).length?null:r[0]:null},i.move=function(e,t,n){return i.remove(e,t),i.add(n,t),e},i.rebase=function(e){for(var t=i.allBodies(e).concat(i.allConstraints(e)).concat(i.allComposites(e)),n=0;n<t.length;n++)t[n].id=r.nextId();return i.setModified(e,!0,!0,!1),e},i.translate=function(e,t,n){for(var o=n?i.allBodies(e):e.bodies,r=0;r<o.length;r++)a.translate(o[r],t);return i.setModified(e,!0,!0,!1),e},i.rotate=function(e,t,n,o){for(var r=Math.cos(t),s=Math.sin(t),l=o?i.allBodies(e):e.bodies,c=0;c<l.length;c++){var d=l[c],u=d.position.x-n.x,p=d.position.y-n.y;a.setPosition(d,{x:n.x+(u*r-p*s),y:n.y+(u*s+p*r)}),a.rotate(d,t)}return i.setModified(e,!0,!0,!1),e},i.scale=function(e,t,n,o,r){for(var s=r?i.allBodies(e):e.bodies,l=0;l<s.length;l++){var c=s[l],d=c.position.x-o.x,u=c.position.y-o.y;a.setPosition(c,{x:o.x+d*t,y:o.y+u*n}),a.scale(c,t,n)}return i.setModified(e,!0,!0,!1),e},i.bounds=function(e){for(var t=i.allBodies(e),n=[],o=0;o<t.length;o+=1){var r=t[o];n.push(r.bounds.min,r.bounds.max)}return s.create(n)}},function(e,t,n){var i={};e.exports=i;var o=n(3),r=n(2),s=n(7),a=(n(10),n(0)),l=n(1),c=n(15);!function(){i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i.create=function(t){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},i=a.extend(n,t);return e(i,t),i},i.nextGroup=function(e){return e?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var e=function(e,t){t=t||{},i.set(e,{bounds:e.bounds||l.create(e.vertices),positionPrev:e.positionPrev||r.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),o.rotate(e.vertices,e.angle,e.position),c.rotate(e.axes,e.angle),l.update(e.bounds,e.vertices,e.velocity),i.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var n=e.isStatic?"#14151f":a.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),s=e.isStatic?"#555":"#ccc",d=e.isStatic&&null===e.render.fillStyle?1:0;e.render.fillStyle=e.render.fillStyle||n,e.render.strokeStyle=e.render.strokeStyle||s,e.render.lineWidth=e.render.lineWidth||d,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};i.set=function(e,t,n){var o;for(o in"string"==typeof t&&(o=t,(t={})[o]=n),t)if(Object.prototype.hasOwnProperty.call(t,o))switch(n=t[o],o){case"isStatic":i.setStatic(e,n);break;case"isSleeping":s.set(e,n);break;case"mass":i.setMass(e,n);break;case"density":i.setDensity(e,n);break;case"inertia":i.setInertia(e,n);break;case"vertices":i.setVertices(e,n);break;case"position":i.setPosition(e,n);break;case"angle":i.setAngle(e,n);break;case"velocity":i.setVelocity(e,n);break;case"angularVelocity":i.setAngularVelocity(e,n);break;case"parts":i.setParts(e,n);break;case"centre":i.setCentre(e,n);break;default:e[o]=n;}},i.setStatic=function(e,t){for(var n=0;n<e.parts.length;n++){var i=e.parts[n];i.isStatic=t,t?(i._original={restitution:i.restitution,friction:i.friction,mass:i.mass,inertia:i.inertia,density:i.density,inverseMass:i.inverseMass,inverseInertia:i.inverseInertia},i.restitution=0,i.friction=1,i.mass=i.inertia=i.density=1/0,i.inverseMass=i.inverseInertia=0,i.positionPrev.x=i.position.x,i.positionPrev.y=i.position.y,i.anglePrev=i.angle,i.angularVelocity=0,i.speed=0,i.angularSpeed=0,i.motion=0):i._original&&(i.restitution=i._original.restitution,i.friction=i._original.friction,i.mass=i._original.mass,i.inertia=i._original.inertia,i.density=i._original.density,i.inverseMass=i._original.inverseMass,i.inverseInertia=i._original.inverseInertia,i._original=null)}},i.setMass=function(e,t){var n=e.inertia/(e.mass/6);e.inertia=n*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},i.setDensity=function(e,t){i.setMass(e,t*e.area),e.density=t},i.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},i.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=o.create(t,e),e.axes=c.fromVertices(e.vertices),e.area=o.area(e.vertices),i.setMass(e,e.density*e.area);var n=o.centre(e.vertices);o.translate(e.vertices,n,-1),i.setInertia(e,i._inertiaScale*o.inertia(e.vertices,e.mass)),o.translate(e.vertices,e.position),l.update(e.bounds,e.vertices,e.velocity)},i.setParts=function(e,t,n){var r;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,r=0;r<t.length;r++){var s=t[r];s!==e&&(s.parent=e,e.parts.push(s))}if(1!==e.parts.length){if(n=void 0===n||n){var a=[];for(r=0;r<t.length;r++)a=a.concat(t[r].vertices);o.clockwiseSort(a);var l=o.hull(a),c=o.centre(l);i.setVertices(e,l),o.translate(e.vertices,c)}var d=i._totalProperties(e);e.area=d.area,e.parent=e,e.position.x=d.centre.x,e.position.y=d.centre.y,e.positionPrev.x=d.centre.x,e.positionPrev.y=d.centre.y,i.setMass(e,d.mass),i.setInertia(e,d.inertia),i.setPosition(e,d.centre)}},i.setCentre=function(e,t,n){n?(e.positionPrev.x+=t.x,e.positionPrev.y+=t.y,e.position.x+=t.x,e.position.y+=t.y):(e.positionPrev.x=t.x-(e.position.x-e.positionPrev.x),e.positionPrev.y=t.y-(e.position.y-e.positionPrev.y),e.position.x=t.x,e.position.y=t.y)},i.setPosition=function(e,t){var n=r.sub(t,e.position);e.positionPrev.x+=n.x,e.positionPrev.y+=n.y;for(var i=0;i<e.parts.length;i++){var s=e.parts[i];s.position.x+=n.x,s.position.y+=n.y,o.translate(s.vertices,n),l.update(s.bounds,s.vertices,e.velocity)}},i.setAngle=function(e,t){var n=t-e.angle;e.anglePrev+=n;for(var i=0;i<e.parts.length;i++){var s=e.parts[i];s.angle+=n,o.rotate(s.vertices,n,e.position),c.rotate(s.axes,n),l.update(s.bounds,s.vertices,e.velocity),i>0&&r.rotateAbout(s.position,n,e.position,s.position)}},i.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=r.magnitude(e.velocity)},i.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},i.translate=function(e,t){i.setPosition(e,r.add(e.position,t))},i.rotate=function(e,t,n){if(n){var o=Math.cos(t),r=Math.sin(t),s=e.position.x-n.x,a=e.position.y-n.y;i.setPosition(e,{x:n.x+(s*o-a*r),y:n.y+(s*r+a*o)}),i.setAngle(e,e.angle+t)}else i.setAngle(e,e.angle+t)},i.scale=function(e,t,n,r){var s=0,a=0;r=r||e.position;for(var d=0;d<e.parts.length;d++){var u=e.parts[d];o.scale(u.vertices,t,n,r),u.axes=c.fromVertices(u.vertices),u.area=o.area(u.vertices),i.setMass(u,e.density*u.area),o.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),i.setInertia(u,i._inertiaScale*o.inertia(u.vertices,u.mass)),o.translate(u.vertices,{x:u.position.x,y:u.position.y}),d>0&&(s+=u.area,a+=u.inertia),u.position.x=r.x+(u.position.x-r.x)*t,u.position.y=r.y+(u.position.y-r.y)*n,l.update(u.bounds,u.vertices,e.velocity)}e.parts.length>1&&(e.area=s,e.isStatic||(i.setMass(e,e.density*s),i.setInertia(e,a))),e.circleRadius&&(t===n?e.circleRadius*=t:e.circleRadius=null)},i.update=function(e,t,n,i){var s=Math.pow(t*n*e.timeScale,2),a=1-e.frictionAir*n*e.timeScale,d=e.position.x-e.positionPrev.x,u=e.position.y-e.positionPrev.y;e.velocity.x=d*a*i+e.force.x/e.mass*s,e.velocity.y=u*a*i+e.force.y/e.mass*s,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*a*i+e.torque/e.inertia*s,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=r.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var p=0;p<e.parts.length;p++){var f=e.parts[p];o.translate(f.vertices,e.velocity),p>0&&(f.position.x+=e.velocity.x,f.position.y+=e.velocity.y),0!==e.angularVelocity&&(o.rotate(f.vertices,e.angularVelocity,e.position),c.rotate(f.axes,e.angularVelocity),p>0&&r.rotateAbout(f.position,e.angularVelocity,e.position,f.position)),l.update(f.bounds,f.vertices,e.velocity)}},i.applyForce=function(e,t,n){e.force.x+=n.x,e.force.y+=n.y;var i=t.x-e.position.x,o=t.y-e.position.y;e.torque+=i*n.y-o*n.x},i._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===e.parts.length?0:1;n<e.parts.length;n++){var i=e.parts[n],o=i.mass!==1/0?i.mass:1;t.mass+=o,t.area+=i.area,t.inertia+=i.inertia,t.centre=r.add(t.centre,r.mult(i.position,o))}return t.centre=r.div(t.centre,t.mass),t}}()},function(e,t,n){var i={};e.exports=i;var o=n(4);i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(e,t){for(var n=t*t*t,o=0;o<e.length;o++){var r=e[o],s=r.speed*r.speed+r.angularSpeed*r.angularSpeed;if(0===r.force.x&&0===r.force.y){var a=Math.min(r.motion,s),l=Math.max(r.motion,s);r.motion=i._minBias*a+(1-i._minBias)*l,r.sleepThreshold>0&&r.motion<i._motionSleepThreshold*n?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold&&i.set(r,!0)):r.sleepCounter>0&&(r.sleepCounter-=1)}else i.set(r,!1)}},i.afterCollisions=function(e,t){for(var n=t*t*t,o=0;o<e.length;o++){var r=e[o];if(r.isActive){var s=r.collision,a=s.bodyA.parent,l=s.bodyB.parent;if(!(a.isSleeping&&l.isSleeping||a.isStatic||l.isStatic)&&(a.isSleeping||l.isSleeping)){var c=a.isSleeping&&!a.isStatic?a:l,d=c===a?l:a;!c.isStatic&&d.motion>i._motionWakeThreshold*n&&i.set(c,!1)}}}},i.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&o.trigger(e,"sleepEnd"))}},function(e,t,n){var i={};e.exports=i;var o=n(3),r=n(2),s=n(7),a=n(1),l=n(15),c=n(0);i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?r.add(t.bodyA.position,t.pointA):t.pointA,i=t.bodyB?r.add(t.bodyB.position,t.pointB):t.pointB,o=r.magnitude(r.sub(n,i));t.length=void 0!==t.length?t.length:o,t.id=t.id||c.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var s={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&t.stiffness>.1?(s.type="pin",s.anchors=!1):t.stiffness<.9&&(s.type="spring"),t.render=c.extend(s,t.render),t},i.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var n=e[t],i=n.constraintImpulse;n.isStatic||0===i.x&&0===i.y&&0===i.angle||(n.position.x+=i.x,n.position.y+=i.y,n.angle+=i.angle)}},i.solveAll=function(e,t){for(var n=0;n<e.length;n+=1){var o=e[n],r=!o.bodyA||o.bodyA&&o.bodyA.isStatic,s=!o.bodyB||o.bodyB&&o.bodyB.isStatic;(r||s)&&i.solve(e[n],t)}for(n=0;n<e.length;n+=1)r=!(o=e[n]).bodyA||o.bodyA&&o.bodyA.isStatic,s=!o.bodyB||o.bodyB&&o.bodyB.isStatic,r||s||i.solve(e[n],t)},i.solve=function(e,t){var n=e.bodyA,o=e.bodyB,s=e.pointA,a=e.pointB;if(n||o){n&&!n.isStatic&&(r.rotate(s,n.angle-e.angleA,s),e.angleA=n.angle),o&&!o.isStatic&&(r.rotate(a,o.angle-e.angleB,a),e.angleB=o.angle);var l=s,c=a;if(n&&(l=r.add(n.position,s)),o&&(c=r.add(o.position,a)),l&&c){var d=r.sub(l,c),u=r.magnitude(d);u<i._minLength&&(u=i._minLength);var p,f,v,m,y,g=(u-e.length)/u,x=e.stiffness<1?e.stiffness*t:e.stiffness,h=r.mult(d,g*x),b=(n?n.inverseMass:0)+(o?o.inverseMass:0),w=b+((n?n.inverseInertia:0)+(o?o.inverseInertia:0));if(e.damping){var S=r.create();v=r.div(d,u),y=r.sub(o&&r.sub(o.position,o.positionPrev)||S,n&&r.sub(n.position,n.positionPrev)||S),m=r.dot(v,y)}n&&!n.isStatic&&(f=n.inverseMass/b,n.constraintImpulse.x-=h.x*f,n.constraintImpulse.y-=h.y*f,n.position.x-=h.x*f,n.position.y-=h.y*f,e.damping&&(n.positionPrev.x-=e.damping*v.x*m*f,n.positionPrev.y-=e.damping*v.y*m*f),p=r.cross(s,h)/w*i._torqueDampen*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.angle-=p,n.angle-=p),o&&!o.isStatic&&(f=o.inverseMass/b,o.constraintImpulse.x+=h.x*f,o.constraintImpulse.y+=h.y*f,o.position.x+=h.x*f,o.position.y+=h.y*f,e.damping&&(o.positionPrev.x+=e.damping*v.x*m*f,o.positionPrev.y+=e.damping*v.y*m*f),p=r.cross(a,h)/w*i._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle+=p,o.angle+=p)}}},i.postSolveAll=function(e){for(var t=0;t<e.length;t++){var n=e[t],c=n.constraintImpulse;if(!(n.isStatic||0===c.x&&0===c.y&&0===c.angle)){s.set(n,!1);for(var d=0;d<n.parts.length;d++){var u=n.parts[d];o.translate(u.vertices,c),d>0&&(u.position.x+=c.x,u.position.y+=c.y),0!==c.angle&&(o.rotate(u.vertices,c.angle,n.position),l.rotate(u.axes,c.angle),d>0&&r.rotateAbout(u.position,c.angle,n.position,u.position)),a.update(u.bounds,u.vertices,n.velocity)}c.angle*=i._warming,c.x*=i._warming,c.y*=i._warming}}},i.pointAWorld=function(e){return{x:(e.bodyA?e.bodyA.position.x:0)+e.pointA.x,y:(e.bodyA?e.bodyA.position.y:0)+e.pointA.y}},i.pointBWorld=function(e){return{x:(e.bodyB?e.bodyB.position.x:0)+e.pointB.x,y:(e.bodyB?e.bodyB.position.y:0)+e.pointB.y}}},function(e,t,n){var i={};e.exports=i;var o=n(18);i.create=function(e,t){var n=e.bodyA,o=e.bodyB,r=e.parentA,s=e.parentB,a={id:i.id(n,o),bodyA:n,bodyB:o,contacts:{},activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||o.isSensor,timeCreated:t,timeUpdated:t,inverseMass:r.inverseMass+s.inverseMass,friction:Math.min(r.friction,s.friction),frictionStatic:Math.max(r.frictionStatic,s.frictionStatic),restitution:Math.max(r.restitution,s.restitution),slop:Math.max(r.slop,s.slop)};return i.update(a,e,t),a},i.update=function(e,t,n){var r=e.contacts,s=t.supports,a=e.activeContacts,l=t.parentA,c=t.parentB;if(e.collision=t,e.inverseMass=l.inverseMass+c.inverseMass,e.friction=Math.min(l.friction,c.friction),e.frictionStatic=Math.max(l.frictionStatic,c.frictionStatic),e.restitution=Math.max(l.restitution,c.restitution),e.slop=Math.max(l.slop,c.slop),a.length=0,t.collided){for(var d=0;d<s.length;d++){var u=s[d],p=o.id(u),f=r[p];f?a.push(f):a.push(r[p]=o.create(u))}e.separation=t.depth,i.setActive(e,!0,n)}else!0===e.isActive&&i.setActive(e,!1,n)},i.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},i.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},function(e,t,n){var i={};e.exports=i;var o=n(0),r=n(5),s=n(1),a=n(4),l=n(11),c=n(2),d=n(14);!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i.create=function(e){var t={controller:i,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},r=o.extend(t,e);return r.canvas&&(r.canvas.width=r.options.width||r.canvas.width,r.canvas.height=r.options.height||r.canvas.height),r.mouse=e.mouse,r.engine=e.engine,r.canvas=r.canvas||n(r.options.width,r.options.height),r.context=r.canvas.getContext("2d"),r.textures={},r.bounds=r.bounds||{min:{x:0,y:0},max:{x:r.canvas.width,y:r.canvas.height}},1!==r.options.pixelRatio&&i.setPixelRatio(r,r.options.pixelRatio),o.isElement(r.element)?r.element.appendChild(r.canvas):r.canvas.parentNode||o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),r},i.run=function(t){!function n(o){t.frameRequestId=e(n),i.world(t)}()},i.stop=function(e){t(e.frameRequestId)},i.setPixelRatio=function(e,t){var n=e.options,i=e.canvas;"auto"===t&&(t=u(i)),n.pixelRatio=t,i.setAttribute("data-pixel-ratio",t),i.width=n.width*t,i.height=n.height*t,i.style.width=n.width+"px",i.style.height=n.height+"px"},i.lookAt=function(e,t,n,i){i=void 0===i||i,t=o.isArray(t)?t:[t],n=n||{x:0,y:0};for(var r={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},s=0;s<t.length;s+=1){var a=t[s],l=a.bounds?a.bounds.min:a.min||a.position||a,c=a.bounds?a.bounds.max:a.max||a.position||a;l&&c&&(l.x<r.min.x&&(r.min.x=l.x),c.x>r.max.x&&(r.max.x=c.x),l.y<r.min.y&&(r.min.y=l.y),c.y>r.max.y&&(r.max.y=c.y))}var u=r.max.x-r.min.x+2*n.x,p=r.max.y-r.min.y+2*n.y,f=e.canvas.height,v=e.canvas.width/f,m=u/p,y=1,g=1;m>v?g=m/v:y=v/m,e.options.hasBounds=!0,e.bounds.min.x=r.min.x,e.bounds.max.x=r.min.x+u*y,e.bounds.min.y=r.min.y,e.bounds.max.y=r.min.y+p*g,i&&(e.bounds.min.x+=.5*u-u*y*.5,e.bounds.max.x+=.5*u-u*y*.5,e.bounds.min.y+=.5*p-p*g*.5,e.bounds.max.y+=.5*p-p*g*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(d.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),d.setOffset(e.mouse,e.bounds.min))},i.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,i=t/e.options.width,o=n/e.options.height;e.context.setTransform(e.options.pixelRatio/i,0,0,e.options.pixelRatio/o,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},i.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},i.world=function(e){var t,n=e.engine,o=n.world,u=e.canvas,p=e.context,v=e.options,m=r.allBodies(o),y=r.allConstraints(o),g=v.wireframes?v.wireframeBackground:v.background,x=[],h=[],b={timestamp:n.timing.timestamp};if(a.trigger(e,"beforeRender",b),e.currentBackground!==g&&f(e,g),p.globalCompositeOperation="source-in",p.fillStyle="transparent",p.fillRect(0,0,u.width,u.height),p.globalCompositeOperation="source-over",v.hasBounds){for(t=0;t<m.length;t++){var w=m[t];s.overlaps(w.bounds,e.bounds)&&x.push(w)}for(t=0;t<y.length;t++){var S=y[t],A=S.bodyA,P=S.bodyB,C=S.pointA,M=S.pointB;A&&(C=c.add(A.position,S.pointA)),P&&(M=c.add(P.position,S.pointB)),C&&M&&(s.contains(e.bounds,C)||s.contains(e.bounds,M))&&h.push(S)}i.startViewTransform(e),e.mouse&&(d.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.options.width,y:(e.bounds.max.y-e.bounds.min.y)/e.options.height}),d.setOffset(e.mouse,e.bounds.min))}else h=y,x=m,1!==e.options.pixelRatio&&e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0);!v.wireframes||n.enableSleeping&&v.showSleeping?i.bodies(e,x,p):(v.showConvexHulls&&i.bodyConvexHulls(e,x,p),i.bodyWireframes(e,x,p)),v.showBounds&&i.bodyBounds(e,x,p),(v.showAxes||v.showAngleIndicator)&&i.bodyAxes(e,x,p),v.showPositions&&i.bodyPositions(e,x,p),v.showVelocity&&i.bodyVelocity(e,x,p),v.showIds&&i.bodyIds(e,x,p),v.showSeparations&&i.separations(e,n.pairs.list,p),v.showCollisions&&i.collisions(e,n.pairs.list,p),v.showVertexNumbers&&i.vertexNumbers(e,x,p),v.showMousePosition&&i.mousePosition(e,e.mouse,p),i.constraints(h,p),v.showBroadphase&&n.broadphase.controller===l&&i.grid(e,n.broadphase,p),v.showDebug&&i.debug(e,p),v.hasBounds&&i.endViewTransform(e),a.trigger(e,"afterRender",b)},i.debug=function(e,t){var n=t,i=e.engine,o=i.world,s=i.metrics,a=e.options,c=r.allBodies(o);if(i.timing.timestamp-(e.debugTimestamp||0)>=500){var d="";s.timing&&(d+="fps: "+Math.round(s.timing.fps)+"    "),s.extended&&(s.timing&&(d+="delta: "+s.timing.delta.toFixed(3)+"    ",d+="correction: "+s.timing.correction.toFixed(3)+"    "),d+="bodies: "+c.length+"    ",i.broadphase.controller===l&&(d+="buckets: "+s.buckets+"    "),d+="\n",d+="collisions: "+s.collisions+"    ",d+="pairs: "+i.pairs.list.length+"    ",d+="broad: "+s.broadEff+"    ",d+="mid: "+s.midEff+"    ",d+="narrow: "+s.narrowEff+"    "),e.debugString=d,e.debugTimestamp=i.timing.timestamp}if(e.debugString){n.font="12px Arial",a.wireframes?n.fillStyle="rgba(255,255,255,0.5)":n.fillStyle="rgba(0,0,0,0.5)";for(var u=e.debugString.split("\n"),p=0;p<u.length;p++)n.fillText(u[p],50,50+18*p)}},i.constraints=function(e,t){for(var n=t,i=0;i<e.length;i++){var r=e[i];if(r.render.visible&&r.pointA&&r.pointB){var s,a,l=r.bodyA,d=r.bodyB;if(s=l?c.add(l.position,r.pointA):r.pointA,"pin"===r.render.type)n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath();else{if(a=d?c.add(d.position,r.pointB):r.pointB,n.beginPath(),n.moveTo(s.x,s.y),"spring"===r.render.type)for(var u,p=c.sub(a,s),f=c.perp(c.normalise(p)),v=Math.ceil(o.clamp(r.length/5,12,20)),m=1;m<v;m+=1)u=m%2==0?1:-1,n.lineTo(s.x+p.x*(m/v)+f.x*u*4,s.y+p.y*(m/v)+f.y*u*4);n.lineTo(a.x,a.y)}r.render.lineWidth&&(n.lineWidth=r.render.lineWidth,n.strokeStyle=r.render.strokeStyle,n.stroke()),r.render.anchors&&(n.fillStyle=r.render.strokeStyle,n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.arc(a.x,a.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},i.bodyShadows=function(e,t,n){for(var i=n,o=(e.engine,0);o<t.length;o++){var r=t[o];if(r.render.visible){if(r.circleRadius)i.beginPath(),i.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI),i.closePath();else{i.beginPath(),i.moveTo(r.vertices[0].x,r.vertices[0].y);for(var s=1;s<r.vertices.length;s++)i.lineTo(r.vertices[s].x,r.vertices[s].y);i.closePath()}var a=r.position.x-.5*e.options.width,l=r.position.y-.2*e.options.height,c=Math.abs(a)+Math.abs(l);i.shadowColor="rgba(0,0,0,0.15)",i.shadowOffsetX=.05*a,i.shadowOffsetY=.05*l,i.shadowBlur=1+12*Math.min(1,c/1e3),i.fill(),i.shadowColor=null,i.shadowOffsetX=null,i.shadowOffsetY=null,i.shadowBlur=null}}},i.bodies=function(e,t,n){var i,o,r,s,a=n,l=(e.engine,e.options),c=l.showInternalEdges||!l.wireframes;for(r=0;r<t.length;r++)if((i=t[r]).render.visible)for(s=i.parts.length>1?1:0;s<i.parts.length;s++)if((o=i.parts[s]).render.visible){if(l.showSleeping&&i.isSleeping?a.globalAlpha=.5*o.render.opacity:1!==o.render.opacity&&(a.globalAlpha=o.render.opacity),o.render.sprite&&o.render.sprite.texture&&!l.wireframes){var d=o.render.sprite,u=p(e,d.texture);a.translate(o.position.x,o.position.y),a.rotate(o.angle),a.drawImage(u,u.width*-d.xOffset*d.xScale,u.height*-d.yOffset*d.yScale,u.width*d.xScale,u.height*d.yScale),a.rotate(-o.angle),a.translate(-o.position.x,-o.position.y)}else{if(o.circleRadius)a.beginPath(),a.arc(o.position.x,o.position.y,o.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(o.vertices[0].x,o.vertices[0].y);for(var f=1;f<o.vertices.length;f++)!o.vertices[f-1].isInternal||c?a.lineTo(o.vertices[f].x,o.vertices[f].y):a.moveTo(o.vertices[f].x,o.vertices[f].y),o.vertices[f].isInternal&&!c&&a.moveTo(o.vertices[(f+1)%o.vertices.length].x,o.vertices[(f+1)%o.vertices.length].y);a.lineTo(o.vertices[0].x,o.vertices[0].y),a.closePath()}l.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=o.render.fillStyle,o.render.lineWidth&&(a.lineWidth=o.render.lineWidth,a.strokeStyle=o.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},i.bodyWireframes=function(e,t,n){var i,o,r,s,a,l=n,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((i=t[r]).render.visible)for(a=i.parts.length>1?1:0;a<i.parts.length;a++){for(o=i.parts[a],l.moveTo(o.vertices[0].x,o.vertices[0].y),s=1;s<o.vertices.length;s++)!o.vertices[s-1].isInternal||c?l.lineTo(o.vertices[s].x,o.vertices[s].y):l.moveTo(o.vertices[s].x,o.vertices[s].y),o.vertices[s].isInternal&&!c&&l.moveTo(o.vertices[(s+1)%o.vertices.length].x,o.vertices[(s+1)%o.vertices.length].y);l.lineTo(o.vertices[0].x,o.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},i.bodyConvexHulls=function(e,t,n){var i,o,r,s=n;for(s.beginPath(),o=0;o<t.length;o++)if((i=t[o]).render.visible&&1!==i.parts.length){for(s.moveTo(i.vertices[0].x,i.vertices[0].y),r=1;r<i.vertices.length;r++)s.lineTo(i.vertices[r].x,i.vertices[r].y);s.lineTo(i.vertices[0].x,i.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},i.vertexNumbers=function(e,t,n){var i,o,r,s=n;for(i=0;i<t.length;i++){var a=t[i].parts;for(r=a.length>1?1:0;r<a.length;r++){var l=a[r];for(o=0;o<l.vertices.length;o++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(i+"_"+o,l.position.x+.8*(l.vertices[o].x-l.position.x),l.position.y+.8*(l.vertices[o].y-l.position.y))}}},i.mousePosition=function(e,t,n){var i=n;i.fillStyle="rgba(255,255,255,0.8)",i.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},i.bodyBounds=function(e,t,n){var i=n,o=(e.engine,e.options);i.beginPath();for(var r=0;r<t.length;r++){if(t[r].render.visible)for(var s=t[r].parts,a=s.length>1?1:0;a<s.length;a++){var l=s[a];i.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}}o.wireframes?i.strokeStyle="rgba(255,255,255,0.08)":i.strokeStyle="rgba(0,0,0,0.1)",i.lineWidth=1,i.stroke()},i.bodyAxes=function(e,t,n){var i,o,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),o=0;o<t.length;o++){var c=t[o],d=c.parts;if(c.render.visible)if(l.showAxes)for(r=d.length>1?1:0;r<d.length;r++)for(i=d[r],s=0;s<i.axes.length;s++){var u=i.axes[s];a.moveTo(i.position.x,i.position.y),a.lineTo(i.position.x+20*u.x,i.position.y+20*u.y)}else for(r=d.length>1?1:0;r<d.length;r++)for(i=d[r],s=0;s<i.axes.length;s++)a.moveTo(i.position.x,i.position.y),a.lineTo((i.vertices[0].x+i.vertices[i.vertices.length-1].x)/2,(i.vertices[0].y+i.vertices[i.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},i.bodyPositions=function(e,t,n){var i,o,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),r=0;r<t.length;r++)if((i=t[r]).render.visible)for(s=0;s<i.parts.length;s++)o=i.parts[s],a.arc(o.position.x,o.position.y,3,0,2*Math.PI,!1),a.closePath();for(l.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<t.length;r++)(i=t[r]).render.visible&&(a.arc(i.positionPrev.x,i.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},i.bodyVelocity=function(e,t,n){var i=n;i.beginPath();for(var o=0;o<t.length;o++){var r=t[o];r.render.visible&&(i.moveTo(r.position.x,r.position.y),i.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}i.lineWidth=3,i.strokeStyle="cornflowerblue",i.stroke()},i.bodyIds=function(e,t,n){var i,o,r=n;for(i=0;i<t.length;i++)if(t[i].render.visible){var s=t[i].parts;for(o=s.length>1?1:0;o<s.length;o++){var a=s[o];r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(a.id,a.position.x+10,a.position.y-10)}}},i.collisions=function(e,t,n){var i,o,r,s,a=n,l=e.options;for(a.beginPath(),r=0;r<t.length;r++)if((i=t[r]).isActive)for(o=i.collision,s=0;s<i.activeContacts.length;s++){var c=i.activeContacts[s].vertex;a.rect(c.x-1.5,c.y-1.5,3.5,3.5)}for(l.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),r=0;r<t.length;r++)if((i=t[r]).isActive&&(o=i.collision,i.activeContacts.length>0)){var d=i.activeContacts[0].vertex.x,u=i.activeContacts[0].vertex.y;2===i.activeContacts.length&&(d=(i.activeContacts[0].vertex.x+i.activeContacts[1].vertex.x)/2,u=(i.activeContacts[0].vertex.y+i.activeContacts[1].vertex.y)/2),o.bodyB===o.supports[0].body||!0===o.bodyA.isStatic?a.moveTo(d-8*o.normal.x,u-8*o.normal.y):a.moveTo(d+8*o.normal.x,u+8*o.normal.y),a.lineTo(d,u)}l.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},i.separations=function(e,t,n){var i,o,r,s,a,l=n,c=e.options;for(l.beginPath(),a=0;a<t.length;a++)if((i=t[a]).isActive){r=(o=i.collision).bodyA;var d=1;(s=o.bodyB).isStatic||r.isStatic||(d=.5),s.isStatic&&(d=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x-o.penetration.x*d,s.position.y-o.penetration.y*d),d=1,s.isStatic||r.isStatic||(d=.5),r.isStatic&&(d=0),l.moveTo(r.position.x,r.position.y),l.lineTo(r.position.x+o.penetration.x*d,r.position.y+o.penetration.y*d)}c.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},i.grid=function(e,t,n){var i=n;e.options.wireframes?i.strokeStyle="rgba(255,180,0,0.1)":i.strokeStyle="rgba(255,180,0,0.5)",i.beginPath();for(var r=o.keys(t.buckets),s=0;s<r.length;s++){var a=r[s];if(!(t.buckets[a].length<2)){var l=a.split(/C|R/);i.rect(.5+parseInt(l[1],10)*t.bucketWidth,.5+parseInt(l[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}i.lineWidth=1,i.stroke()},i.inspector=function(e,t){e.engine;var n,i=e.selected,o=e.render,r=o.options;if(r.hasBounds){var s=o.bounds.max.x-o.bounds.min.x,a=o.bounds.max.y-o.bounds.min.y,l=s/o.options.width,c=a/o.options.height;t.scale(1/l,1/c),t.translate(-o.bounds.min.x,-o.bounds.min.y)}for(var d=0;d<i.length;d++){var u=i[d].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),u.type){case"body":n=u.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var p=u.pointA;u.bodyA&&(p=u.pointB),t.beginPath(),t.arc(p.x,p.y,10,0,2*Math.PI),t.closePath(),t.stroke();}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),r.hasBounds&&t.setTransform(1,0,0,1,0,0)};var n=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},u=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},p=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},f=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},function(e,t,n){var i={};e.exports=i;var o=n(9),r=n(12),s=n(0);i.create=function(e){var t={controller:i,detector:r.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return s.extend(t,e)},i.update=function(e,t,n,o){var r,s,a,l,c,d=n.world,u=e.buckets,p=!1,f=n.metrics;for(f.broadphaseTests=0,r=0;r<t.length;r++){var v=t[r];if((!v.isSleeping||o)&&!(v.bounds.max.x<d.bounds.min.x||v.bounds.min.x>d.bounds.max.x||v.bounds.max.y<d.bounds.min.y||v.bounds.min.y>d.bounds.max.y)){var m=i._getRegion(e,v);if(!v.region||m.id!==v.region.id||o){f.broadphaseTests+=1,v.region&&!o||(v.region=m);var y=i._regionUnion(m,v.region);for(s=y.startCol;s<=y.endCol;s++)for(a=y.startRow;a<=y.endRow;a++){l=u[c=i._getBucketId(s,a)];var g=s>=m.startCol&&s<=m.endCol&&a>=m.startRow&&a<=m.endRow,x=s>=v.region.startCol&&s<=v.region.endCol&&a>=v.region.startRow&&a<=v.region.endRow;!g&&x&&x&&l&&i._bucketRemoveBody(e,l,v),(v.region===m||g&&!x||o)&&(l||(l=i._createBucket(u,c)),i._bucketAddBody(e,l,v))}v.region=m,p=!0}}}p&&(e.pairsList=i._createActivePairsList(e))},i.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},i._regionUnion=function(e,t){var n=Math.min(e.startCol,t.startCol),o=Math.max(e.endCol,t.endCol),r=Math.min(e.startRow,t.startRow),s=Math.max(e.endRow,t.endRow);return i._createRegion(n,o,r,s)},i._getRegion=function(e,t){var n=t.bounds,o=Math.floor(n.min.x/e.bucketWidth),r=Math.floor(n.max.x/e.bucketWidth),s=Math.floor(n.min.y/e.bucketHeight),a=Math.floor(n.max.y/e.bucketHeight);return i._createRegion(o,r,s,a)},i._createRegion=function(e,t,n,i){return{id:e+","+t+","+n+","+i,startCol:e,endCol:t,startRow:n,endRow:i}},i._getBucketId=function(e,t){return"C"+e+"R"+t},i._createBucket=function(e,t){return e[t]=[]},i._bucketAddBody=function(e,t,n){for(var i=0;i<t.length;i++){var r=t[i];if(!(n.id===r.id||n.isStatic&&r.isStatic)){var s=o.id(n,r),a=e.pairs[s];a?a[2]+=1:e.pairs[s]=[n,r,1]}}t.push(n)},i._bucketRemoveBody=function(e,t,n){t.splice(s.indexOf(t,n),1);for(var i=0;i<t.length;i++){var r=t[i],a=o.id(n,r),l=e.pairs[a];l&&(l[2]-=1)}},i._createActivePairsList=function(e){var t,n,i=[];t=s.keys(e.pairs);for(var o=0;o<t.length;o++)(n=e.pairs[t[o]])[2]>0?i.push(n):delete e.pairs[t[o]];return i}},function(e,t,n){var i={};e.exports=i;var o=n(13),r=n(9),s=n(1);i.collisions=function(e,t){for(var n=[],a=t.pairs.table,l=t.metrics,c=0;c<e.length;c++){var d=e[c][0],u=e[c][1];if((!d.isStatic&&!d.isSleeping||!u.isStatic&&!u.isSleeping)&&i.canCollide(d.collisionFilter,u.collisionFilter)&&(l.midphaseTests+=1,s.overlaps(d.bounds,u.bounds)))for(var p=d.parts.length>1?1:0;p<d.parts.length;p++)for(var f=d.parts[p],v=u.parts.length>1?1:0;v<u.parts.length;v++){var m=u.parts[v];if(f===d&&m===u||s.overlaps(f.bounds,m.bounds)){var y,g=a[r.id(f,m)];y=g&&g.isActive?g.collision:null;var x=o.collides(f,m,y);l.narrowphaseTests+=1,x.reused&&(l.narrowReuseCount+=1),x.collided&&(n.push(x),l.narrowDetections+=1)}}}return n},i.canCollide=function(e,t){return e.group===t.group&&0!==e.group?e.group>0:0!=(e.mask&t.category)&&0!=(t.mask&e.category)}},function(e,t,n){var i={};e.exports=i;var o=n(3),r=n(2);i.collides=function(e,t,n){var s,a,l,c,d=!1;if(n){var u=e.parent,p=t.parent,f=u.speed*u.speed+u.angularSpeed*u.angularSpeed+p.speed*p.speed+p.angularSpeed*p.angularSpeed;d=n&&n.collided&&f<.2,c=n}else c={collided:!1,bodyA:e,bodyB:t};if(n&&d){var v=c.axisBody,m=v===e?t:e,y=[v.axes[n.axisNumber]];if(l=i._overlapAxes(v.vertices,m.vertices,y),c.reused=!0,l.overlap<=0)return c.collided=!1,c}else{if((s=i._overlapAxes(e.vertices,t.vertices,e.axes)).overlap<=0)return c.collided=!1,c;if((a=i._overlapAxes(t.vertices,e.vertices,t.axes)).overlap<=0)return c.collided=!1,c;s.overlap<a.overlap?(l=s,c.axisBody=e):(l=a,c.axisBody=t),c.axisNumber=l.axisNumber}c.bodyA=e.id<t.id?e:t,c.bodyB=e.id<t.id?t:e,c.collided=!0,c.depth=l.overlap,c.parentA=c.bodyA.parent,c.parentB=c.bodyB.parent,e=c.bodyA,t=c.bodyB,r.dot(l.axis,r.sub(t.position,e.position))<0?c.normal={x:l.axis.x,y:l.axis.y}:c.normal={x:-l.axis.x,y:-l.axis.y},c.tangent=r.perp(c.normal),c.penetration=c.penetration||{},c.penetration.x=c.normal.x*c.depth,c.penetration.y=c.normal.y*c.depth;var g=i._findSupports(e,t,c.normal),x=[];if(o.contains(e.vertices,g[0])&&x.push(g[0]),o.contains(e.vertices,g[1])&&x.push(g[1]),x.length<2){var h=i._findSupports(t,e,r.neg(c.normal));o.contains(t.vertices,h[0])&&x.push(h[0]),x.length<2&&o.contains(t.vertices,h[1])&&x.push(h[1])}return x.length<1&&(x=[g[0]]),c.supports=x,c},i._overlapAxes=function(e,t,n){for(var o,s,a=r._temp[0],l=r._temp[1],c={overlap:Number.MAX_VALUE},d=0;d<n.length;d++){if(s=n[d],i._projectToAxis(a,e,s),i._projectToAxis(l,t,s),(o=Math.min(a.max-l.min,l.max-a.min))<=0)return c.overlap=o,c;o<c.overlap&&(c.overlap=o,c.axis=s,c.axisNumber=d)}return c},i._projectToAxis=function(e,t,n){for(var i=r.dot(t[0],n),o=i,s=1;s<t.length;s+=1){var a=r.dot(t[s],n);a>o?o=a:a<i&&(i=a)}e.min=i,e.max=o},i._findSupports=function(e,t,n){for(var i,o,s,a,l=Number.MAX_VALUE,c=r._temp[0],d=t.vertices,u=e.position,p=0;p<d.length;p++)o=d[p],c.x=o.x-u.x,c.y=o.y-u.y,(i=-r.dot(n,c))<l&&(l=i,s=o);return o=d[s.index-1>=0?s.index-1:d.length-1],c.x=o.x-u.x,c.y=o.y-u.y,l=-r.dot(n,c),a=o,o=d[(s.index+1)%d.length],c.x=o.x-u.x,c.y=o.y-u.y,(i=-r.dot(n,c))<l&&(a=o),[s,a]}},function(e,t,n){var i={};e.exports=i;var o=n(0);i.create=function(e){var t={};return e||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=parseInt(t.element.getAttribute("data-pixel-ratio"),10)||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var n=i._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&(t.button=0,e.preventDefault()),t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var n=i._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var n=i._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&e.preventDefault(),t.button=-1,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},i.setElement(t,t.element),t},i.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},i.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},i.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},i.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},i._getRelativeMousePosition=function(e,t,n){var i,o,r=t.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,l=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,c=e.changedTouches;return c?(i=c[0].pageX-r.left-a,o=c[0].pageY-r.top-l):(i=e.pageX-r.left-a,o=e.pageY-r.top-l),{x:i/(t.clientWidth/(t.width||t.clientWidth)*n),y:o/(t.clientHeight/(t.height||t.clientHeight)*n)}}},function(e,t,n){var i={};e.exports=i;var o=n(2),r=n(0);i.fromVertices=function(e){for(var t={},n=0;n<e.length;n++){var i=(n+1)%e.length,s=o.normalise({x:e[i].y-e[n].y,y:e[n].x-e[i].x}),a=0===s.y?1/0:s.x/s.y;t[a=a.toFixed(3).toString()]=s}return r.values(t)},i.rotate=function(e,t){if(0!==t)for(var n=Math.cos(t),i=Math.sin(t),o=0;o<e.length;o++){var r,s=e[o];r=s.x*n-s.y*i,s.y=s.x*i+s.y*n,s.x=r}}},function(e,t,n){var i={};e.exports=i;var o=n(3),r=n(0),s=n(6),a=n(1),l=n(2);i._decompWarned=!1,i.rectangle=function(e,t,n,i,a){a=a||{};var l={label:"Rectangle Body",position:{x:e,y:t},vertices:o.fromPath("L 0 0 L "+n+" 0 L "+n+" "+i+" L 0 "+i)};if(a.chamfer){var c=a.chamfer;l.vertices=o.chamfer(l.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete a.chamfer}return s.create(r.extend({},l,a))},i.trapezoid=function(e,t,n,i,a,l){l=l||{};var c,d=n*(a*=.5),u=d+(1-2*a)*n,p=u+d;c=a<.5?"L 0 0 L "+d+" "+-i+" L "+u+" "+-i+" L "+p+" 0":"L 0 0 L "+u+" "+-i+" L "+p+" 0";var f={label:"Trapezoid Body",position:{x:e,y:t},vertices:o.fromPath(c)};if(l.chamfer){var v=l.chamfer;f.vertices=o.chamfer(f.vertices,v.radius,v.quality,v.qualityMin,v.qualityMax),delete l.chamfer}return s.create(r.extend({},f,l))},i.circle=function(e,t,n,o,s){o=o||{};var a={label:"Circle Body",circleRadius:n};s=s||25;var l=Math.ceil(Math.max(10,Math.min(s,n)));return l%2==1&&(l+=1),i.polygon(e,t,l,n,r.extend({},a,o))},i.polygon=function(e,t,n,a,l){if(l=l||{},n<3)return i.circle(e,t,a,l);for(var c=2*Math.PI/n,d="",u=.5*c,p=0;p<n;p+=1){var f=u+p*c,v=Math.cos(f)*a,m=Math.sin(f)*a;d+="L "+v.toFixed(3)+" "+m.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:e,y:t},vertices:o.fromPath(d)};if(l.chamfer){var g=l.chamfer;y.vertices=o.chamfer(y.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete l.chamfer}return s.create(r.extend({},y,l))},i.fromVertices=function(e,t,c,d,u,p,f,v){var m,y,g,x,h,b,w,S,A,P,C;try{m=n(27)}catch(E){m=null}for(y=Boolean(m&&m.quickDecomp),d=d||{},x=[],u=void 0!==u&&u,p=void 0!==p?p:.01,f=void 0!==f?f:10,v=void 0!==v?v:.01,r.isArray(c[0])||(c=[c]),P=0;P<c.length;P+=1)if(b=c[P],!!(h=o.isConvex(b))||y||i._decompWarned||(r.warn("Could not resolve the expected 'poly-decomp' package for concave vertices in 'Bodies.fromVertices'"),r.warn("Try 'npm install poly-decomp --save' or as a global e.g. 'window.decomp'"),i._decompWarned=!0),h||!y)b=h?o.clockwiseSort(b):o.hull(b),x.push({position:{x:e,y:t},vertices:b});else{var M=b.map(function(e){return[e.x,e.y]});m.makeCCW(M),!1!==p&&m.removeCollinearPoints(M,p),!1!==v&&m.removeDuplicatePoints&&m.removeDuplicatePoints(M,v);var k=m.quickDecomp(M);for(w=0;w<k.length;w++){var B=k[w].map(function(e){return{x:e[0],y:e[1]}});f>0&&o.area(B)<f||x.push({position:o.centre(B),vertices:B})}}for(w=0;w<x.length;w++)x[w]=s.create(r.extend(x[w],d));if(u)for(w=0;w<x.length;w++){var I=x[w];for(S=w+1;S<x.length;S++){var _=x[S];if(a.overlaps(I.bounds,_.bounds)){var T=I.vertices,R=_.vertices;for(A=0;A<I.vertices.length;A++)for(C=0;C<_.vertices.length;C++){var L=l.magnitudeSquared(l.sub(T[(A+1)%T.length],R[C])),O=l.magnitudeSquared(l.sub(T[A],R[(C+1)%R.length]));L<5&&O<5&&(T[A].isInternal=!0,R[C].isInternal=!0)}}}}return x.length>1?(g=s.create(r.extend({parts:x.slice(0)},d)),s.setPosition(g,{x:e,y:t}),g):x[0]}},function(e,t,n){var i={};e.exports=i;var o=n(0);i._registry={},i.register=function(e){if(i.isPlugin(e)||o.warn("Plugin.register:",i.toString(e),"does not implement all required fields."),e.name in i._registry){var t=i._registry[e.name],n=i.versionParse(e.version).number,r=i.versionParse(t.version).number;n>r?(o.warn("Plugin.register:",i.toString(t),"was upgraded to",i.toString(e)),i._registry[e.name]=e):n<r?o.warn("Plugin.register:",i.toString(t),"can not be downgraded to",i.toString(e)):e!==t&&o.warn("Plugin.register:",i.toString(e),"is already registered to different plugin object")}else i._registry[e.name]=e;return e},i.resolve=function(e){return i._registry[i.dependencyParse(e).name]},i.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},i.isPlugin=function(e){return e&&e.name&&e.version&&e.install},i.isUsed=function(e,t){return e.used.indexOf(t)>-1},i.isFor=function(e,t){var n=e.for&&i.dependencyParse(e.for);return!e.for||t.name===n.name&&i.versionSatisfies(t.version,n.range)},i.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n=i.dependencies(e),r=o.topologicalSort(n),s=[],a=0;a<r.length;a+=1)if(r[a]!==e.name){var l=i.resolve(r[a]);l?i.isUsed(e,l.name)||(i.isFor(l,e)||(o.warn("Plugin.use:",i.toString(l),"is for",l.for,"but installed on",i.toString(e)+"."),l._warned=!0),l.install?l.install(e):(o.warn("Plugin.use:",i.toString(l),"does not specify an install function."),l._warned=!0),l._warned?(s.push("\uD83D\uDD36 "+i.toString(l)),delete l._warned):s.push("\u2705 "+i.toString(l)),e.used.push(l.name)):s.push("\u274C "+r[a])}s.length>0&&o.info(s.join("  "))}else o.warn("Plugin.use:",i.toString(e),"does not specify any dependencies to install.")},i.dependencies=function(e,t){var n=i.dependencyParse(e),r=n.name;if(!(r in(t=t||{}))){e=i.resolve(e)||e,t[r]=o.map(e.uses||[],function(t){i.isPlugin(t)&&i.register(t);var r=i.dependencyParse(t),s=i.resolve(t);return s&&!i.versionSatisfies(s.version,r.range)?(o.warn("Plugin.dependencies:",i.toString(s),"does not satisfy",i.toString(r),"used by",i.toString(n)+"."),s._warned=!0,e._warned=!0):s||(o.warn("Plugin.dependencies:",i.toString(t),"used by",i.toString(n),"could not be resolved."),e._warned=!0),r.name});for(var s=0;s<t[r].length;s+=1)i.dependencies(t[r][s],t);return t}},i.dependencyParse=function(e){return o.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(e)||o.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},i.versionParse=function(e){var t=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-]+)?$/;t.test(e)||o.warn("Plugin.versionParse:",e,"is not a valid version or range.");var n=t.exec(e),i=Number(n[4]),r=Number(n[5]),s=Number(n[6]);return{isRange:Boolean(n[1]||n[2]),version:n[3],range:e,operator:n[1]||n[2]||"",major:i,minor:r,patch:s,parts:[i,r,s],prerelease:n[7],number:1e8*i+1e4*r+s}},i.versionSatisfies=function(e,t){t=t||"*";var n=i.versionParse(t),o=i.versionParse(e);if(n.isRange){if("*"===n.operator||"*"===e)return!0;if(">"===n.operator)return o.number>n.number;if(">="===n.operator)return o.number>=n.number;if("~"===n.operator)return o.major===n.major&&o.minor===n.minor&&o.patch>=n.patch;if("^"===n.operator)return n.major>0?o.major===n.major&&o.number>=n.number:n.minor>0?o.minor===n.minor&&o.patch>=n.patch:o.patch===n.patch}return e===t||"*"===e}},function(e,t){var n={};e.exports=n,n.create=function(e){return{id:n.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}},n.id=function(e){return e.body.id+"_"+e.index}},function(e,t,n){var i={};e.exports=i;var o=n(5),r=(n(8),n(0));i.create=function(e){var t=o.create(),n={label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-1/0,y:-1/0},max:{x:1/0,y:1/0}}};return r.extend(t,n,e)}},function(e,t,n){var i={};e.exports=i;var o=n(9),r=n(0);i._pairMaxIdleLife=1e3,i.create=function(e){return r.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},i.update=function(e,t,n){var i,r,s,a,l=e.list,c=e.table,d=e.collisionStart,u=e.collisionEnd,p=e.collisionActive;for(d.length=0,u.length=0,p.length=0,a=0;a<l.length;a++)l[a].confirmedActive=!1;for(a=0;a<t.length;a++)(i=t[a]).collided&&((s=c[r=o.id(i.bodyA,i.bodyB)])?(s.isActive?p.push(s):d.push(s),o.update(s,i,n),s.confirmedActive=!0):(s=o.create(i,n),c[r]=s,d.push(s),l.push(s)));for(a=0;a<l.length;a++)(s=l[a]).isActive&&!s.confirmedActive&&(o.setActive(s,!1,n),u.push(s))},i.removeOld=function(e,t){var n,o,r,s,a=e.list,l=e.table,c=[];for(s=0;s<a.length;s++)(o=(n=a[s]).collision).bodyA.isSleeping||o.bodyB.isSleeping?n.timeUpdated=t:t-n.timeUpdated>i._pairMaxIdleLife&&c.push(s);for(s=0;s<c.length;s++)delete l[(n=a[r=c[s]-s]).id],a.splice(r,1)},i.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},function(e,t,n){var i={};e.exports=i;var o=n(3),r=n(2),s=n(0),a=n(1);i._restingThresh=4,i._restingThreshTangent=6,i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i.preSolvePosition=function(e){var t,n,i;for(t=0;t<e.length;t++)(n=e[t]).isActive&&(i=n.activeContacts.length,n.collision.parentA.totalContacts+=i,n.collision.parentB.totalContacts+=i)},i.solvePosition=function(e,t){var n,o,s,a,l,c,d,u,p,f=r._temp[0],v=r._temp[1],m=r._temp[2],y=r._temp[3];for(n=0;n<e.length;n++)(o=e[n]).isActive&&!o.isSensor&&(a=(s=o.collision).parentA,l=s.parentB,c=s.normal,d=r.sub(r.add(l.positionImpulse,l.position,f),r.add(a.positionImpulse,r.sub(l.position,s.penetration,v),m),y),o.separation=r.dot(c,d));for(n=0;n<e.length;n++)(o=e[n]).isActive&&!o.isSensor&&(a=(s=o.collision).parentA,l=s.parentB,c=s.normal,p=(o.separation-o.slop)*t,(a.isStatic||l.isStatic)&&(p*=2),a.isStatic||a.isSleeping||(u=i._positionDampen/a.totalContacts,a.positionImpulse.x+=c.x*p*u,a.positionImpulse.y+=c.y*p*u),l.isStatic||l.isSleeping||(u=i._positionDampen/l.totalContacts,l.positionImpulse.x-=c.x*p*u,l.positionImpulse.y-=c.y*p*u))},i.postSolvePosition=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.totalContacts=0,0!==n.positionImpulse.x||0!==n.positionImpulse.y){for(var s=0;s<n.parts.length;s++){var l=n.parts[s];o.translate(l.vertices,n.positionImpulse),a.update(l.bounds,l.vertices,n.velocity),l.position.x+=n.positionImpulse.x,l.position.y+=n.positionImpulse.y}n.positionPrev.x+=n.positionImpulse.x,n.positionPrev.y+=n.positionImpulse.y,r.dot(n.positionImpulse,n.velocity)<0?(n.positionImpulse.x=0,n.positionImpulse.y=0):(n.positionImpulse.x*=i._positionWarming,n.positionImpulse.y*=i._positionWarming)}}},i.preSolveVelocity=function(e){var t,n,i,o,s,a,l,c,d,u,p,f,v,m,y=r._temp[0],g=r._temp[1];for(t=0;t<e.length;t++)if((i=e[t]).isActive&&!i.isSensor)for(o=i.activeContacts,a=(s=i.collision).parentA,l=s.parentB,c=s.normal,d=s.tangent,n=0;n<o.length;n++)p=(u=o[n]).vertex,f=u.normalImpulse,v=u.tangentImpulse,0===f&&0===v||(y.x=c.x*f+d.x*v,y.y=c.y*f+d.y*v,a.isStatic||a.isSleeping||(m=r.sub(p,a.position,g),a.positionPrev.x+=y.x*a.inverseMass,a.positionPrev.y+=y.y*a.inverseMass,a.anglePrev+=r.cross(m,y)*a.inverseInertia),l.isStatic||l.isSleeping||(m=r.sub(p,l.position,g),l.positionPrev.x-=y.x*l.inverseMass,l.positionPrev.y-=y.y*l.inverseMass,l.anglePrev-=r.cross(m,y)*l.inverseInertia))},i.solveVelocity=function(e,t){for(var n=t*t,o=r._temp[0],a=r._temp[1],l=r._temp[2],c=r._temp[3],d=r._temp[4],u=r._temp[5],p=0;p<e.length;p++){var f=e[p];if(f.isActive&&!f.isSensor){var v=f.collision,m=v.parentA,y=v.parentB,g=v.normal,x=v.tangent,h=f.activeContacts,b=1/h.length;m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,y.velocity.x=y.position.x-y.positionPrev.x,y.velocity.y=y.position.y-y.positionPrev.y,m.angularVelocity=m.angle-m.anglePrev,y.angularVelocity=y.angle-y.anglePrev;for(var w=0;w<h.length;w++){var S=h[w],A=S.vertex,P=r.sub(A,m.position,a),C=r.sub(A,y.position,l),M=r.add(m.velocity,r.mult(r.perp(P),m.angularVelocity),c),k=r.add(y.velocity,r.mult(r.perp(C),y.angularVelocity),d),B=r.sub(M,k,u),I=r.dot(g,B),_=r.dot(x,B),T=Math.abs(_),R=s.sign(_),L=(1+f.restitution)*I,O=s.clamp(f.separation+I,0,1)*i._frictionNormalMultiplier,E=_,V=1/0;T>f.friction*f.frictionStatic*O*n&&(V=T,E=s.clamp(f.friction*R*n,-V,V));var F=r.cross(P,g),D=r.cross(C,g),W=b/(m.inverseMass+y.inverseMass+m.inverseInertia*F*F+y.inverseInertia*D*D);if(L*=W,E*=W,I<0&&I*I>i._restingThresh*n)S.normalImpulse=0;else{var q=S.normalImpulse;S.normalImpulse=Math.min(S.normalImpulse+L,0),L=S.normalImpulse-q}if(_*_>i._restingThreshTangent*n)S.tangentImpulse=0;else{var j=S.tangentImpulse;S.tangentImpulse=s.clamp(S.tangentImpulse+E,-V,V),E=S.tangentImpulse-j}o.x=g.x*L+x.x*E,o.y=g.y*L+x.y*E,m.isStatic||m.isSleeping||(m.positionPrev.x+=o.x*m.inverseMass,m.positionPrev.y+=o.y*m.inverseMass,m.anglePrev+=r.cross(P,o)*m.inverseInertia),y.isStatic||y.isSleeping||(y.positionPrev.x-=o.x*y.inverseMass,y.positionPrev.y-=o.y*y.inverseMass,y.anglePrev-=r.cross(C,o)*y.inverseInertia)}}}}},function(e,t,n){var i={};e.exports=i;var o=n(19),r=n(7),s=n(21),a=n(10),l=n(20),c=n(23),d=n(11),u=n(4),p=n(5),f=n(8),v=n(0),m=n(6);i.create=function(e,t){t=(t=v.isElement(e)?t:e)||{},((e=v.isElement(e)?e:null)||t.render)&&v.warn("Engine.create: engine.render is deprecated (see docs)");var n={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:d}},i=v.extend(n,t);if(e||i.render){var r={element:e,controller:a};i.render=v.extend(r,i.render)}return i.render&&i.render.controller&&(i.render=i.render.controller.create(i.render)),i.render&&(i.render.engine=i),i.world=t.world||o.create(i.world),i.pairs=l.create(),i.broadphase=i.broadphase.controller.create(i.broadphase),i.metrics=i.metrics||{extended:!1},i.metrics=c.create(i.metrics),i},i.update=function(e,t,n){t=t||1e3/60,n=n||1;var o,a=e.world,d=e.timing,v=e.broadphase,m=[];d.timestamp+=t*d.timeScale;var y={timestamp:d.timestamp};u.trigger(e,"beforeUpdate",y);var g=p.allBodies(a),x=p.allConstraints(a);for(c.reset(e.metrics),e.enableSleeping&&r.update(g,d.timeScale),i._bodiesApplyGravity(g,a.gravity),i._bodiesUpdate(g,t,d.timeScale,n,a.bounds),f.preSolveAll(g),o=0;o<e.constraintIterations;o++)f.solveAll(x,d.timeScale);f.postSolveAll(g),v.controller?(a.isModified&&v.controller.clear(v),v.controller.update(v,g,e,a.isModified),m=v.pairsList):m=g,a.isModified&&p.setModified(a,!1,!1,!0);var h=v.detector(m,e),b=e.pairs,w=d.timestamp;for(l.update(b,h,w),l.removeOld(b,w),e.enableSleeping&&r.afterCollisions(b.list,d.timeScale),b.collisionStart.length>0&&u.trigger(e,"collisionStart",{pairs:b.collisionStart}),s.preSolvePosition(b.list),o=0;o<e.positionIterations;o++)s.solvePosition(b.list,d.timeScale);for(s.postSolvePosition(g),f.preSolveAll(g),o=0;o<e.constraintIterations;o++)f.solveAll(x,d.timeScale);for(f.postSolveAll(g),s.preSolveVelocity(b.list),o=0;o<e.velocityIterations;o++)s.solveVelocity(b.list,d.timeScale);return b.collisionActive.length>0&&u.trigger(e,"collisionActive",{pairs:b.collisionActive}),b.collisionEnd.length>0&&u.trigger(e,"collisionEnd",{pairs:b.collisionEnd}),c.update(e.metrics,e),i._bodiesClearForces(g),u.trigger(e,"afterUpdate",y),e},i.merge=function(e,t){if(v.extend(e,t),t.world){e.world=t.world,i.clear(e);for(var n=p.allBodies(e.world),o=0;o<n.length;o++){var s=n[o];r.set(s,!1),s.id=v.nextId()}}},i.clear=function(e){var t=e.world;l.clear(e.pairs);var n=e.broadphase;if(n.controller){var i=p.allBodies(t);n.controller.clear(n),n.controller.update(n,i,e,!0)}},i._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.force.x=0,n.force.y=0,n.torque=0}},i._bodiesApplyGravity=function(e,t){var n=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==n)for(var i=0;i<e.length;i++){var o=e[i];o.isStatic||o.isSleeping||(o.force.y+=o.mass*t.y*n,o.force.x+=o.mass*t.x*n)}},i._bodiesUpdate=function(e,t,n,i,o){for(var r=0;r<e.length;r++){var s=e[r];s.isStatic||s.isSleeping||m.update(s,t,n,i)}}},function(e,t,n){var i={};e.exports=i;var o=n(5),r=n(0);i.create=function(e){return r.extend({extended:!1,narrowDetections:0,narrowphaseTests:0,narrowReuse:0,narrowReuseCount:0,midphaseTests:0,broadphaseTests:0,narrowEff:1e-4,midEff:1e-4,broadEff:1e-4,collisions:0,buckets:0,bodies:0,pairs:0},!1,e)},i.reset=function(e){e.extended&&(e.narrowDetections=0,e.narrowphaseTests=0,e.narrowReuse=0,e.narrowReuseCount=0,e.midphaseTests=0,e.broadphaseTests=0,e.narrowEff=0,e.midEff=0,e.broadEff=0,e.collisions=0,e.buckets=0,e.pairs=0,e.bodies=0)},i.update=function(e,t){if(e.extended){var n=t.world,i=o.allBodies(n);e.collisions=e.narrowDetections,e.pairs=t.pairs.list.length,e.bodies=i.length,e.midEff=(e.narrowDetections/(e.midphaseTests||1)).toFixed(2),e.narrowEff=(e.narrowDetections/(e.narrowphaseTests||1)).toFixed(2),e.broadEff=(1-e.broadphaseTests/(i.length||1)).toFixed(2),e.narrowReuse=(e.narrowReuseCount/(e.narrowphaseTests||1)).toFixed(2)}}},function(e,t,n){var i=e.exports=n(25);i.Body=n(6),i.Composite=n(5),i.World=n(19),i.Contact=n(18),i.Detector=n(12),i.Grid=n(11),i.Pairs=n(20),i.Pair=n(9),i.Query=n(26),i.Resolver=n(21),i.SAT=n(13),i.Constraint=n(8),i.MouseConstraint=n(28),i.Common=n(0),i.Engine=n(22),i.Events=n(4),i.Mouse=n(14),i.Runner=n(29),i.Sleeping=n(7),i.Plugin=n(17),i.Metrics=n(23),i.Bodies=n(16),i.Composites=n(30),i.Axes=n(15),i.Bounds=n(1),i.Svg=n(31),i.Vector=n(2),i.Vertices=n(3),i.Render=n(10),i.RenderPixi=n(32),i.World.add=i.Composite.add,i.World.remove=i.Composite.remove,i.World.addComposite=i.Composite.addComposite,i.World.addBody=i.Composite.addBody,i.World.addConstraint=i.Composite.addConstraint,i.World.clear=i.Composite.clear,i.Engine.run=i.Runner.run},function(e,t,n){var i={};e.exports=i;var o=n(17),r=n(0);i.name="matter-js",i.version="0.16.1",i.uses=[],i.used=[],i.use=function(){o.use(i,Array.prototype.slice.call(arguments))},i.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(i,e,t)},i.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(i,e,t)}},function(e,t,n){var i={};e.exports=i;var o=n(2),r=n(13),s=n(1),a=n(16),l=n(3);i.collides=function(e,t){for(var n=[],i=0;i<t.length;i++){var o=t[i];if(s.overlaps(o.bounds,e.bounds))for(var a=1===o.parts.length?0:1;a<o.parts.length;a++){var l=o.parts[a];if(s.overlaps(l.bounds,e.bounds)){var c=r.collides(l,e);if(c.collided){n.push(c);break}}}}return n},i.ray=function(e,t,n,r){r=r||1e-100;for(var s=o.angle(t,n),l=o.magnitude(o.sub(t,n)),c=.5*(n.x+t.x),d=.5*(n.y+t.y),u=a.rectangle(c,d,l,r,{angle:s}),p=i.collides(u,e),f=0;f<p.length;f+=1){var v=p[f];v.body=v.bodyB=v.bodyA}return p},i.region=function(e,t,n){for(var i=[],o=0;o<e.length;o++){var r=e[o],a=s.overlaps(r.bounds,t);(a&&!n||!a&&n)&&i.push(r)}return i},i.point=function(e,t){for(var n=[],i=0;i<e.length;i++){var o=e[i];if(s.contains(o.bounds,t))for(var r=1===o.parts.length?0:1;r<o.parts.length;r++){var a=o.parts[r];if(s.contains(a.bounds,t)&&l.contains(a.vertices,t)){n.push(o);break}}}return n}},function(t,n){if(void 0===e){var i=new Error("Cannot find module 'undefined'");throw i.code="MODULE_NOT_FOUND",i}t.exports=e},function(e,t,n){var i={};e.exports=i;var o=n(3),r=n(7),s=n(14),a=n(4),l=n(12),c=n(8),d=n(5),u=n(0),p=n(1);i.create=function(e,t){var n=(e?e.mouse:null)||(t?t.mouse:null);n||(e&&e.render&&e.render.canvas?n=s.create(e.render.canvas):t&&t.element?n=s.create(t.element):(n=s.create(),u.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var o={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:c.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},r=u.extend(o,t);return a.on(e,"beforeUpdate",function(){var t=d.allBodies(e.world);i.update(r,t),i._triggerEvents(r)}),r},i.update=function(e,t){var n=e.mouse,i=e.constraint,s=e.body;if(0===n.button){if(i.bodyB)r.set(i.bodyB,!1),i.pointA=n.position;else for(var c=0;c<t.length;c++)if(s=t[c],p.contains(s.bounds,n.position)&&l.canCollide(s.collisionFilter,e.collisionFilter))for(var d=s.parts.length>1?1:0;d<s.parts.length;d++){var u=s.parts[d];if(o.contains(u.vertices,n.position)){i.pointA=n.position,i.bodyB=e.body=s,i.pointB={x:n.position.x-s.position.x,y:n.position.y-s.position.y},i.angleB=s.angle,r.set(s,!1),a.trigger(e,"startdrag",{mouse:n,body:s});break}}}else i.bodyB=e.body=null,i.pointB=null,s&&a.trigger(e,"enddrag",{mouse:n,body:s})},i._triggerEvents=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&a.trigger(e,"mousemove",{mouse:t}),n.mousedown&&a.trigger(e,"mousedown",{mouse:t}),n.mouseup&&a.trigger(e,"mouseup",{mouse:t}),s.clearSourceEvents(t)}},function(e,t,n){var i={};e.exports=i;var o=n(4),r=n(22),s=n(0);!function(){var e,t,n;("undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e)||(e=function(e){n=setTimeout(function(){e(s.now())},1e3/60)},t=function(){clearTimeout(n)});i.create=function(e){var t=s.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},i.run=function(t,n){return void 0!==t.positionIterations&&(n=t,t=i.create()),function o(r){t.frameRequestId=e(o),r&&t.enabled&&i.tick(t,n,r)}(),t},i.tick=function(e,t,n){var i,s=t.timing,a=1,l={timestamp:s.timestamp};o.trigger(e,"beforeTick",l),o.trigger(t,"beforeTick",l),e.isFixed?i=e.delta:(i=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(i),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),a=(i=(i=(i=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:i)>e.deltaMax?e.deltaMax:i)/e.delta,e.delta=i),0!==e.timeScalePrev&&(a*=s.timeScale/e.timeScalePrev),0===s.timeScale&&(a=0),e.timeScalePrev=s.timeScale,e.correction=a,e.frameCounter+=1,n-e.counterTimestamp>=1e3&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),o.trigger(e,"tick",l),o.trigger(t,"tick",l),t.world.isModified&&t.render&&t.render.controller&&t.render.controller.clear&&t.render.controller.clear(t.render),o.trigger(e,"beforeUpdate",l),r.update(t,i,a),o.trigger(e,"afterUpdate",l),t.render&&t.render.controller&&(o.trigger(e,"beforeRender",l),o.trigger(t,"beforeRender",l),t.render.controller.world(t.render),o.trigger(e,"afterRender",l),o.trigger(t,"afterRender",l)),o.trigger(e,"afterTick",l),o.trigger(t,"afterTick",l)},i.stop=function(e){t(e.frameRequestId)},i.start=function(e,t){i.run(e,t)}}()},function(e,t,n){var i={};e.exports=i;var o=n(5),r=n(8),s=n(0),a=n(6),l=n(16);i.stack=function(e,t,n,i,r,s,l){for(var c,d=o.create({label:"Stack"}),u=e,p=t,f=0,v=0;v<i;v++){for(var m=0,y=0;y<n;y++){var g=l(u,p,y,v,c,f);if(g){var x=g.bounds.max.y-g.bounds.min.y,h=g.bounds.max.x-g.bounds.min.x;x>m&&(m=x),a.translate(g,{x:.5*h,y:.5*x}),u=g.bounds.max.x+r,o.addBody(d,g),c=g,f+=1}else u+=r}p+=m+s,u=e}return d},i.chain=function(e,t,n,i,a,l){for(var c=e.bodies,d=1;d<c.length;d++){var u=c[d-1],p=c[d],f=u.bounds.max.y-u.bounds.min.y,v=u.bounds.max.x-u.bounds.min.x,m=p.bounds.max.y-p.bounds.min.y,y={bodyA:u,pointA:{x:v*t,y:f*n},bodyB:p,pointB:{x:(p.bounds.max.x-p.bounds.min.x)*i,y:m*a}},g=s.extend(y,l);o.addConstraint(e,r.create(g))}return e.label+=" Chain",e},i.mesh=function(e,t,n,i,a){var l,c,d,u,p,f=e.bodies;for(l=0;l<n;l++){for(c=1;c<t;c++)d=f[c-1+l*t],u=f[c+l*t],o.addConstraint(e,r.create(s.extend({bodyA:d,bodyB:u},a)));if(l>0)for(c=0;c<t;c++)d=f[c+(l-1)*t],u=f[c+l*t],o.addConstraint(e,r.create(s.extend({bodyA:d,bodyB:u},a))),i&&c>0&&(p=f[c-1+(l-1)*t],o.addConstraint(e,r.create(s.extend({bodyA:p,bodyB:u},a)))),i&&c<t-1&&(p=f[c+1+(l-1)*t],o.addConstraint(e,r.create(s.extend({bodyA:p,bodyB:u},a))))}return e.label+=" Mesh",e},i.pyramid=function(e,t,n,o,r,s,l){return i.stack(e,t,n,o,r,s,function(t,i,s,c,d,u){var p=Math.min(o,Math.ceil(n/2)),f=d?d.bounds.max.x-d.bounds.min.x:0;if(!(c>p||s<(c=p-c)||s>n-1-c))return 1===u&&a.translate(d,{x:(s+(n%2==1?1:-1))*f,y:0}),l(e+(d?s*f:0)+s*r,i,s,c,d,u)})},i.newtonsCradle=function(e,t,n,i,s){for(var a=o.create({label:"Newtons Cradle"}),c=0;c<n;c++){var d=l.circle(e+c*(1.9*i),t+s,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=r.create({pointA:{x:e+c*(1.9*i),y:t},bodyB:d});o.addBody(a,d),o.addConstraint(a,u)}return a},i.car=function(e,t,n,i,s){var c=a.nextGroup(!0),d=.5*-n+20,u=.5*n-20,p=o.create({label:"Car"}),f=l.rectangle(e,t,n,i,{collisionFilter:{group:c},chamfer:{radius:.5*i},density:2e-4}),v=l.circle(e+d,t+0,s,{collisionFilter:{group:c},friction:.8}),m=l.circle(e+u,t+0,s,{collisionFilter:{group:c},friction:.8}),y=r.create({bodyB:f,pointB:{x:d,y:0},bodyA:v,stiffness:1,length:0}),g=r.create({bodyB:f,pointB:{x:u,y:0},bodyA:m,stiffness:1,length:0});return o.addBody(p,f),o.addBody(p,v),o.addBody(p,m),o.addConstraint(p,y),o.addConstraint(p,g),p},i.softBody=function(e,t,n,o,r,a,c,d,u,p){u=s.extend({inertia:1/0},u),p=s.extend({stiffness:.2,render:{type:"line",anchors:!1}},p);var f=i.stack(e,t,n,o,r,a,function(e,t){return l.circle(e,t,d,u)});return i.mesh(f,n,o,c,p),f.label="Soft Body",f}},function(e,t,n){var i={};e.exports=i;n(1);var o=n(0);i.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,r,s,a,l,c,d,u,p,f,v,m=[],y=0,g=0,x=0;t=t||15;var h=function(e,t,n){var i=n%2==1&&n>1;if(!p||e!=p.x||t!=p.y){p&&i?(f=p.x,v=p.y):(f=0,v=0);var o={x:f+e,y:v+t};!i&&p||(p=o),m.push(o),g=f+e,x=v+t}},b=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":g=e.x,x=e.y;break;case"H":g=e.x;break;case"V":x=e.y;}h(g,x,e.pathSegType)}};for(i._svgPathToAbsolute(e),s=e.getTotalLength(),c=[],n=0;n<e.pathSegList.numberOfItems;n+=1)c.push(e.pathSegList.getItem(n));for(d=c.concat();y<s;){if((l=c[e.getPathSegAtLength(y)])!=u){for(;d.length&&d[0]!=l;)b(d.shift());u=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=e.getPointAtLength(y),h(a.x,a.y,0);}y+=t}for(n=0,r=d.length;n<r;++n)b(d[n]);return m},i._svgPathToAbsolute=function(e){for(var t,n,i,o,r,s,a=e.pathSegList,l=0,c=0,d=a.numberOfItems,u=0;u<d;++u){var p=a.getItem(u),f=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(f))"x"in p&&(l=p.x),"y"in p&&(c=p.y);else switch("x1"in p&&(i=l+p.x1),"x2"in p&&(r=l+p.x2),"y1"in p&&(o=c+p.y1),"y2"in p&&(s=c+p.y2),"x"in p&&(l+=p.x),"y"in p&&(c+=p.y),f){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,c),u);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,c),u);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),u);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,i,o,r,s),u);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,r,s),u);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,i,o),u);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),u);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,c,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=t,c=n;}"M"!=f&&"m"!=f||(t=l,n=c)}}},function(e,t,n){var i={};e.exports=i;var o=n(1),r=n(5),s=n(0),a=n(4),l=n(2);!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(s.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i.create=function(e){s.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var t={controller:i,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},n=s.extend(t,e),o=!n.options.wireframes&&"transparent"===n.options.background;return n.pixiOptions=n.pixiOptions||{view:n.canvas,transparent:o,antialias:!0,backgroundColor:e.background},n.mouse=e.mouse,n.engine=e.engine,n.renderer=n.renderer||new PIXI.WebGLRenderer(n.options.width,n.options.height,n.pixiOptions),n.container=n.container||new PIXI.Container,n.spriteContainer=n.spriteContainer||new PIXI.Container,n.canvas=n.canvas||n.renderer.view,n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.options.width,y:n.options.height}},a.on(n.engine,"beforeUpdate",function(){i.clear(n)}),n.textures={},n.sprites={},n.primitives={},n.container.addChild(n.spriteContainer),s.isElement(n.element)?n.element.appendChild(n.canvas):s.warn("No \"render.element\" passed, \"render.canvas\" was not inserted into document."),n.canvas.oncontextmenu=function(){return!1},n.canvas.onselectstart=function(){return!1},n},i.run=function(t){!function n(o){t.frameRequestId=e(n),i.world(t)}()},i.stop=function(e){t(e.frameRequestId)},i.clear=function(e){for(var t=e.container,n=e.spriteContainer;t.children[0];)t.removeChild(t.children[0]);for(;n.children[0];)n.removeChild(n.children[0]);var i=e.sprites["bg-0"];e.textures={},e.sprites={},e.primitives={},e.sprites["bg-0"]=i,i&&t.addChildAt(i,0),e.container.addChild(e.spriteContainer),e.currentBackground=null,t.scale.set(1,1),t.position.set(0,0)},i.setBackground=function(e,t){if(e.currentBackground!==t){var n=t.indexOf&&-1!==t.indexOf("#"),i=e.sprites["bg-0"];if(n){var o=s.colorToNumber(t);e.renderer.backgroundColor=o,i&&e.container.removeChild(i)}else if(!i){var r=d(e,t);(i=e.sprites["bg-0"]=new PIXI.Sprite(r)).position.x=0,i.position.y=0,e.container.addChildAt(i,0)}e.currentBackground=t}},i.world=function(e){var t,n=e.engine.world,s=e.renderer,a=e.container,c=e.options,d=r.allBodies(n),u=r.allConstraints(n),p=[];c.wireframes?i.setBackground(e,c.wireframeBackground):i.setBackground(e,c.background);var f=e.bounds.max.x-e.bounds.min.x,v=e.bounds.max.y-e.bounds.min.y,m=f/e.options.width,y=v/e.options.height;if(c.hasBounds){for(t=0;t<d.length;t++){var g=d[t];g.render.sprite.visible=o.overlaps(g.bounds,e.bounds)}for(t=0;t<u.length;t++){var x=u[t],h=x.bodyA,b=x.bodyB,w=x.pointA,S=x.pointB;h&&(w=l.add(h.position,x.pointA)),b&&(S=l.add(b.position,x.pointB)),w&&S&&(o.contains(e.bounds,w)||o.contains(e.bounds,S))&&p.push(x)}a.scale.set(1/m,1/y),a.position.set(-e.bounds.min.x*(1/m),-e.bounds.min.y*(1/y))}else p=u;for(t=0;t<d.length;t++)i.body(e,d[t]);for(t=0;t<p.length;t++)i.constraint(e,p[t]);s.render(a)},i.constraint=function(e,t){e.engine;var n=t.bodyA,i=t.bodyB,o=t.pointA,r=t.pointB,a=e.container,l=t.render,c="c-"+t.id,d=e.primitives[c];d||(d=e.primitives[c]=new PIXI.Graphics),l.visible&&t.pointA&&t.pointB?(-1===s.indexOf(a.children,d)&&a.addChild(d),d.clear(),d.beginFill(0,0),d.lineStyle(l.lineWidth,s.colorToNumber(l.strokeStyle),1),n?d.moveTo(n.position.x+o.x,n.position.y+o.y):d.moveTo(o.x,o.y),i?d.lineTo(i.position.x+r.x,i.position.y+r.y):d.lineTo(r.x,r.y),d.endFill()):d.clear()},i.body=function(e,t){e.engine;var i=t.render;if(i.visible)if(i.sprite&&i.sprite.texture){var o="b-"+t.id,r=e.sprites[o],a=e.spriteContainer;r||(r=e.sprites[o]=n(e,t)),-1===s.indexOf(a.children,r)&&a.addChild(r),r.position.x=t.position.x,r.position.y=t.position.y,r.rotation=t.angle,r.scale.x=i.sprite.xScale||1,r.scale.y=i.sprite.yScale||1}else{var l="b-"+t.id,d=e.primitives[l],u=e.container;d||((d=e.primitives[l]=c(e,t)).initialAngle=t.angle),-1===s.indexOf(u.children,d)&&u.addChild(d),d.position.x=t.position.x,d.position.y=t.position.y,d.rotation=t.angle-d.initialAngle}};var n=function(e,t){var n=t.render.sprite.texture,i=d(e,n),o=new PIXI.Sprite(i);return o.anchor.x=t.render.sprite.xOffset,o.anchor.y=t.render.sprite.yOffset,o},c=function(e,t){var n,i=t.render,o=e.options,r=new PIXI.Graphics,a=s.colorToNumber(i.fillStyle),l=s.colorToNumber(i.strokeStyle),c=s.colorToNumber(i.strokeStyle),d=s.colorToNumber("#bbb"),u=s.colorToNumber("#CD5C5C");r.clear();for(var p=t.parts.length>1?1:0;p<t.parts.length;p++){n=t.parts[p],o.wireframes?(r.beginFill(0,0),r.lineStyle(1,d,1)):(r.beginFill(a,1),r.lineStyle(i.lineWidth,l,1)),r.moveTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y);for(var f=1;f<n.vertices.length;f++)r.lineTo(n.vertices[f].x-t.position.x,n.vertices[f].y-t.position.y);r.lineTo(n.vertices[0].x-t.position.x,n.vertices[0].y-t.position.y),r.endFill(),(o.showAngleIndicator||o.showAxes)&&(r.beginFill(0,0),o.wireframes?r.lineStyle(1,u,1):r.lineStyle(1,c),r.moveTo(n.position.x-t.position.x,n.position.y-t.position.y),r.lineTo((n.vertices[0].x+n.vertices[n.vertices.length-1].x)/2-t.position.x,(n.vertices[0].y+n.vertices[n.vertices.length-1].y)/2-t.position.y),r.endFill())}return r},d=function(e,t){var n=e.textures[t];return n||(n=e.textures[t]=PIXI.Texture.fromImage(t)),n}}()}])});var a=function(){function e(e){this._engine=ha.Engine.create(),this._pixiObjects=[],ha.Engine.run(this.engine);var t=ha.MouseConstraint.create(this.engine,{mouse:ha.Mouse.create(e.stage)});ha.World.add(this.engine.world,t)}return Object.defineProperty(e.prototype,"engine",{get:function(){return this._engine},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pixiObjects",{get:function(){return this._pixiObjects},enumerable:!1,configurable:!0}),e.prototype.update=function(){this._pixiObjects.forEach(function(e){return e.update()})},e.prototype.addToWorld=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.forEach(function(t){return ha.World.addBody(e.engine.world,t.body)}),this._pixiObjects=this._pixiObjects.concat(t)},e.prototype.removeFromWorld=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.forEach(function(t){return ha.World.remove(e.engine.world,t.body)}),this._pixiObjects=this._pixiObjects.filter(function(e){return!t.includes(e)})},e}();var b=function(){function i(i,t,e){void 0===t&&(t={});var o=i.x,s=i.y,r=i.width,p=i.height;i.texture;this._sprite=i,this._update=e,this.physicsOptions=t,t.isCircle?this._body=ha.Bodies.circle(o,s,r/2,t):this._body=ha.Bodies.rectangle(o,s,r,p,t)}return Object.defineProperty(i.prototype,"body",{get:function(){return this._body},enumerable:!1,configurable:!0}),i.prototype.update=function(){this._update?this._update({position:this._body.position,rotation:this._body.angle}):(this._sprite.position=this._body.position,this._sprite.rotation=this._body.angle)},i}();var Pb={};var Zd,$d,Ga,Ha;var Qb=/iPhone/i,Cc=/iPod/i,Dc=/iPad/i,Ec=/\biOS-universal(?:.+)Mac\b/i,Rb=/\bAndroid(?:.+)Mobile\b/i,Fc=/Android/i,Ra=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,kb=/Silk/i,va=/Windows Phone/i,Gc=/\bWindows(?:.+)ARM\b/i,Hc=/BlackBerry/i,Ic=/BB10/i,Jc=/Opera Mini/i,Kc=/\b(CriOS|Chrome)(?:.+)Mobile/i,Lc=/Mobile(?:.+)Firefox\b/i,Mc=function($){return void 0!==$&&"MacIntel"===$.platform&&"number"==typeof $.maxTouchPoints&&$.maxTouchPoints>1&&"undefined"==typeof MSStream};function _d($){return function(a){return a.test($)}}function ae($){var a={userAgent:"",platform:"",maxTouchPoints:0};$||"undefined"==typeof navigator?"string"==typeof $?a.userAgent=$:$&&$.userAgent&&(a={userAgent:$.userAgent,platform:$.platform,maxTouchPoints:$.maxTouchPoints||0}):a={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var e=a.userAgent,r=e.split("[FBAN");void 0!==r[1]&&(e=r[0]),void 0!==(r=e.split("Twitter"))[1]&&(e=r[0]);var o=_d(e),v={apple:{phone:o(Qb)&&!o(va),ipod:o(Cc),tablet:!o(Qb)&&(o(Dc)||Mc(a))&&!o(va),universal:o(Ec),device:(o(Qb)||o(Cc)||o(Dc)||o(Ec)||Mc(a))&&!o(va)},amazon:{phone:o(Ra),tablet:!o(Ra)&&o(kb),device:o(Ra)||o(kb)},android:{phone:!o(va)&&o(Ra)||!o(va)&&o(Rb),tablet:!o(va)&&!o(Ra)&&!o(Rb)&&(o(kb)||o(Fc)),device:!o(va)&&(o(Ra)||o(kb)||o(Rb)||o(Fc))||o(/\bokhttp\b/i)},windows:{phone:o(va),tablet:o(Gc),device:o(va)||o(Gc)},other:{blackberry:o(Hc),blackberry10:o(Ic),opera:o(Jc),firefox:o(Lc),chrome:o(Kc),device:o(Hc)||o(Ic)||o(Jc)||o(Lc)||o(Kc)},any:!1,phone:!1,tablet:!1};return v.any=v.apple.device||v.android.device||v.windows.device||v.other.device,v.phone=v.apple.phone||v.android.phone||v.windows.phone,v.tablet=v.apple.tablet||v.android.tablet||v.windows.tablet,v}var Ia=ae(window.navigator);function be(e){var t=!0;if(Ia.tablet||Ia.phone){var o;if(Ia.apple.device)if(o=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(o[1],10)<11&&(t=!1);if(Ia.android.device)if(o=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(o[1],10)<7&&(t=!1)}return t?e:4}function ce(){return!Ia.apple.device}var aa={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:be(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:Ia.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:ce(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var de,ee,fe,ge,he,ie,je,ke,le,me,ne,oe,pe,qe,re,se,te,za,lb,Sb,X,Aa,mb,Sa,ta,Ba,Tb,nb,Ja,wa,Nc,xa,pa,Za;!function($){$[$.WEBGL_LEGACY=0]="WEBGL_LEGACY",$[$.WEBGL=1]="WEBGL",$[$.WEBGL2=2]="WEBGL2"}(za||(ie=za={},ie)),function($){$[$.UNKNOWN=0]="UNKNOWN",$[$.WEBGL=1]="WEBGL",$[$.CANVAS=2]="CANVAS"}(lb||(pe=lb={},pe)),function($){$[$.COLOR=16384]="COLOR",$[$.DEPTH=256]="DEPTH",$[$.STENCIL=1024]="STENCIL"}(Sb||(fe=Sb={},fe)),function($){$[$.NORMAL=0]="NORMAL",$[$.ADD=1]="ADD",$[$.MULTIPLY=2]="MULTIPLY",$[$.SCREEN=3]="SCREEN",$[$.OVERLAY=4]="OVERLAY",$[$.DARKEN=5]="DARKEN",$[$.LIGHTEN=6]="LIGHTEN",$[$.COLOR_DODGE=7]="COLOR_DODGE",$[$.COLOR_BURN=8]="COLOR_BURN",$[$.HARD_LIGHT=9]="HARD_LIGHT",$[$.SOFT_LIGHT=10]="SOFT_LIGHT",$[$.DIFFERENCE=11]="DIFFERENCE",$[$.EXCLUSION=12]="EXCLUSION",$[$.HUE=13]="HUE",$[$.SATURATION=14]="SATURATION",$[$.COLOR=15]="COLOR",$[$.LUMINOSITY=16]="LUMINOSITY",$[$.NORMAL_NPM=17]="NORMAL_NPM",$[$.ADD_NPM=18]="ADD_NPM",$[$.SCREEN_NPM=19]="SCREEN_NPM",$[$.NONE=20]="NONE",$[$.SRC_OVER=0]="SRC_OVER",$[$.SRC_IN=21]="SRC_IN",$[$.SRC_OUT=22]="SRC_OUT",$[$.SRC_ATOP=23]="SRC_ATOP",$[$.DST_OVER=24]="DST_OVER",$[$.DST_IN=25]="DST_IN",$[$.DST_OUT=26]="DST_OUT",$[$.DST_ATOP=27]="DST_ATOP",$[$.ERASE=26]="ERASE",$[$.SUBTRACT=28]="SUBTRACT",$[$.XOR=29]="XOR"}(X||(ee=X={},ee)),function($){$[$.POINTS=0]="POINTS",$[$.LINES=1]="LINES",$[$.LINE_LOOP=2]="LINE_LOOP",$[$.LINE_STRIP=3]="LINE_STRIP",$[$.TRIANGLES=4]="TRIANGLES",$[$.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",$[$.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Aa||(he=Aa={},he)),function($){$[$.RGBA=6408]="RGBA",$[$.RGB=6407]="RGB",$[$.ALPHA=6406]="ALPHA",$[$.LUMINANCE=6409]="LUMINANCE",$[$.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",$[$.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",$[$.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(mb||(je=mb={},je)),function($){$[$.TEXTURE_2D=3553]="TEXTURE_2D",$[$.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",$[$.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",$[$.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",$[$.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",$[$.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",$[$.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",$[$.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Sa||(re=Sa={},re)),function($){$[$.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$[$.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$[$.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",$[$.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$[$.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$[$.FLOAT=5126]="FLOAT",$[$.HALF_FLOAT=36193]="HALF_FLOAT"}(ta||(se=ta={},se)),function($){$[$.NEAREST=0]="NEAREST",$[$.LINEAR=1]="LINEAR"}(Ba||(qe=Ba={},qe)),function($){$[$.CLAMP=33071]="CLAMP",$[$.REPEAT=10497]="REPEAT",$[$.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Tb||(te=Tb={},te)),function($){$[$.OFF=0]="OFF",$[$.POW2=1]="POW2",$[$.ON=2]="ON"}(nb||(me=nb={},me)),function($){$[$.NPM=0]="NPM",$[$.UNPACK=1]="UNPACK",$[$.PMA=2]="PMA",$[$.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",$[$.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",$[$.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(Ja||(de=Ja={},de)),function($){$[$.NO=0]="NO",$[$.YES=1]="YES",$[$.AUTO=2]="AUTO",$[$.BLEND=0]="BLEND",$[$.CLEAR=1]="CLEAR",$[$.BLIT=2]="BLIT"}(wa||(ge=wa={},ge)),function($){$[$.AUTO=0]="AUTO",$[$.MANUAL=1]="MANUAL"}(Nc||(ke=Nc={},ke)),function($){$.LOW="lowp",$.MEDIUM="mediump",$.HIGH="highp"}(xa||(oe=xa={},oe)),function($){$[$.NONE=0]="NONE",$[$.SCISSOR=1]="SCISSOR",$[$.STENCIL=2]="STENCIL",$[$.SPRITE=3]="SPRITE"}(pa||(le=pa={},le)),function($){$[$.NONE=0]="NONE",$[$.LOW=2]="LOW",$[$.MEDIUM=4]="MEDIUM",$[$.HIGH=8]="HIGH"}(Za||(ne=Za={},ne));var ue={},ve=Object.prototype.hasOwnProperty,ma="~";function $a(){}function we(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function Oc(e,t,r,n,$){if("function"!=typeof r)throw new TypeError("The listener must be a function");var v=new we(r,n||e,$),a=ma?ma+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],v]:e._events[a].push(v):(e._events[a]=v,e._eventsCount++),e}function ob(e,t){0==--e._eventsCount?e._events=new $a:delete e._events[t]}function ja(){this._events=new $a,this._eventsCount=0}Object.create&&($a.prototype=Object.create(null),new $a().__proto__||(ma=!1)),ja.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)ve.call(e,t)&&r.push(ma?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},ja.prototype.listeners=function(e){var t=ma?ma+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,$=r.length,v=new Array($);n<$;n++)v[n]=r[n].fn;return v},ja.prototype.listenerCount=function(e){var t=ma?ma+e:e,r=this._events[t];return r?r.fn?1:r.length:0},ja.prototype.emit=function(e,t,r,n,$,v){var a=ma?ma+e:e;if(!this._events[a])return!1;var i,J,l=this._events[a],s=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),s){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,n),!0;case 5:return l.fn.call(l.context,t,r,n,$),!0;case 6:return l.fn.call(l.context,t,r,n,$,v),!0;}for(J=1,i=new Array(s-1);J<s;J++)i[J-1]=arguments[J];l.fn.apply(l.context,i)}else{var o,f=l.length;for(J=0;J<f;J++)switch(l[J].once&&this.removeListener(e,l[J].fn,void 0,!0),s){case 1:l[J].fn.call(l[J].context);break;case 2:l[J].fn.call(l[J].context,t);break;case 3:l[J].fn.call(l[J].context,t,r);break;case 4:l[J].fn.call(l[J].context,t,r,n);break;default:if(!i)for(o=1,i=new Array(s-1);o<s;o++)i[o-1]=arguments[o];l[J].fn.apply(l[J].context,i);}}return!0},ja.prototype.on=function(e,t,r){return Oc(this,e,t,r,!1)},ja.prototype.once=function(e,t,r){return Oc(this,e,t,r,!0)},ja.prototype.removeListener=function(e,t,r,n){var $=ma?ma+e:e;if(!this._events[$])return this;if(!t)return ob(this,$),this;var v=this._events[$];if(v.fn)v.fn!==t||n&&!v.once||r&&v.context!==r||ob(this,$);else{for(var a=0,i=[],J=v.length;a<J;a++)(v[a].fn!==t||n&&!v[a].once||r&&v[a].context!==r)&&i.push(v[a]);i.length?this._events[$]=1===i.length?i[0]:i:ob(this,$)}return this},ja.prototype.removeAllListeners=function(e){var t;return e?(t=ma?ma+e:e,this._events[t]&&ob(this,t)):(this._events=new $a,this._eventsCount=0),this},ja.prototype.off=ja.prototype.removeListener,ja.prototype.addListener=ja.prototype.on,ja.prefixed=ma,ja.EventEmitter=ja,ue=ja;var xe={};function pb(v,r,e){e=e||2;var $,n,t,a,i,h,x,o=r&&r.length,w=o?r[0]*e:v.length,l=Pc(v,0,w,e,!0),u=[];if(!l||l.next===l.prev)return u;if(o&&(l=Ce(v,r,l,e)),v.length>80*e){$=t=v[0],n=a=v[1];for(var s=e;s<w;s+=e)(i=v[s])<$&&($=i),(h=v[s+1])<n&&(n=h),i>t&&(t=i),h>a&&(a=h);x=0!==(x=Math.max(t-$,a-n))?1/x:0}return _a(l,u,e,$,n,x),u}function Pc(v,r,e,$,n){var t,a;if(n===Wb(v,r,e,$)>0)for(t=r;t<e;t+=$)a=Sc(t,v[t],v[t+1],a);else for(t=e-$;t>=r;t-=$)a=Sc(t,v[t],v[t+1],a);return a&&qb(a,a.next)&&(bb(a),a=a.next),a}function Ca(v,r){if(!v)return v;r||(r=v);var e,$=v;do{if(e=!1,$.steiner||!qb($,$.next)&&0!==ca($.prev,$,$.next))$=$.next;else{if(bb($),($=r=$.prev)===$.next)break;e=!0}}while(e||$!==r);return r}function _a(v,r,e,$,n,t,a){if(v){!a&&t&&He(v,$,n,t);for(var i,h,x=v;v.prev!==v.next;)if(i=v.prev,h=v.next,t?ze(v,$,n,t):ye(v))r.push(i.i/e),r.push(v.i/e),r.push(h.i/e),bb(v),v=h.next,x=h.next;else if((v=h)===x){a?1===a?_a(v=Ae(Ca(v),r,e),r,e,$,n,t,2):2===a&&Be(v,r,e,$,n,t):_a(Ca(v),r,e,$,n,t,1);break}}}function ye(v){var r=v.prev,e=v,$=v.next;if(ca(r,e,$)>=0)return!1;for(var n=v.next.next;n!==v.prev;){if(Ta(r.x,r.y,e.x,e.y,$.x,$.y,n.x,n.y)&&ca(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function ze(v,r,e,$){var n=v.prev,t=v,a=v.next;if(ca(n,t,a)>=0)return!1;for(var i=n.x<t.x?n.x<a.x?n.x:a.x:t.x<a.x?t.x:a.x,h=n.y<t.y?n.y<a.y?n.y:a.y:t.y<a.y?t.y:a.y,x=n.x>t.x?n.x>a.x?n.x:a.x:t.x>a.x?t.x:a.x,o=n.y>t.y?n.y>a.y?n.y:a.y:t.y>a.y?t.y:a.y,w=Ub(i,h,r,e,$),l=Ub(x,o,r,e,$),u=v.prevZ,s=v.nextZ;u&&u.z>=w&&s&&s.z<=l;){if(u!==v.prev&&u!==v.next&&Ta(n.x,n.y,t.x,t.y,a.x,a.y,u.x,u.y)&&ca(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,s!==v.prev&&s!==v.next&&Ta(n.x,n.y,t.x,t.y,a.x,a.y,s.x,s.y)&&ca(s.prev,s,s.next)>=0)return!1;s=s.nextZ}for(;u&&u.z>=w;){if(u!==v.prev&&u!==v.next&&Ta(n.x,n.y,t.x,t.y,a.x,a.y,u.x,u.y)&&ca(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;s&&s.z<=l;){if(s!==v.prev&&s!==v.next&&Ta(n.x,n.y,t.x,t.y,a.x,a.y,s.x,s.y)&&ca(s.prev,s,s.next)>=0)return!1;s=s.nextZ}return!0}function Ae(v,r,e){var $=v;do{var n=$.prev,t=$.next.next;!qb(n,t)&&Qc(n,$,$.next,t)&&ab(n,t)&&ab(t,n)&&(r.push(n.i/e),r.push($.i/e),r.push(t.i/e),bb($),bb($.next),$=v=t),$=$.next}while($!==v);return Ca($)}function Be(v,r,e,$,n,t){var a=v;do{for(var i=a.next.next;i!==a.prev;){if(a.i!==i.i&&Ke(a,i)){var h=Rc(a,i);return a=Ca(a,a.next),h=Ca(h,h.next),_a(a,r,e,$,n,t),void _a(h,r,e,$,n,t)}i=i.next}a=a.next}while(a!==v)}function Ce(v,r,e,$){var n,t,a,i=[];for(n=0,t=r.length;n<t;n++)(a=Pc(v,r[n]*$,n<t-1?r[n+1]*$:v.length,$,!1))===a.next&&(a.steiner=!0),i.push(Je(a));for(i.sort(De),n=0;n<i.length;n++)Ee(i[n],e),e=Ca(e,e.next);return e}function De(v,r){return v.x-r.x}function Ee(v,r){if(r=Fe(v,r)){var e=Rc(r,v);Ca(r,r.next),Ca(e,e.next)}}function Fe(v,r){var e,$=r,n=v.x,t=v.y,a=-1/0;do{if(t<=$.y&&t>=$.next.y&&$.next.y!==$.y){var i=$.x+(t-$.y)*($.next.x-$.x)/($.next.y-$.y);if(i<=n&&i>a){if(a=i,i===n){if(t===$.y)return $;if(t===$.next.y)return $.next}e=$.x<$.next.x?$:$.next}}$=$.next}while($!==r);if(!e)return null;if(n===a)return e;var h,x=e,o=e.x,w=e.y,l=1/0;$=e;do{n>=$.x&&$.x>=o&&n!==$.x&&Ta(t<w?n:a,t,o,w,t<w?a:n,t,$.x,$.y)&&(h=Math.abs(t-$.y)/(n-$.x),ab($,v)&&(h<l||h===l&&($.x>e.x||$.x===e.x&&Ge(e,$)))&&(e=$,l=h)),$=$.next}while($!==x);return e}function Ge(v,r){return ca(v.prev,v,r.prev)<0&&ca(r.next,v,v.next)<0}function He(v,r,e,$){var n=v;do{null===n.z&&(n.z=Ub(n.x,n.y,r,e,$)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==v);n.prevZ.nextZ=null,n.prevZ=null,Ie(n)}function Ie(v){var r,e,$,n,t,a,i,h,x=1;do{for(e=v,v=null,t=null,a=0;e;){for(a++,$=e,i=0,r=0;r<x&&(i++,$=$.nextZ);r++);for(h=x;i>0||h>0&&$;)0!==i&&(0===h||!$||e.z<=$.z)?(n=e,e=e.nextZ,i--):(n=$,$=$.nextZ,h--),t?t.nextZ=n:v=n,n.prevZ=t,t=n;e=$}t.nextZ=null,x*=2}while(a>1);return v}function Ub(v,r,e,$,n){return(v=1431655765&((v=858993459&((v=252645135&((v=16711935&((v=32767*(v-e)*n)|v<<8))|v<<4))|v<<2))|v<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=32767*(r-$)*n)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function Je(v){var r=v,e=v;do{(r.x<e.x||r.x===e.x&&r.y<e.y)&&(e=r),r=r.next}while(r!==v);return e}function Ta(v,r,e,$,n,t,a,i){return(n-a)*(r-i)-(v-a)*(t-i)>=0&&(v-a)*($-i)-(e-a)*(r-i)>=0&&(e-a)*(t-i)-(n-a)*($-i)>=0}function Ke(v,r){return v.next.i!==r.i&&v.prev.i!==r.i&&!Le(v,r)&&(ab(v,r)&&ab(r,v)&&Me(v,r)&&(ca(v.prev,v,r.prev)||ca(v,r.prev,r))||qb(v,r)&&ca(v.prev,v,v.next)>0&&ca(r.prev,r,r.next)>0)}function ca(v,r,e){return(r.y-v.y)*(e.x-r.x)-(r.x-v.x)*(e.y-r.y)}function qb(v,r){return v.x===r.x&&v.y===r.y}function Qc(v,r,e,$){var n=sb(ca(v,r,e)),t=sb(ca(v,r,$)),a=sb(ca(e,$,v)),i=sb(ca(e,$,r));return n!==t&&a!==i||!(0!==n||!rb(v,e,r))||!(0!==t||!rb(v,$,r))||!(0!==a||!rb(e,v,$))||!(0!==i||!rb(e,r,$))}function rb(v,r,e){return r.x<=Math.max(v.x,e.x)&&r.x>=Math.min(v.x,e.x)&&r.y<=Math.max(v.y,e.y)&&r.y>=Math.min(v.y,e.y)}function sb(v){return v>0?1:v<0?-1:0}function Le(v,r){var e=v;do{if(e.i!==v.i&&e.next.i!==v.i&&e.i!==r.i&&e.next.i!==r.i&&Qc(e,e.next,v,r))return!0;e=e.next}while(e!==v);return!1}function ab(v,r){return ca(v.prev,v,v.next)<0?ca(v,r,v.next)>=0&&ca(v,v.prev,r)>=0:ca(v,r,v.prev)<0||ca(v,v.next,r)<0}function Me(v,r){var e=v,$=!1,n=(v.x+r.x)/2,t=(v.y+r.y)/2;do{e.y>t!=e.next.y>t&&e.next.y!==e.y&&n<(e.next.x-e.x)*(t-e.y)/(e.next.y-e.y)+e.x&&($=!$),e=e.next}while(e!==v);return $}function Rc(v,r){var e=new Vb(v.i,v.x,v.y),$=new Vb(r.i,r.x,r.y),n=v.next,t=r.prev;return v.next=r,r.prev=v,e.next=n,n.prev=e,$.next=e,e.prev=$,t.next=$,$.prev=t,$}function Sc(v,r,e,$){var n=new Vb(v,r,e);return $?(n.next=$.next,n.prev=$,$.next.prev=n,$.next=n):(n.prev=n,n.next=n),n}function bb(v){v.next.prev=v.prev,v.prev.next=v.next,v.prevZ&&(v.prevZ.nextZ=v.nextZ),v.nextZ&&(v.nextZ.prevZ=v.prevZ)}function Vb(v,r,e){this.i=v,this.x=r,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wb(v,r,e,$){for(var n=0,t=r,a=e-$;t<e;t+=$)n+=(v[a]-v[t])*(v[t+1]+v[a+1]),a=t;return n}(xe=pb).default=pb,pb.deviation=function(v,r,e,$){var n=r&&r.length,t=n?r[0]*e:v.length,a=Math.abs(Wb(v,0,t,e));if(n)for(var i=0,h=r.length;i<h;i++){var x=r[i]*e,o=i<h-1?r[i+1]*e:v.length;a-=Math.abs(Wb(v,x,o,e))}var w=0;for(i=0;i<$.length;i+=3){var l=$[i]*e,u=$[i+1]*e,s=$[i+2]*e;w+=Math.abs((v[l]-v[s])*(v[u+1]-v[l+1])-(v[l]-v[u])*(v[s+1]-v[l+1]))}return 0===a&&0===w?0:Math.abs((w-a)/a)},pb.flatten=function(v){for(var r=v[0][0].length,e={vertices:[],holes:[],dimensions:r},$=0,n=0;n<v.length;n++){for(var t=0;t<v[n].length;t++)for(var a=0;a<r;a++)e.vertices.push(v[n][t][a]);n>0&&($+=v[n-1].length,e.holes.push($))}return e};var Ne=function(){var o=this,e={exports:this};return function(n){var r="object"==typeof o&&o&&!o.nodeType&&o,t="object"==typeof e&&e&&!e.nodeType&&e,i="object"==typeof Bc&&Bc;i.global!==i&&i.window!==i&&i.self!==i||(n=i);var u,f,c=2147483647,l=36,s=1,a=26,p=38,h=700,d=72,v=128,g="-",w=/^xn--/,x=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=l-s,j=Math.floor,A=String.fromCharCode;function $(o){throw new RangeError(C[o])}function I(o,e){for(var n=o.length,r=[];n--;)r[n]=e(o[n]);return r}function E(o,e){var n=o.split("@"),r="";return n.length>1&&(r=n[0]+"@",o=n[1]),r+I((o=o.replace(b,".")).split("."),e).join(".")}function F(o){for(var e,n,r=[],t=0,i=o.length;t<i;)(e=o.charCodeAt(t++))>=55296&&e<=56319&&t<i?56320==(64512&(n=o.charCodeAt(t++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),t--):r.push(e);return r}function O(o){return I(o,function(o){var e="";return o>65535&&(e+=A((o-=65536)>>>10&1023|55296),o=56320|1023&o),e+=A(o)}).join("")}function S(o,e){return o+22+75*(o<26)-((0!=e)<<5)}function T(o,e,n){var r=0;for(o=n?j(o/h):o>>1,o+=j(o/e);o>y*a>>1;r+=l)o=j(o/y);return j(r+(y+1)*o/(o+p))}function m(o){var e,n,r,t,i,u,f,p,h,w,x,b=[],C=o.length,y=0,A=v,I=d;for((n=o.lastIndexOf(g))<0&&(n=0),r=0;r<n;++r)o.charCodeAt(r)>=128&&$("not-basic"),b.push(o.charCodeAt(r));for(t=n>0?n+1:0;t<C;){for(i=y,u=1,f=l;t>=C&&$("invalid-input"),((p=(x=o.charCodeAt(t++))-48<10?x-22:x-65<26?x-65:x-97<26?x-97:l)>=l||p>j((c-y)/u))&&$("overflow"),y+=p*u,!(p<(h=f<=I?s:f>=I+a?a:f-I));f+=l)u>j(c/(w=l-h))&&$("overflow"),u*=w;I=T(y-i,e=b.length+1,0==i),j(y/e)>c-A&&$("overflow"),A+=j(y/e),y%=e,b.splice(y++,0,A)}return O(b)}function L(o){var e,n,r,t,i,u,f,p,h,w,x,b,C,y,I,E=[];for(b=(o=F(o)).length,e=v,n=0,i=d,u=0;u<b;++u)(x=o[u])<128&&E.push(A(x));for(r=t=E.length,t&&E.push(g);r<b;){for(f=c,u=0;u<b;++u)(x=o[u])>=e&&x<f&&(f=x);for(f-e>j((c-n)/(C=r+1))&&$("overflow"),n+=(f-e)*C,e=f,u=0;u<b;++u)if((x=o[u])<e&&++n>c&&$("overflow"),x==e){for(p=n,h=l;!(p<(w=h<=i?s:h>=i+a?a:h-i));h+=l)I=p-w,y=l-w,E.push(A(S(w+I%y,0))),p=j(I/y);E.push(A(S(p,0))),i=T(n,C,r==t),n=0,++r}++n,++e}return E.join("")}if(u={version:"1.4.1",ucs2:{decode:F,encode:O},decode:m,encode:L,toASCII:function(o){return E(o,function(o){return x.test(o)?"xn--"+L(o):o})},toUnicode:function(o){return E(o,function(o){return w.test(o)?m(o.slice(4).toLowerCase()):o})}},r&&t){if(e.exports==r)t.exports=u;else for(f in u)u.hasOwnProperty(f)&&(r[f]=u[f]);}else n.punycode=u}(this),e.exports}.call({});var ua={};ua={isString:function(n){return"string"==typeof n},isObject:function(n){return"object"==typeof n&&null!==n},isNull:function(n){return null===n},isNullOrUndefined:function(n){return null==n}};var Oe,Pe,Qe=false;function Re(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Se(){if(Qe)return;Qe=true;Oe={};Oe=function(r,e,t,a){e=e||"&",t=t||"=";var n={};if("string"!=typeof r||0===r.length)return n;var o=/\+/g;r=r.split(e);var s=1e3;a&&"number"==typeof a.maxKeys&&(s=a.maxKeys);var p=r.length;s>0&&p>s&&(p=s);for(var $=0;$<p;++$){var y,v,c,i,u=r[$].replace(o,"%20"),f=u.indexOf(t);f>=0?(y=u.substr(0,f),v=u.substr(f+1)):(y=u,v=""),c=decodeURIComponent(y),i=decodeURIComponent(v),Re(n,c)?Pe(n[c])?n[c].push(i):n[c]=[n[c],i]:n[c]=i}return n};Pe=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)}}var Te,cb,Ue,Ve,We=false;function Tc(r,e){if(r.map)return r.map(e);for(var t=[],n=0;n<r.length;n++)t.push(e(r[n],n));return t}function Xe(){if(We)return;We=true;Te={};cb=function(r){switch(typeof r){case"string":return r;case"boolean":return r?"true":"false";case"number":return isFinite(r)?r:"";default:return"";}};Te=function(r,e,t,n){return e=e||"&",t=t||"=",null===r&&(r=void 0),"object"==typeof r?Tc(Ve(r),function(n){var i=encodeURIComponent(cb(n))+t;return Ue(r[n])?Tc(r[n],function(r){return i+encodeURIComponent(cb(r))}).join(e):i+encodeURIComponent(cb(r[n]))}).join(e):n?encodeURIComponent(cb(n))+t+encodeURIComponent(cb(r)):""};Ue=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};Ve=Object.keys||function(r){var e=[];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e.push(t);return e}}var Uc,Ye,c=(Uc=(Se(),Oe));var d=(Ye=(Xe(),Te));var Ua={},Vc=db;Ua.parse=Vc;var Ze=lf;Ua.resolve=Ze;var $e=mf;Ua.resolveObject=$e;var _e=kf;Ua.format=_e;var af=qa;function qa(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}Ua.Url=af;var bf=/^([a-z0-9.+-]+:)/i,cf=/:[0-9]*$/,df=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,ef=["<",">","\"","`"," ","\r","\n","\t"],ff=["{","}","|","\\","^","`"].concat(ef),Xb=["'"].concat(ff),Wc=["%","/","?",";","#"].concat(Xb),Xc=["/","?","#"],gf=255,Yc=/^[+a-z0-9A-Z_-]{0,63}$/,hf=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,jf={javascript:!0,"javascript:":!0},Yb={javascript:!0,"javascript:":!0},Va={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function db(t,h,r){if(t&&ua.isObject(t)&&t instanceof qa)return t;var s=new qa;return s.parse(t,h,r),s}function kf(t){return ua.isString(t)&&(t=db(t)),t instanceof qa?t.format():qa.prototype.format.call(t)}function lf(t,h){return db(t,!1,!0).resolve(h)}function mf(t,h){return t?db(t,!1,!0).resolveObject(h):h}qa.prototype.parse=function(t,h,r){if(!ua.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t.indexOf("?"),a=-1!==s&&s<t.indexOf("#")?"?":"#",e=t.split(a);e[0]=e[0].replace(/\\/g,"/");var o=t=e.join(a);if(o=o.trim(),!r&&1===t.split("#").length){var $=df.exec(o);if($)return this.path=o,this.href=o,this.pathname=$[1],$[2]?(this.search=$[2],this.query=h?Uc(this.search.substr(1)):this.search.substr(1)):h&&(this.search="",this.query={}),this}var n=bf.exec(o);if(n){var i=(n=n[0]).toLowerCase();this.protocol=i,o=o.substr(n.length)}if(r||n||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===o.substr(0,2);!l||n&&Yb[n]||(o=o.substr(2),this.slashes=!0)}if(!Yb[n]&&(l||n&&!Va[n])){for(var p,u,c=-1,v=0;v<Xc.length;v++){-1!==(d=o.indexOf(Xc[v]))&&(-1===c||d<c)&&(c=d)}-1!==(u=-1===c?o.lastIndexOf("@"):o.lastIndexOf("@",c))&&(p=o.slice(0,u),o=o.slice(u+1),this.auth=decodeURIComponent(p)),c=-1;for(v=0;v<Wc.length;v++){var d;-1!==(d=o.indexOf(Wc[v]))&&(-1===c||d<c)&&(c=d)}-1===c&&(c=o.length),this.host=o.slice(0,c),o=o.slice(c),this.parseHost(),this.hostname=this.hostname||"";var f="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!f)for(var m=this.hostname.split(/\./),F=(v=0,m.length);v<F;v++){var Z=m[v];if(Z&&!Z.match(Yc)){for(var g="",y=0,P=Z.length;y<P;y++)Z.charCodeAt(y)>127?g+="x":g+=Z[y];if(!g.match(Yc)){var x=m.slice(0,v),b=m.slice(v+1),q=Z.match(hf);q&&(x.push(q[1]),b.unshift(q[2])),b.length&&(o="/"+b.join(".")+o),this.hostname=x.join(".");break}}}this.hostname.length>gf?this.hostname="":this.hostname=this.hostname.toLowerCase(),f||(this.hostname=Ne.toASCII(this.hostname));var O=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+O,this.href+=this.host,f&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!jf[i])for(v=0,F=Xb.length;v<F;v++){var U=Xb[v];if(-1!==o.indexOf(U)){var C=encodeURIComponent(U);C===U&&(C=escape(U)),o=o.split(U).join(C)}}var A=o.indexOf("#");-1!==A&&(this.hash=o.substr(A),o=o.slice(0,A));var w=o.indexOf("?");if(-1!==w?(this.search=o.substr(w),this.query=o.substr(w+1),h&&(this.query=Uc(this.query)),o=o.slice(0,w)):h&&(this.search="",this.query={}),o&&(this.pathname=o),Va[i]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){O=this.pathname||"";var E=this.search||"";this.path=O+E}return this.href=this.format(),this},qa.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var h=this.protocol||"",r=this.pathname||"",s=this.hash||"",a=!1,e="";this.host?a=t+this.host:this.hostname&&(a=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&ua.isObject(this.query)&&Object.keys(this.query).length&&(e=Ye(this.query));var o=this.search||e&&"?"+e||"";return h&&":"!==h.substr(-1)&&(h+=":"),this.slashes||(!h||Va[h])&&!1!==a?(a="//"+(a||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):a||(a=""),s&&"#"!==s.charAt(0)&&(s="#"+s),o&&"?"!==o.charAt(0)&&(o="?"+o),h+a+(r=r.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+s},qa.prototype.resolve=function(t){return this.resolveObject(db(t,!1,!0)).format()},qa.prototype.resolveObject=function(t){if(ua.isString(t)){var h=new qa;h.parse(t,!1,!0),t=h}for(var r=new qa,s=Object.keys(this),a=0;a<s.length;a++){var e=s[a];r[e]=this[e]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),$=0;$<o.length;$++){var n=o[$];"protocol"!==n&&(r[n]=t[n])}return Va[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!Va[t.protocol]){for(var i=Object.keys(t),l=0;l<i.length;l++){var p=i[l];r[p]=t[p]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||Yb[t.protocol])r.pathname=t.pathname;else{for(var u=(t.pathname||"").split("/");u.length&&!(t.host=u.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==u[0]&&u.unshift(""),u.length<2&&u.unshift(""),r.pathname=u.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var c=r.pathname||"",v=r.search||"";r.path=c+v}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var d=r.pathname&&"/"===r.pathname.charAt(0),f=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=f||d||r.host&&t.pathname,F=m,Z=r.pathname&&r.pathname.split("/")||[],g=(u=t.pathname&&t.pathname.split("/")||[],r.protocol&&!Va[r.protocol]);if(g&&(r.hostname="",r.port=null,r.host&&(""===Z[0]?Z[0]=r.host:Z.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===u[0]?u[0]=t.host:u.unshift(t.host)),t.host=null),m=m&&(""===u[0]||""===Z[0])),f)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,Z=u;else if(u.length)Z||(Z=[]),Z.pop(),Z=Z.concat(u),r.search=t.search,r.query=t.query;else if(!ua.isNullOrUndefined(t.search)){if(g)r.hostname=r.host=Z.shift(),(q=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=q.shift(),r.host=r.hostname=q.shift());return r.search=t.search,r.query=t.query,ua.isNull(r.pathname)&&ua.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!Z.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var y=Z.slice(-1)[0],P=(r.host||t.host||Z.length>1)&&("."===y||".."===y)||""===y,x=0,b=Z.length;b>=0;b--)"."===(y=Z[b])?Z.splice(b,1):".."===y?(Z.splice(b,1),x++):x&&(Z.splice(b,1),x--);if(!m&&!F)for(;x--;x)Z.unshift("..");!m||""===Z[0]||Z[0]&&"/"===Z[0].charAt(0)||Z.unshift(""),P&&"/"!==Z.join("/").substr(-1)&&Z.push("");var q,O=""===Z[0]||Z[0]&&"/"===Z[0].charAt(0);g&&(r.hostname=r.host=O?"":Z.length?Z.shift():"",(q=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=q.shift(),r.host=r.hostname=q.shift()));return(m=m||r.host&&Z.length)&&!O&&Z.unshift(""),Z.length?r.pathname=Z.join("/"):(r.pathname=null,r.path=null),ua.isNull(r.pathname)&&ua.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},qa.prototype.parseHost=function(){var t=this.host,h=cf.exec(t);h&&(":"!==(h=h[0])&&(this.port=h.substr(1)),t=t.substr(0,t.length-h.length)),t&&(this.hostname=t)};var tb=Mb(ue);var Zc=Mb(xe);var e=Mb(Ua);aa.RETINA_PREFIX=/@([0-9\.]+)x/,aa.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var $c,nf=!1,_c="5.3.8";function of(e){var r;if(!nf){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var t=["\n %c %c %c PixiJS "+_c+" - \u2730 "+e+" \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(r=window.console).log.apply(r,t)}else window.console&&window.console.log("PixiJS "+_c+" - "+e+" - http://www.pixijs.com/");nf=!0}}function pf(){return void 0===$c&&($c=function(){var e={stencil:!0,failIfMajorPerformanceCaveat:aa.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var r=document.createElement("canvas"),t=r.getContext("webgl",e)||r.getContext("experimental-webgl",e),$=!(!t||!t.getContextAttributes().stencil);if(t){var o=t.getExtension("WEBGL_lose_context");o&&o.loseContext()}return t=null,$}catch(n){return!1}}()),$c}function Zb(e,r){return void 0===r&&(r=[]),r[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(255&e)/255,r}function qf(e){var r=e.toString(16);return"#"+(r="000000".substr(0,6-r.length)+r)}function rf(){for(var e=[],r=[],t=0;t<32;t++)e[t]=t,r[t]=t;e[X.NORMAL_NPM]=X.NORMAL,e[X.ADD_NPM]=X.ADD,e[X.SCREEN_NPM]=X.SCREEN,r[X.NORMAL]=X.NORMAL_NPM,r[X.ADD]=X.ADD_NPM,r[X.SCREEN]=X.SCREEN_NPM;var $=[];return $.push(r),$.push(e),$}var sf=rf();function ad(e,r){if(1===r)return(255*r<<24)+e;if(0===r)return 0;var t=e>>16&255,$=e>>8&255,o=255&e;return(255*r<<24)+((t=t*r+.5|0)<<16)+(($=$*r+.5|0)<<8)+(o=o*r+.5|0)}var f={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function ub(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function bd(e){return!(e&e-1||!e)}function cd(e){var r=(e>65535?1:0)<<4,t=((e>>>=r)>255?1:0)<<3;return r|=t,r|=t=((e>>>=t)>15?1:0)<<2,(r|=t=((e>>>=t)>3?1:0)<<1)|(e>>>=t)>>1}function vb(e,r,t){var $,o=e.length;if(!(r>=o||0===t)){var n=o-(t=r+t>o?o-r:t);for($=r;$<n;++$)e[$]=e[$+t];e.length=n}}var tf=0;function wb(){return++tf}var dd={};function xb(e,r,t){if(void 0===t&&(t=3),!dd[r]){var $=new Error().stack;void 0===$?console.warn("PixiJS Deprecation Warning: ",r+"\nDeprecated since v"+e):($=$.split("\n").splice(t).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r+"\nDeprecated since v"+e),console.warn($),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r+"\nDeprecated since v"+e),console.warn($))),dd[r]=!0}}var ed={},ya=Object.create(null),Ka=Object.create(null);var g=function(){function e(e,r,t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=t||aa.RESOLUTION,this.resize(e,r)}return e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},e.prototype.resize=function(e,r){this.canvas.width=e*this.resolution,this.canvas.height=r*this.resolution},e.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),e}();var $b;function uf(e,r){if(void 0===r&&(r=window.location),0===e.indexOf("data:"))return"";r=r||window.location,$b||($b=document.createElement("a")),$b.href=e;var t=Vc($b.href),$=!t.port&&""===r.port||t.port===r.port;return t.hostname===r.hostname&&$&&t.protocol===r.protocol?"":"anonymous"}function fd(e,r){var t=aa.RETINA_PREFIX.exec(e);return t?parseFloat(t[1]):void 0!==r?r:1}var ka=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,i,r,s,o,u){if(arguments.length>8)throw new Error("max arguments reached");var h=this.name,p=this.items;this._aliasCount++;for(var a=0,m=p.length;a<m;a++)p[a][h](t,e,n,i,r,s,o,u);return p===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(ka.prototype,{dispatch:{value:ka.prototype.emit},run:{value:ka.prototype.emit}});var vf,yb;aa.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(yb||(vf=yb={},vf));var _b=function(){function t(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=0),void 0===s&&(s=!1),this.fn=t,this.context=e,this.priority=i,this.once=s,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Da=function(){function t(){var t=this;this._head=new _b(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/aa.TARGET_FPMS,this.elapsedMS=1/aa.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,i){return void 0===i&&(i=yb.NORMAL),this._addListener(new _b(t,e,i))},t.prototype.addOnce=function(t,e,i){return void 0===i&&(i=yb.NORMAL),this._addListener(new _b(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*aa.TARGET_FPMS;for(var s=this._head,r=s.next;r;)r=r.emit(this.deltaTime);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,aa.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),h=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,yb.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Da.shared:new Da,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t}();var wf,ea,eb=2*Math.PI,xf=180/Math.PI,yf=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(ea||(wf=ea={},wf));var fa=function(){function t(t,i,o,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.x=Number(t),this.y=Number(i),this.width=Number(o),this.height=Number(s),this.type=ea.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,i){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height},t.prototype.pad=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i,this},t.prototype.fit=function(t){var i=Math.max(this.x,t.x),o=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),h=Math.min(this.y+this.height,t.y+t.height);return this.x=i,this.width=Math.max(o-i,0),this.y=s,this.height=Math.max(h-s,0),this},t.prototype.ceil=function(t,i){void 0===t&&(t=1),void 0===i&&(i=.001);var o=Math.ceil((this.x+this.width-i)*t)/t,s=Math.ceil((this.y+this.height-i)*t)/t;return this.x=Math.floor((this.x+i)*t)/t,this.y=Math.floor((this.y+i)*t)/t,this.width=o-this.x,this.height=s-this.y,this},t.prototype.enlarge=function(t){var i=Math.min(this.x,t.x),o=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),h=Math.max(this.y+this.height,t.y+t.height);return this.x=i,this.width=o-i,this.y=s,this.height=h-s,this},t}(),zf=function(){function t(t,i,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),this.x=t,this.y=i,this.radius=o,this.type=ea.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,i){if(this.radius<=0)return!1;var o=this.radius*this.radius,s=this.x-t,h=this.y-i;return(s*=s)+(h*=h)<=o},t.prototype.getBounds=function(){return new fa(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}(),Af=function(){function t(t,i,o,s){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.x=t,this.y=i,this.width=o,this.height=s,this.type=ea.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var o=(t-this.x)/this.width,s=(i-this.y)/this.height;return(o*=o)+(s*=s)<=1},t.prototype.getBounds=function(){return new fa(this.x-this.width,this.y-this.height,this.width,this.height)},t}(),zb=function(){function t(){for(var t=arguments,i=[],o=0;o<arguments.length;o++)i[o]=t[o];var s=Array.isArray(i[0])?i[0]:i;if("number"!=typeof s[0]){for(var h=[],r=0,e=s.length;r<e;r++)h.push(s[r].x,s[r].y);s=h}this.points=s,this.type=ea.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var i=new t(this.points.slice());return i.closeStroke=this.closeStroke,i},t.prototype.contains=function(t,i){for(var o=!1,s=this.points.length/2,h=0,r=s-1;h<s;r=h++){var e=this.points[2*h],n=this.points[2*h+1],a=this.points[2*r],$=this.points[2*r+1];n>i!=$>i&&t<(i-n)/($-n)*(a-e)+e&&(o=!o)}return o},t}(),Bf=function(){function t(t,i,o,s,h){void 0===t&&(t=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===h&&(h=20),this.x=t,this.y=i,this.width=o,this.height=s,this.radius=h,this.type=ea.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){if(i>=this.y+this.radius&&i<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var o=t-(this.x+this.radius),s=i-(this.y+this.radius),h=this.radius*this.radius;if(o*o+s*s<=h)return!0;if((o=t-(this.x+this.width-this.radius))*o+s*s<=h)return!0;if(o*o+(s=i-(this.y+this.height-this.radius))*s<=h)return!0;if((o=t-(this.x+this.radius))*o+s*s<=h)return!0}return!1},t}(),Ea=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x=t,this.y=i,this},t}(),Ab=function(){function t(t,i,o,s){void 0===o&&(o=0),void 0===s&&(s=0),this._x=o,this._y=s,this.cb=t,this.scope=i}return t.prototype.clone=function(i,o){return void 0===i&&(i=this.cb),void 0===o&&(o=this.scope),new t(i,o,this._x,this._y)},t.prototype.set=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this._x===t&&this._y===i||(this._x=t,this._y=i,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),na=function(){function t(t,i,o,s,h,r){void 0===t&&(t=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=1),void 0===h&&(h=0),void 0===r&&(r=0),this.array=null,this.a=t,this.b=i,this.c=o,this.d=s,this.tx=h,this.ty=r}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,i,o,s,h,r){return this.a=t,this.b=i,this.c=o,this.d=s,this.tx=h,this.ty=r,this},t.prototype.toArray=function(t,i){this.array||(this.array=new Float32Array(9));var o=i||this.array;return t?(o[0]=this.a,o[1]=this.b,o[2]=0,o[3]=this.c,o[4]=this.d,o[5]=0,o[6]=this.tx,o[7]=this.ty,o[8]=1):(o[0]=this.a,o[1]=this.c,o[2]=this.tx,o[3]=this.b,o[4]=this.d,o[5]=this.ty,o[6]=0,o[7]=0,o[8]=1),o},t.prototype.apply=function(t,i){i=i||new Ea;var o=t.x,s=t.y;return i.x=this.a*o+this.c*s+this.tx,i.y=this.b*o+this.d*s+this.ty,i},t.prototype.applyInverse=function(t,i){i=i||new Ea;var o=1/(this.a*this.d+this.c*-this.b),s=t.x,h=t.y;return i.x=this.d*o*s+-this.c*o*h+(this.ty*this.c-this.tx*this.d)*o,i.y=this.a*o*h+-this.b*o*s+(-this.ty*this.a+this.tx*this.b)*o,i},t.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},t.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},t.prototype.rotate=function(t){var i=Math.cos(t),o=Math.sin(t),s=this.a,h=this.c,r=this.tx;return this.a=s*i-this.b*o,this.b=s*o+this.b*i,this.c=h*i-this.d*o,this.d=h*o+this.d*i,this.tx=r*i-this.ty*o,this.ty=r*o+this.ty*i,this},t.prototype.append=function(t){var i=this.a,o=this.b,s=this.c,h=this.d;return this.a=t.a*i+t.b*s,this.b=t.a*o+t.b*h,this.c=t.c*i+t.d*s,this.d=t.c*o+t.d*h,this.tx=t.tx*i+t.ty*s+this.tx,this.ty=t.tx*o+t.ty*h+this.ty,this},t.prototype.setTransform=function(t,i,o,s,h,r,e,n,a){return this.a=Math.cos(e+a)*h,this.b=Math.sin(e+a)*h,this.c=-Math.sin(e-n)*r,this.d=Math.cos(e-n)*r,this.tx=t-(o*this.a+s*this.c),this.ty=i-(o*this.b+s*this.d),this},t.prototype.prepend=function(t){var i=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var o=this.a,s=this.c;this.a=o*t.a+this.b*t.c,this.b=o*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var i=this.a,o=this.b,s=this.c,h=this.d,r=-Math.atan2(-s,h),e=Math.atan2(o,i),n=Math.abs(r+e);return n<1e-5||Math.abs(eb-n)<1e-5?(t.rotation=e,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=r,t.skew.y=e),t.scale.x=Math.sqrt(i*i+o*o),t.scale.y=Math.sqrt(s*s+h*h),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,i=this.b,o=this.c,s=this.d,h=this.tx,r=t*s-i*o;return this.a=s/r,this.b=-i/r,this.c=-o/r,this.d=t/r,this.tx=(o*this.ty-s*h)/r,this.ty=-(t*this.ty-i*h)/r,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var i=new t;return i.a=this.a,i.b=this.b,i.c=this.c,i.d=this.d,i.tx=this.tx,i.ty=this.ty,i},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),La=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ma=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Na=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Oa=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ac=[],gd=[],Bb=Math.sign;function Cf(){for(var t=0;t<16;t++){var i=[];ac.push(i);for(var o=0;o<16;o++)for(var s=Bb(La[t]*La[o]+Na[t]*Ma[o]),h=Bb(Ma[t]*La[o]+Oa[t]*Ma[o]),r=Bb(La[t]*Na[o]+Na[t]*Oa[o]),e=Bb(Ma[t]*Na[o]+Oa[t]*Oa[o]),n=0;n<16;n++)if(La[n]===s&&Ma[n]===h&&Na[n]===r&&Oa[n]===e){i.push(n);break}}for(t=0;t<16;t++){var a=new na;a.set(La[t],Ma[t],Na[t],Oa[t],0,0),gd.push(a)}}Cf();var da={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return La[t]},uY:function(t){return Ma[t]},vX:function(t){return Na[t]},vY:function(t){return Oa[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,i){return ac[t][i]},sub:function(t,i){return ac[t][da.inv(i)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,i){return 2*Math.abs(t)<=Math.abs(i)?i>=0?da.S:da.N:2*Math.abs(i)<=Math.abs(t)?t>0?da.E:da.W:i>0?t>0?da.SE:da.SW:t>0?da.NE:da.NW},matrixAppendRotationInv:function(t,i,o,s){void 0===o&&(o=0),void 0===s&&(s=0);var h=gd[da.inv(i)];h.tx=o,h.ty=s,t.append(h)}},Df=function(){function t(){this.worldTransform=new na,this.localTransform=new na,this.position=new Ab(this.onChange,this,0,0),this.scale=new Ab(this.onChange,this,1,1),this.pivot=new Ab(this.onChange,this,0,0),this.skew=new Ab(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var i=this.localTransform;if(this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var o=t.worldTransform,s=this.worldTransform;s.a=i.a*o.a+i.b*o.c,s.b=i.a*o.b+i.b*o.d,s.c=i.c*o.a+i.d*o.c,s.d=i.c*o.b+i.d*o.d,s.tx=i.tx*o.a+i.ty*o.c+o.tx,s.ty=i.tx*o.b+i.ty*o.d+o.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();aa.PREFER_ENV=Ia.any?za.WEBGL:za.WEBGL2,aa.STRICT_TEXTURE_CACHE=!1;var bc=[];function hd(e,t){if(!e)return null;var r="";if("string"==typeof e){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(var n=bc.length-1;n>=0;--n){var o=bc[n];if(o.test&&o.test(e,r))return new o(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var Ef=function(e,t){return(Ef=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function ba(e,t){function r(){this.constructor=e}Ef(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fb=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new ka("setRealSize"),this.onUpdate=new ka("update"),this.onError=new ka("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),cc=function(e){function t(t,r){var i=this,n=r||{},o=n.width,a=n.height;if(!o||!a)throw new Error("BufferResource width or height invalid");return(i=e.call(this,o,a)||this).data=t,i}return ba(t,e),t.prototype.upload=function(e,t,r){var i=e.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===Ja.UNPACK),r.width===t.width&&r.height===t.height?i.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,i.texImage2D(t.target,0,r.internalFormat,t.width,t.height,0,t.format,r.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(fb),Ff={scaleMode:Ba.NEAREST,format:mb.RGBA,alphaMode:Ja.NPM},ia=function(e){function t(t,r){void 0===t&&(t=null),void 0===r&&(r=null);var i=e.call(this)||this,n=(r=r||{}).alphaMode,o=r.mipmap,a=r.anisotropicLevel,s=r.scaleMode,u=r.width,p=r.height,h=r.wrapMode,$=r.format,l=r.type,d=r.target,c=r.resolution,f=r.resourceOptions;return!t||t instanceof fb||((t=hd(t,f)).internal=!0),i.width=u||0,i.height=p||0,i.resolution=c||aa.RESOLUTION,i.mipmap=void 0!==o?o:aa.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==a?a:aa.ANISOTROPIC_LEVEL,i.wrapMode=h||aa.WRAP_MODE,i.scaleMode=void 0!==s?s:aa.SCALE_MODE,i.format=$||mb.RGBA,i.type=l||ta.UNSIGNED_BYTE,i.target=d||Sa.TEXTURE_2D,i.alphaMode=void 0!==n?n:Ja.UNPACK,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.uid=wb(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=u>0&&p>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(t),i}return ba(t,e),Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},t.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=bd(this.realWidth)&&bd(this.realHeight)},t.prototype.setResolution=function(e){var t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT(),this)},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ka[this.cacheId],delete ya[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,r,i){void 0===i&&(i=aa.STRICT_TEXTURE_CACHE);var n="string"==typeof e,o=null;n?o=e:(e._pixiId||(e._pixiId="pixiid_"+wb()),o=e._pixiId);var a=Ka[o];if(n&&i&&!a)throw new Error("The cacheId \""+o+"\" does not exist in BaseTextureCache.");return a||((a=new t(e,r)).cacheId=o,t.addToCache(a,o)),a},t.fromBuffer=function(e,r,i,n){e=e||new Float32Array(r*i*4);var o=new cc(e,{width:r,height:i}),a=e instanceof Float32Array?ta.FLOAT:ta.UNSIGNED_BYTE;return new t(o,Object.assign(Ff,n||{width:r,height:i,type:a}))},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),Ka[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),Ka[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=Ka[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete Ka[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)delete Ka[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(tb.d),id=function(e){function t(t,r){var i=this,n=r||{},o=n.width,a=n.height;(i=e.call(this,o,a)||this).items=[],i.itemDirtyIds=[];for(var s=0;s<t;s++){var u=new ia;i.items.push(u),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return ba(t,e),t.prototype.initFromArray=function(e,t){for(var r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof fb?this.addResourceAt(e[r],r):this.addResourceAt(hd(e[r],t),r))},t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map(function(e){return e.resource}).filter(function(e){return e}).map(function(e){return e.load()});return this._load=Promise.all(t).then(function(){var t=e.items[0],r=t.realWidth,i=t.realHeight;return e.resize(r,i),Promise.resolve(e)}),this._load},t}(fb),Gf=function(e){function t(t,r){var i,n,o=this,a=r||{},s=a.width,u=a.height;return Array.isArray(t)?(i=t,n=t.length):n=t,o=e.call(this,n,{width:s,height:u})||this,i&&o.initFromArray(i,r),o}return ba(t,e),t.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=Sa.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,t,r){var i=this.length,n=this.itemDirtyIds,o=this.items,a=e.gl;r.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,i,0,t.format,t.type,null);for(var s=0;s<i;s++){var u=o[s];n[s]<u.dirtyId&&(n[s]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,s,u.resource.width,u.resource.height,1,t.format,t.type,u.resource.source))}return!0},t}(id),Fa=function(e){function t(t){var r=this,i=t,n=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(r=e.call(this,n,o)||this).source=t,r.noSubImage=!1,r}return ba(t,e),t.crossOrigin=function(e,t,r){void 0===r&&0!==t.indexOf("data:")?e.crossOrigin=uf(t):!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous")},t.prototype.upload=function(e,t,r,i){var n=e.gl,o=t.realWidth,a=t.realHeight;return i=i||this.source,n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===Ja.UNPACK),this.noSubImage||t.target!==n.TEXTURE_2D||r.width!==o||r.height!==a?(r.width=o,r.height=a,n.texImage2D(t.target,0,t.format,t.format,t.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.format,t.type,i),!0},t.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),e.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(fb),jd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ba(t,e),t.test=function(e){var t=window.OffscreenCanvas;return!!(t&&e instanceof t)||e instanceof HTMLCanvasElement},t}(Fa),Hf=function(e){function t(r,i){var n=this,o=i||{},a=o.width,s=o.height,u=o.autoLoad,p=o.linkBaseTexture;if(r&&r.length!==t.SIDES)throw new Error("Invalid length. Got "+r.length+", expected 6");n=e.call(this,6,{width:a,height:s})||this;for(var h=0;h<t.SIDES;h++)n.items[h].target=Sa.TEXTURE_CUBE_MAP_POSITIVE_X+h;return n.linkBaseTexture=!1!==p,r&&n.initFromArray(r,i),!1!==u&&n.load(),n}return ba(t,e),t.prototype.bind=function(t){e.prototype.bind.call(this,t),t.target=Sa.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw new Error("Index "+t+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,t)}else e.target=Sa.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this},t.prototype.upload=function(e,r,i){for(var n=this.itemDirtyIds,o=0;o<t.SIDES;o++){var a=this.items[o];n[o]<a.dirtyId&&(a.valid&&a.resource?(a.resource.upload(e,a,i),n[o]=a.dirtyId):n[o]<-1&&(e.gl.texImage2D(a.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),n[o]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(id),kd=function(e){function t(t,r){var i=this;if(r=r||{},!(t instanceof HTMLImageElement)){var n=new Image;Fa.crossOrigin(n,t,r.crossorigin),n.src=t,t=n}return i=e.call(this,t)||this,!t.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=t.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==r.createBitmap?r.createBitmap:aa.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,i.alphaMode="number"==typeof r.alphaMode?r.alphaMode:null,void 0!==r.premultiplyAlpha&&(i.premultiplyAlpha=r.premultiplyAlpha),i.bitmap=null,i._load=null,!1!==r.autoLoad&&i.load(),i}return ba(t,e),t.prototype.load=function(e){var t=this;return this._load?this._load:(void 0!==e&&(this.createBitmap=e),this._load=new Promise(function(e,r){var i=t.source;t.url=i.src;var n=function(){t.destroyed||(i.onload=null,i.onerror=null,t.resize(i.width,i.height),t._load=null,t.createBitmap?e(t.process()):e(t))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(e){r(e),t.onError.emit(e)})}),this._load)},t.prototype.process=function(){var e=this,t=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(t,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===Ja.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},t.prototype.upload=function(t,r,i){if("number"==typeof this.alphaMode&&(r.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,r,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,r,i,this.bitmap),!this.preserveBitmap){var n=!0,o=r._glTextures;for(var a in o){var s=o[a];if(s!==i&&s.dirtyId!==r.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return"string"==typeof e||e instanceof HTMLImageElement},t}(Fa),If=function(e){function t(t,r){var i=this;return r=r||{},(i=e.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=t,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,!1!==r.autoLoad&&i.load(),i}return ba(t,e),t.prototype.load=function(){var e=this;return this._load?this._load:(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var e=this,t=new Image;Fa.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){e._resolve&&(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var r=t.width,i=t.height;if(!r||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var n=r*e.scale,o=i*e.scale;(e._overrideWidth||e._overrideHeight)&&(n=e._overrideWidth||e._overrideHeight/i*r,o=e._overrideHeight||e._overrideWidth/r*i),n=Math.round(n),o=Math.round(o);var a=e.source;a.width=n,a.height=o,a._pixiId="canvas_"+wb(),a.getContext("2d").drawImage(t,0,0,r,i,0,0,n,o),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return"svg"===t||"string"==typeof e&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||"string"==typeof e&&0===e.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(Fa),Jf=function(e){function t(r,i){var n=this;if(i=i||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var a=r[0].src||r[0];Fa.crossOrigin(o,a,i.crossorigin);for(var s=0;s<r.length;++s){var u=document.createElement("source"),p=r[s],h=p.src,$=p.mime,l=(h=h||r[s]).split("?").shift().toLowerCase(),d=l.substr(l.lastIndexOf(".")+1);$=$||t.MIME_TYPES[d]||"video/"+d,u.src=h,u.type=$,o.appendChild(u)}r=o}return(n=e.call(this,r)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==i.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==i.autoLoad&&n.load(),n}return ba(t,e),t.prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var r=Da.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(function(r){e.valid?r(e):(e._resolve=r,t.load())}),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return 3===e.readyState||4===e.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Da.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Da.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&Da.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(Da.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Da.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(Fa),Kf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ba(t,e),t.test=function(e){return!!window.createImageBitmap&&e instanceof ImageBitmap},t}(Fa);bc.push(kd,Kf,jd,Jf,If,cc,Hf,Gf);var oa=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}(),Lf=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ba(t,e),t.prototype.upload=function(e,t,r){var i=e.gl;return i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===Ja.UNPACK),r.width===t.width&&r.height===t.height?i.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(r.width=t.width,r.height=t.height,i.texImage2D(t.target,0,1===e.context.webGLVersion?i.DEPTH_COMPONENT:i.DEPTH_COMPONENT16,t.width,t.height,0,t.format,t.type,this.data)),!0},t}(cc),dc=function(){function e(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ka("disposeFramebuffer"),this.multisample=Za.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new ia(null,{scaleMode:Ba.NEAREST,resolution:1,mipmap:nb.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new ia(new Lf(null,{width:this.width,height:this.height}),{scaleMode:Ba.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:nb.OFF,format:mb.DEPTH_COMPONENT,type:ta.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(e/n,t/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}(),Cb=function(e){function t(t){var r=this;"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});r=e.call(this,null,t)||this;var i=t||{},n=i.width,o=i.height;return r.mipmap=0,r.width=Math.ceil(n)||100,r.height=Math.ceil(o)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new dc(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return ba(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(ia),ld=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var i=t.width,n=t.height;if(r){var o=e.width/2/i,a=e.height/2/n,s=e.x/i+o,u=e.y/n+a;r=da.add(r,da.NW),this.x0=s+o*da.uX(r),this.y0=u+a*da.uY(r),r=da.add(r,2),this.x1=s+o*da.uX(r),this.y1=u+a*da.uY(r),r=da.add(r,2),this.x2=s+o*da.uX(r),this.y2=u+a*da.uY(r),r=da.add(r,2),this.x3=s+o*da.uX(r),this.y3=u+a*da.uY(r)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e}(),md=new ld,la=function(e){function t(r,i,n,o,a,s){var u=e.call(this)||this;if(u.noFrame=!1,i||(u.noFrame=!0,i=new fa(0,0,1,1)),r instanceof t&&(r=r.baseTexture),u.baseTexture=r,u._frame=i,u.trim=o,u.valid=!1,u._uvs=md,u.uvMatrix=null,u.orig=n||i,u._rotate=Number(a||0),!0===a)u._rotate=2;else if(u._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return u.defaultAnchor=s?new Ea(s.x,s.y):new Ea(0,0),u._updateID=0,u.textureCacheIds=[],r.valid?u.noFrame?r.valid&&u.onBaseTextureUpdated(r):u.frame=i:r.once("loaded",u.onBaseTextureUpdated,u),u.noFrame&&r.on("update",u.onBaseTextureUpdated,u),u}return ba(t,e),t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var r=this.baseTexture;r&&r.url&&ya[r.url]&&t.removeFromCache(r.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){return new t(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},t.prototype.updateUvs=function(){this._uvs===md&&(this._uvs=new ld),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,r,i){void 0===r&&(r={}),void 0===i&&(i=aa.STRICT_TEXTURE_CACHE);var n="string"==typeof e,o=null;n?o=e:(e._pixiId||(e._pixiId="pixiid_"+wb()),o=e._pixiId);var a=ya[o];if(n&&i&&!a)throw new Error("The cacheId \""+o+"\" does not exist in TextureCache.");return a||(r.resolution||(r.resolution=fd(e)),(a=new t(new ia(e,r))).baseTexture.cacheId=o,ia.addToCache(a.baseTexture,o),t.addToCache(a,o)),a},t.fromURL=function(e,r){var i=Object.assign({autoLoad:!1},null==r?void 0:r.resourceOptions),n=t.from(e,Object.assign({resourceOptions:i},r),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then(function(){return Promise.resolve(n)})},t.fromBuffer=function(e,r,i,n){return new t(ia.fromBuffer(e,r,i,n))},t.fromLoader=function(e,r,i){var n=new kd(e);n.url=r;var o=new t(new ia(n,{scaleMode:aa.SCALE_MODE,resolution:fd(r)}));return i||(i=r),ia.addToCache(o.baseTexture,i),t.addToCache(o,i),i!==r&&(ia.addToCache(o.baseTexture,r),t.addToCache(o,r)),o},t.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),ya[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),ya[t]=e)},t.removeFromCache=function(e){if("string"==typeof e){var t=ya[e];if(t){var r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete ya[e],t}}else if(e&&e.textureCacheIds){for(var i=0;i<e.textureCacheIds.length;++i)ya[e.textureCacheIds[i]]===e&&delete ya[e.textureCacheIds[i]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,i=e.width,n=e.height,o=t+i>this.baseTexture.width,a=r+n>this.baseTexture.height;if(o||a){var s=o&&a?"and":"or",u="X: "+t+" + "+i+" = "+(t+i)+" > "+this.baseTexture.width,p="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+s+" "+p)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},t}(tb.d);function Mf(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new la(new ia(new jd(e)))}function Db(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}la.EMPTY=new la(new ia()),Db(la.EMPTY),Db(la.EMPTY.baseTexture),la.WHITE=Mf(),Db(la.WHITE),Db(la.WHITE.baseTexture);var nd=function(e){function t(t,r){var i=this,n=null;if(!(t instanceof Cb)){var o=arguments[1],a=arguments[2],s=arguments[3],u=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+a+") instead of the ctor directly."),n=arguments[0],r=null,t=new Cb({width:o,height:a,scaleMode:s,resolution:u})}return(i=e.call(this,t,r)||this).legacyRenderer=n,i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return ba(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){return"number"==typeof e&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new Cb(e))},t}(la),Nf=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new Cb(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new nd(r)},e.prototype.getOptimalTexture=function(t,r,i){void 0===i&&(i=1);var n=e.SCREEN_KEY;t*=i,r*=i,this.enableFullScreen&&t===this._pixelsWidth&&r===this._pixelsHeight||(n=(65535&(t=ub(t)))<<16|65535&(r=ub(r))),this.texturePool[n]||(this.texturePool[n]=[]);var o=this.texturePool[n].pop();return o||(o=this.createTexture(t,r)),o.filterPoolKey=n,o.setResolution(i),o},e.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,i=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,i)for(var n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}(),od=function(){function e(e,t,r,i,n,o,a){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=e,this.size=t,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=a}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,i,n,o){return new e(t,r,i,n,o)},e}(),Of=0,sa=function(){function e(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=Of++,this.disposeRunner=new ka("disposeBuffer")}return e.prototype.update=function(e){this.data=e||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}();function pd(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}var Pf={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Qf(e,t){for(var r=0,i=0,n={},o=0;o<e.length;o++)i+=t[o],r+=e[o].length;var a=new ArrayBuffer(4*r),s=null,u=0;for(o=0;o<e.length;o++){var p=t[o],h=e[o],$=pd(h);n[$]||(n[$]=new Pf[$](a)),s=n[$];for(var l=0;l<h.length;l++){s[(l/p|0)*i+u+l%p]=h[l]}u+=p}return new Float32Array(a)}var qd={5126:4,5123:2,5121:1},Rf=0,Sf={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},ec=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=Rf++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ka("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,i,n,o,a,s){if(void 0===r&&(r=0),void 0===i&&(i=!1),void 0===s&&(s=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof sa||(t instanceof Array&&(t=new Float32Array(t)),t=new sa(t));var u=e.split("|");if(u.length>1){for(var p=0;p<u.length;p++)this.addAttribute(u[p],t,r,i,n);return this}var h=this.buffers.indexOf(t);return-1===h&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new od(h,r,i,n,o,a,s),this.instanced=this.instanced||s,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof sa||(e instanceof Array&&(e=new Uint16Array(e)),e=new sa(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],r=[],i=new sa;for(e in this.attributes){var n=this.attributes[e],o=this.buffers[n.buffer];t.push(o.data),r.push(n.size*qd[n.type]/4),n.buffer=0}for(i.data=Qf(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,r=0;r<this.buffers.length;r++)t.buffers[r]=new sa(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new od(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,i=new e,n=[],o=[],a=[],s=0;s<t.length;s++){r=t[s];for(var u=0;u<r.buffers.length;u++)o[u]=o[u]||0,o[u]+=r.buffers[u].data.length,a[u]=0}for(s=0;s<r.buffers.length;s++)n[s]=new Sf[pd(r.buffers[s].data)](o[s]),i.buffers[s]=new sa(n[s]);for(s=0;s<t.length;s++){r=t[s];for(u=0;u<r.buffers.length;u++)n[u].set(r.buffers[u].data,a[u]),a[u]+=r.buffers[u].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.index=!0;var p=0,h=0,$=0,l=0;for(s=0;s<r.buffers.length;s++)if(r.buffers[s]!==r.indexBuffer){l=s;break}for(var s in r.attributes){var d=r.attributes[s];(0|d.buffer)===l&&(h+=d.size*qd[d.type]/4)}for(s=0;s<t.length;s++){var c=t[s].indexBuffer.data;for(u=0;u<c.length;u++)i.indexBuffer.data[u+$]+=p;p+=r.buffers[l].data.length/h,$+=c.length}}return i},e}(),Tf=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return ba(t,e),t}(ec),Uf=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new sa(t.vertices),t.uvBuffer=new sa(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return ba(t,e),t.prototype.map=function(e,t){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+t.width/e.width,this.uvs[3]=i,this.uvs[4]=r+t.width/e.width,this.uvs[5]=i+t.height/e.height,this.uvs[6]=r,this.uvs[7]=i+t.height/e.height,r=t.x,i=t.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+t.width,this.vertices[3]=i,this.vertices[4]=r+t.width,this.vertices[5]=i+t.height,this.vertices[6]=r,this.vertices[7]=i+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(ec),Vf=0,Pa=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Vf++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,i){this.uniforms[t]=new e(r,i)},e.from=function(t,r){return new e(t,r)},e}(),Wf=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new fa,this.destinationFrame=new fa,this.filters=[]}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}(),Xf=function(e){function t(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new Nf,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new Tf,r.quadUv=new Uf,r.tempRect=new fa,r.activeState={},r.globalUniforms=new Pa({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return ba(t,e),t.prototype.push=function(e,t){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new Wf,o=t[0].resolution,a=t[0].padding,s=t[0].autoFit,u=t[0].legacy,p=1;p<t.length;p++){var h=t[p];o=Math.min(o,h.resolution),a=this.useMaxPadding?Math.max(a,h.padding):a+h.padding,s=s&&h.autoFit,u=u||h.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=o,n.legacy=u,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(a),s&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(o),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o),n.filters=t,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;var $=this.tempRect;$.width=n.sourceFrame.width,$.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame,$),r.renderTexture.clear()},t.prototype.pop=function(){var e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;var i=this.globalUniforms.uniforms;i.outputFrame=t.sourceFrame,i.resolution=t.resolution;var n=i.inputSize,o=i.inputPixel,a=i.inputClamp;if(n[0]=t.destinationFrame.width,n[1]=t.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=n[0]*t.resolution,o[1]=n[1]*t.resolution,o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=t.sourceFrame.width*n[2]-.5*o[2],a[3]=t.sourceFrame.height*n[3]-.5*o[3],t.legacy){var s=i.filterArea;s[0]=t.destinationFrame.width,s[1]=t.destinationFrame.height,s[2]=t.sourceFrame.x,s[3]=t.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var u=e[e.length-1];if(t.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,u.renderTexture,wa.BLEND,t),this.returnFilterTexture(t.renderTexture);else{var p=t.renderTexture,h=this.getOptimalFilterTexture(p.width,p.height,t.resolution);h.filterFrame=p.filterFrame;var $=0;for($=0;$<r.length-1;++$){r[$].apply(this,p,h,wa.CLEAR,t);var l=p;p=h,h=l}r[$].apply(this,p,u.renderTexture,wa.BLEND,t),this.returnFilterTexture(p),this.returnFilterTexture(h)}t.clear(),this.statePool.push(t)},t.prototype.bindAndClear=function(e,t){if(void 0===t&&(t=wa.CLEAR),e&&e.filterFrame){var r=this.tempRect;r.width=e.filterFrame.width,r.height=e.filterFrame.height,this.renderer.renderTexture.bind(e,e.filterFrame,r)}else this.renderer.renderTexture.bind(e);"boolean"==typeof t&&(t=t?wa.CLEAR:wa.BLEND,xb("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(t===wa.CLEAR||t===wa.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},t.prototype.applyFilter=function(e,t,r,i){var n=this.renderer;this.bindAndClear(r,i),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,n.state.set(e.state),n.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Aa.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Aa.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,o=t._texture.orig,a=e.set(n.width,0,0,n.height,i.x,i.y),s=t.worldTransform.copyTo(na.TEMP_MATRIX);return s.invert(),a.prepend(s),a.scale(1/o.width,1/o.height),a.translate(t.anchor.x,t.anchor.y),a},t.prototype.destroy=function(){this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},t.prototype.getFilterTexture=function(e,t){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return i.filterFrame=e.filterFrame,i},t.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t}(oa),rd=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}(),Yf=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new rd(t),r.currentRenderer=r.emptyRenderer,r}return ba(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,i=t-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)},t.prototype.boundArray=function(e,t,r,i){for(var n=e.elements,o=e.ids,a=e.count,s=0,u=0;u<a;u++){var p=n[u],h=p._batchLocation;if(h>=0&&h<i&&t[h]===p)o[u]=h;else for(;s<i;){var $=t[s];if(!$||$._batchEnabled!==r||$._batchLocation!==s){o[u]=s,p._batchLocation=s,t[s]=p;break}s++}}},t}(oa),sd=0,Zf=function(e){function t(t){var r=e.call(this,t)||this;return r.webGLVersion=1,r.extensions={},r.supports={uint32Indices:!1},r.handleContextLost=r.handleContextLost.bind(r),r.handleContextRestored=r.handleContextRestored.bind(r),t.view.addEventListener("webglcontextlost",r.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",r.handleContextRestored,!1),r}return ba(t,e),Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=sd++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=sd++,this.renderer.runners.contextChange.emit(e)},t.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},t.prototype.createContext=function(e,t){var r;if(aa.PREFER_ENV>=za.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var e=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:e.getExtension("EXT_color_buffer_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear")})},t.prototype.handleContextLost=function(e){e.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in window&&e instanceof window.WebGL2RenderingContext;r&&(this.webGLVersion=2),t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(oa),$f=function(){return function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=Za.NONE,this.msaaBuffer=null,this.blitFramebuffer=null}}(),_f=new fa,ag=function(e){function t(t){var r=e.call(this,t)||this;return r.managedFramebuffers=[],r.unknownFramebuffer=new dc(10,10),r.msaaSamples=null,r}return ba(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new fa,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;aa.PREFER_ENV===za.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)},t.prototype.bind=function(e,t){var r=this.gl;if(e){var i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var n=0;n<e.colorTextures.length;n++){var o=e.colorTextures[n];this.renderer.texture.unbind(o.parentTextureArray||o)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(e,t,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===e&&n.y===t||(n.x=e,n.y=t,n.width=r,n.height=i,this.gl.viewport(e,t,r,i))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(e,t,r,i,n){void 0===n&&(n=Sb.COLOR|Sb.DEPTH);var o=this.gl;o.clearColor(e,t,r,i),o.clear(n)},t.prototype.initFramebuffer=function(e){var t=this.gl,r=new $f(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},t.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var i=e.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},t.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures.length;t.drawBuffers||(i=Math.min(i,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var n=[],o=0;o<i;o++)if(!(0===o&&r.multisample>1)){var a=e.colorTextures[o],s=a.parentTextureArray||a;this.renderer.texture.bind(s,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+o,a.target,s._glTextures[this.CONTEXT_UID].texture,0),n.push(t.COLOR_ATTACHMENT0+o)}if((n.length>1&&t.drawBuffers(n),e.depthTexture)&&this.writeDepthTexture){var u=e.depthTexture;this.renderer.texture.bind(u,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!e.stencil&&!e.depth||(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},t.prototype.detectSamples=function(e){var t=this.msaaSamples,r=Za.NONE;if(e<=1||null===t)return r;for(var i=0;i<t.length;i++)if(t[i]<=e){r=t[i];break}return 1===r&&(r=Za.NONE),r},t.prototype.blit=function(e,t,r){var i=this.current,n=this.renderer,o=this.gl,a=this.CONTEXT_UID;if(2===n.context.webGLVersion&&i){var s=i.glFramebuffers[a];if(s){if(!e){if(s.multisample<=1)return;s.blitFramebuffer||(s.blitFramebuffer=new dc(i.width,i.height),s.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(e=s.blitFramebuffer).width=i.width,e.height=i.height}t||((t=_f).width=i.width,t.height=i.height),r||(r=t);var u=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,s.framebuffer),o.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),t||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},t.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)},t.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,i=e.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),t.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new fa},t}(oa),bg=function(){return function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}(),fc={5126:4,5123:2,5121:1},cg=function(e){function t(t){var r=e.call(this,t)||this;return r._activeGeometry=null,r._activeVao=null,r.hasVao=!0,r.hasInstance=!0,r.canUseUInt32ElementIndex=!1,r.managedGeometries={},r.managedBuffers={},r}return ba(t,e),t.prototype.contextChange=function(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){var r=this.renderer.context.extensions.vertexArrayObject;aa.PREFER_ENV===za.WEBGL_LEGACY&&(r=null),r?(e.createVertexArray=function(){return r.createVertexArrayOES()},e.bindVertexArray=function(e){return r.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return r.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){return null},e.bindVertexArray=function(){return null},e.deleteVertexArray=function(){return null})}if(2!==t.webGLVersion){var i=e.getExtension("ANGLE_instanced_arrays");i?(e.vertexAttribDivisor=function(e,t){return i.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,r,n,o){return i.drawElementsInstancedANGLE(e,t,r,n,o)},e.drawArraysInstanced=function(e,t,r,n){return i.drawArraysInstancedANGLE(e,t,r,n)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},t.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,i=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var o=i[t.program.id]||this.initGeometryVao(e,t.program,n);this._activeGeometry=e,this._activeVao!==o&&(this._activeVao=o,this.hasVao?r.bindVertexArray(o):this.activateVao(e,t.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,r=0;r<e.buffers.length;r++){var i=e.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var o=i.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(o,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)t.bufferSubData(o,0,i.data);else{var a=i.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,t.bufferData(o,i.data,a)}}}},t.prototype.checkCompatibility=function(e,t){var r=e.attributes,i=t.attributeData;for(var n in i)if(!r[n])throw new Error("shader and geometry incompatible, geometry missing the \""+n+"\" attribute")},t.prototype.getSignature=function(e,t){var r=e.attributes,i=t.attributeData,n=["g",e.id];for(var o in r)i[o]&&n.push(o);return n.join("-")},t.prototype.initGeometryVao=function(e,t,r){void 0===r&&(r=!0),this.checkCompatibility(e,t);var i=this.gl,n=this.CONTEXT_UID,o=this.getSignature(e,t),a=e.glVertexArrayObjects[this.CONTEXT_UID],s=a[o];if(s)return a[t.id]=s,s;var u=e.buffers,p=e.attributes,h={},$={};for(var l in u)h[l]=0,$[l]=0;for(var l in p)!p[l].size&&t.attributeData[l]?p[l].size=t.attributeData[l].size:p[l].size||console.warn("PIXI Geometry attribute '"+l+"' size cannot be determined (likely the bound shader does not have the attribute)"),h[p[l].buffer]+=p[l].size*fc[p[l].type];for(var l in p){var d=p[l],c=d.size;void 0===d.stride&&(h[d.buffer]===c*fc[d.type]?d.stride=0:d.stride=h[d.buffer]),void 0===d.start&&(d.start=$[d.buffer],$[d.buffer]+=c*fc[d.type])}s=i.createVertexArray(),i.bindVertexArray(s);for(var f=0;f<u.length;f++){var m=u[f];m._glBuffers[n]||(m._glBuffers[n]=new bg(i.createBuffer()),this.managedBuffers[m.id]=m,m.disposeRunner.add(this)),r&&m._glBuffers[n].refCount++}return this.activateVao(e,t),this._activeVao=s,a[t.id]=s,a[o]=s,s},t.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(t||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=e.buffers;if(e.disposeRunner.remove(this),r){for(var o=0;o<n.length;o++){var a=n[o]._glBuffers[this.CONTEXT_UID];a.refCount--,0!==a.refCount||t||this.disposeBuffer(n[o],t)}if(!t)for(var s in r)if("g"===s[0]){var u=r[s];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);t=Object.keys(this.managedBuffers);for(r=0;r<t.length;r++)this.disposeBuffer(this.managedBuffers[t[r]],e)},t.prototype.activateVao=function(e,t){var r=this.gl,i=this.CONTEXT_UID,n=e.buffers,o=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[i].buffer);var a=null;for(var s in o){var u=o[s],p=n[u.buffer]._glBuffers[i];if(t.attributeData[s]){a!==p&&(r.bindBuffer(r.ARRAY_BUFFER,p.buffer),a=p);var h=t.attributeData[s].location;if(r.enableVertexAttribArray(h),r.vertexAttribPointer(h,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(h,1)}}}},t.prototype.draw=function(e,t,r,i){var n=this.gl,o=this._activeGeometry;if(o.indexBuffer){var a=o.indexBuffer.data.BYTES_PER_ELEMENT,s=2===a?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===a||4===a&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(e,t||o.indexBuffer.data.length,s,(r||0)*a,i||1):n.drawElements(e,t||o.indexBuffer.data.length,s,(r||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(e,r,t||o.getSize(),i||1):n.drawArrays(e,r,t||o.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t}(oa),dg=function(){function e(e){void 0===e&&(e=null),this.type=pa.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=pa.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function td(e,t,r){var i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function ud(e,t,r,i){var n=td(e,e.VERTEX_SHADER,t),o=td(e,e.FRAGMENT_SHADER,r),a=e.createProgram();if(e.attachShader(a,n),e.attachShader(a,o),i)for(var s in i)e.bindAttribLocation(a,i[s],s);return e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)||(e.getShaderParameter(n,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(n))),e.getShaderParameter(o,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(a,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(a)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(a)),e.deleteProgram(a),a=null),e.deleteShader(n),e.deleteShader(o),a}function gc(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function vd(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return gc(2*t);case"bvec3":return gc(3*t);case"bvec4":return gc(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);}return null}var wd,xd={},Eb=xd;function yd(){if(Eb===xd||Eb&&Eb.isContextLost()){var e=document.createElement("canvas"),t=void 0;aa.PREFER_ENV>=za.WEBGL2&&(t=e.getContext("webgl2",{})),t||((t=e.getContext("webgl",{})||e.getContext("experimental-webgl",{}))?t.getExtension("WEBGL_draw_buffers"):t=null),Eb=t}return Eb}function eg(){if(!wd){wd=xa.MEDIUM;var e=yd();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);wd=t.precision?xa.HIGH:xa.MEDIUM}}return wd}function zd(e,t,r){if("precision"!==e.substring(0,9)){var i=t;return t===xa.HIGH&&r!==xa.HIGH&&(i=xa.MEDIUM),"precision "+i+" float;\n"+e}return r!==xa.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var fg={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function gg(e){return fg[e]}var hc=null,Ad={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Bd(e,t){if(!hc){var r=Object.keys(Ad);hc={};for(var i=0;i<r.length;++i){var n=r[i];hc[e[n]]=Ad[n]}}return hc[t]}var ic=[{test:function(e){return"float"===e.type&&1===e.size},code:function(e){return"\n            if(uv[\""+e+"\"] !== ud[\""+e+"\"].value)\n            {\n                ud[\""+e+"\"].value = uv[\""+e+"\"]\n                gl.uniform1f(ud[\""+e+"\"].location, uv[\""+e+"\"])\n            }\n            "}},{test:function(e){return("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray},code:function(e){return"t = syncData.textureCount++;\n\n            renderer.texture.bind(uv[\""+e+"\"], t);\n\n            if(ud[\""+e+"\"].value !== t)\n            {\n                ud[\""+e+"\"].value = t;\n                gl.uniform1i(ud[\""+e+"\"].location, t);\n; // eslint-disable-line max-len\n            }"}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&void 0!==t.a},code:function(e){return"\n            gl.uniformMatrix3fv(ud[\""+e+"\"].location, false, uv[\""+e+"\"].toArray(true));\n            "}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&void 0!==t.x},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud[\""+e+"\"].location, v.x, v.y);\n                }"}},{test:function(e){return"vec2"===e.type&&1===e.size},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud[\""+e+"\"].location, v[0], v[1]);\n                }\n            "}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&void 0!==t.width},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud[\""+e+"\"].location, v.x, v.y, v.width, v.height)\n                }"}},{test:function(e){return"vec4"===e.type&&1===e.size},code:function(e){return"\n                cv = ud[\""+e+"\"].value;\n                v = uv[\""+e+"\"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud[\""+e+"\"].location, v[0], v[1], v[2], v[3])\n                }"}}],hg={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},ig={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function jg(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in e.uniforms){var n=t[i];if(n){for(var o=e.uniforms[i],a=!1,s=0;s<ic.length;s++)if(ic[s].test(n,o)){r.push(ic[s].code(i,o)),a=!0;break}if(!a){var u=(1===n.size?hg:ig)[n.type].replace("location","ud[\""+i+"\"].location");r.push("\n            cv = ud[\""+i+"\"].value;\n            v = uv[\""+i+"\"];\n            "+u+";")}}else e.uniforms[i].group&&r.push("\n                    renderer.shader.syncUniformGroup(uv[\""+i+"\"], syncData);\n                ")}return new Function("ud","uv","renderer","syncData",r.join("\n"))}var jc,kg=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function lg(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}function mg(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var i=kg.replace(/%forloop%/gi,lg(e));if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}function ng(){if("boolean"==typeof jc)return jc;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");jc=!0===e({a:"b"},"a","b")}catch(t){jc=!1}return jc}var og="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",pg="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n",qg=0,Fb={},kc=function(){function e(t,r,i){void 0===i&&(i="pixi-shader"),this.id=qg++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=r||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Fb[i]?(Fb[i]++,i+="-"+Fb[i]):Fb[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=zd(this.vertexSrc,aa.PRECISION_VERTEX,xa.HIGH),this.fragmentSrc=zd(this.fragmentSrc,aa.PRECISION_FRAGMENT,eg())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return e.prototype.extractData=function(e,t){var r=yd();if(r){var i=ud(r,e,t);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},e.prototype.getAttributeData=function(e,t){for(var r={},i=[],n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var a=t.getActiveAttrib(e,o),s=Bd(t,a.type),u={type:s,name:a.name,size:gg(s),location:0};r[a.name]=u,i.push(u)}i.sort(function(e,t){return e.name>t.name?1:-1});for(o=0;o<i.length;o++)i[o].location=o;return r},e.prototype.getUniformData=function(e,t){for(var r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=0;n<i;n++){var o=t.getActiveUniform(e,n),a=o.name.replace(/\[.*?\]$/,""),s=o.name.match(/\[.*?\]$/),u=Bd(t,o.type);r[a]={type:u,size:o.size,isArray:s,value:vd(u,o.size)}}return r},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return pg},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return og},enumerable:!1,configurable:!0}),e.from=function(t,r,i){var n=t+r,o=ed[n];return o||(ed[n]=o=new e(t,r,i)),o},e}(),lc=function(){function e(e,t){for(var r in this.program=e,this.uniformGroup=t?t instanceof Pa?t:new Pa(t):new Pa({}),e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var i=t.uniforms[r];if(i.group&&this.checkUniformExists(e,i))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,i){return new e(kc.from(t,r),i)},e}(),mc=0,nc=1,oc=2,pc=3,qc=4,Gb=function(){function e(){this.data=0,this.blendMode=X.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(this.data&1<<mc)},set:function(e){!!(this.data&1<<mc)!==e&&(this.data^=1<<mc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(this.data&1<<nc)},set:function(e){!!(this.data&1<<nc)!==e&&(this.data^=1<<nc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(this.data&1<<oc)},set:function(e){!!(this.data&1<<oc)!==e&&(this.data^=1<<oc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(this.data&1<<pc)},set:function(e){!!(this.data&1<<pc)!==e&&(this.data^=1<<pc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<qc)},set:function(e){!!(this.data&1<<qc)!==e&&(this.data^=1<<qc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==X.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}(),rg="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",sg="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",tg=function(e){function t(r,i,n){var o=this,a=kc.from(r||t.defaultVertexSrc,i||t.defaultFragmentSrc);return(o=e.call(this,a,n)||this).padding=0,o.resolution=aa.FILTER_RESOLUTION,o.enabled=!0,o.autoFit=!0,o.legacy=!!o.program.attributeData.aTextureCoord,o.state=new Gb,o}return ba(t,e),t.prototype.apply=function(e,t,r,i,n){e.applyFilter(this,t,r,i)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return rg},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return sg},enumerable:!1,configurable:!0}),t}(lc),ug="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",vg="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",Cd=new na,wg=function(){function e(e,t){this._texture=e,this.mapCoord=new na,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,i=0;i<e.length;i+=2){var n=e[i],o=e[i+1];t[i]=n*r.a+o*r.c+r.tx,t[i+1]=n*r.b+o*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=t.orig,n=t.trim;n&&(Cd.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Cd));var o=t.baseTexture,a=this.uClampFrame,s=this.clampMargin/o.resolution,u=this.clampOffset;return a[0]=(t._frame.x+s+u)/o.width,a[1]=(t._frame.y+s+u)/o.height,a[2]=(t._frame.x+t._frame.width-s+u)/o.width,a[3]=(t._frame.y+t._frame.height-s+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0},e}(),xg=function(e){function t(t){var r=this,i=new na;return r=e.call(this,ug,vg)||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=i,r}return ba(t,e),t.prototype.apply=function(e,t,r,i){var n=this.maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new wg(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,r,i))},t}(tg),yg=function(e){function t(t){var r=e.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return ba(t,e),t.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},t.prototype.push=function(e,t){var r=t;if(!r.isMaskData){var i=this.maskDataPool.pop()||new dg;i.pooled=!0,i.maskObject=t,r=i}switch(r.autoDetect&&this.detect(r),r.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),r._target=e,r.type){case pa.SCISSOR:this.maskStack.push(r),this.renderer.scissor.push(r);break;case pa.STENCIL:this.maskStack.push(r),this.renderer.stencil.push(r);break;case pa.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r),this.maskStack.push(r);}},t.prototype.pop=function(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case pa.SCISSOR:this.renderer.scissor.pop();break;case pa.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case pa.SPRITE:this.popSpriteMask();}t.reset(),t.pooled&&this.maskDataPool.push(t)}},t.prototype.detect=function(e){var t=e.maskObject;if(t.isSprite)e.type=pa.SPRITE;else if(e.type=pa.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var r=t.worldTransform,i=Math.atan2(r.b,r.a),n=Math.atan2(r.d,r.c);i=Math.round(i*(180/Math.PI)*100),n=((n=Math.round(n*(180/Math.PI)*100)-i)%18e3+18e3)%18e3,0===(i=(i%9e3+9e3)%9e3)&&9e3===n&&(e.type=pa.SCISSOR)}},t.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new xg(t)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=t;var n=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},t.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},t}(oa),Dd=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return ba(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var i=this.getStackLength();i!==r&&(0===i?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(oa),zg=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return ba(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,i=t.getBounds(!0),n=this.renderer.gl;t.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=i,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,o=r.destinationFrame,a=t?t.resolution:this.renderer.resolution,s=(e.x-n.x)*a+o.x,u=(e.y-n.y)*a+o.y,p=e.width*a,h=e.height*a;i&&(s+=i.tx*a,u+=i.ty*a),t||(u=this.renderer.height-h-u),this.renderer.gl.scissor(s,u,p,h)},t}(Dd),Ag=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return ba(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,i=e._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Dd),Bg=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new na,r.transform=null,r}return ba(t,e),t.prototype.update=function(e,t,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,i){var n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=o*(1/t.height*2),n.tx=-1-t.x*n.a,n.ty=-o-t.y*n.d},t.prototype.setTransform=function(e){},t}(oa),Qa=new fa,gb=new fa,hb=new fa,Cg=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new fa,r.destinationFrame=new fa,r}return ba(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var i,n,o,a=this.renderer;this.current=e,e?(o=(i=e.baseTexture).resolution,t||(Qa.width=e.frame.width,Qa.height=e.frame.height,t=Qa),r||(gb.x=e.frame.x,gb.y=e.frame.y,gb.width=t.width,gb.height=t.height,r=gb),n=i.framebuffer):(o=a.resolution,t||(Qa.width=a.screen.width,Qa.height=a.screen.height,t=Qa),r||((r=Qa).width=t.width,r.height=t.height)),hb.x=r.x*o,hb.y=r.y*o,hb.width=r.width*o,hb.height=r.height*o,this.renderer.framebuffer.bind(n,hb),this.renderer.projection.update(r,t,o,!n),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,t){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t)},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(oa),i=function(){return function(){}}(),Dg=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}(),Eg=0,Ed={textureCount:0},Fg=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=Eg++,r}return ba(t,e),t.prototype.systemCheck=function(){if(!ng())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),t||(Ed.textureCount=0,this.syncUniformGroup(e.uniformGroup,Ed)),i},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();e.static&&e.dirtyId===r.uniformGroups[e.id]||(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=jg(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,i=[];for(var n in r)i.push(n),t[n]&&i.push(t[n].type);return i.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var o=ud(t,r.vertexSrc,r.fragmentSrc,i),a={};for(var n in r.uniformData){var s=r.uniformData[n];a[n]={location:t.getUniformLocation(o,n),value:vd(s.type,s.size)}}var u=new Dg(o,a);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(oa);function Gg(e,t){return void 0===t&&(t=[]),t[X.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.ADD]=[e.ONE,e.ONE],t[X.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.NONE]=[0,0],t[X.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[X.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[X.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[X.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[X.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[X.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[X.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[X.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[X.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[X.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[X.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}var Hg=function(e){function t(t){var r=e.call(this,t)||this;return r.gl=null,r.stateId=0,r.polygonOffset=0,r.blendMode=X.NONE,r._blendEq=!1,r.map=[],r.checks=[],r.defaultState=new Gb,r.defaultState.blend=!0,r}return ba(t,e),t.prototype.contextChange=function(e){this.gl=e,this.blendModes=Gg(e),this.set(this.defaultState),this.reset()},t.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,e)},t.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},t.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},t.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)},t.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},t.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},t}(oa),Ig=function(e){function t(t){var r=e.call(this,t)||this;return r.count=0,r.checkCount=0,r.maxIdle=aa.GC_MAX_IDLE,r.checkCountMax=aa.GC_MAX_CHECK_COUNT,r.mode=aa.GC_MODE,r}return ba(t,e),t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Nc.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,i=0;i<t.length;i++){var n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){var o=0;for(i=0;i<t.length;i++)null!==t[i]&&(t[o++]=t[i]);t.length=o}},t.prototype.unload=function(e){var t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(var i=e.children.length-1;i>=0;i--)this.unload(e.children[i])},t}(oa),rc=function(){return function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}}(),Jg=function(e){function t(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new ia,r}return ba(t,e),t.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new rc(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new rc(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},t.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},t.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)},t.prototype.initTexture=function(e){var t=new rc(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},t.prototype.initTextureType=function(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var r=this.renderer.gl;e.type===r.FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA32F),e.type===ta.HALF_FLOAT&&(t.type=r.HALF_FLOAT),t.type===r.HALF_FLOAT&&e.format===r.RGBA&&(t.internalFormat=r.RGBA16F)}},t.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t));else{var i=e.realWidth,n=e.realHeight,o=r.gl;(t.width!==i||t.height!==n||t.dirtyId<0)&&(t.width=i,t.height=n,o.texImage2D(e.target,0,t.internalFormat,i,n,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},t.prototype.destroyTexture=function(e,t){var r=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var i=this.managedTextures.indexOf(e);-1!==i&&vb(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(e){var t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==nb.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=Tb.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},t.prototype.setStyle=function(e,t){var r=this.gl;if(t.mipmap&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===Ba.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&e.anisotropicLevel>0&&e.scaleMode===Ba.LINEAR){var n=Math.min(e.anisotropicLevel,r.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===Ba.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===Ba.LINEAR?r.LINEAR:r.NEAREST)},t}(oa),sc=new na,Kg=function(e){function t(t,r){void 0===t&&(t=lb.UNKNOWN);var i=e.call(this)||this;return(r=Object.assign({},aa.RENDER_OPTIONS,r)).roundPixels&&(aa.ROUND_PIXELS=r.roundPixels,xb("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),i.options=r,i.type=t,i.screen=new fa(0,0,r.width,r.height),i.view=r.view||document.createElement("canvas"),i.resolution=r.resolution||aa.RESOLUTION,i.transparent=r.transparent,i.autoDensity=r.autoDensity||r.autoResize||!1,i.preserveDrawingBuffer=r.preserveDrawingBuffer,i.clearBeforeRender=r.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,0],i._backgroundColorString="#000000",i.backgroundColor=r.backgroundColor||i._backgroundColor,i._lastObjectRendered=null,i.plugins={},i}return ba(t,e),t.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},t.prototype.generateTexture=function(e,t,r,i){0===(i=i||e.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var n=nd.create({width:0|i.width,height:0|i.height,scaleMode:t,resolution:r});return sc.tx=-i.x,sc.ty=-i.y,this.render(e,n,!1,sc,!!e.parent),n},t.prototype.destroy=function(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=lb.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=qf(e),Zb(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),t}(tb.d),j=function(e){function t(r){var i=e.call(this,lb.WEBGL,r)||this;return r=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new ka("destroy"),contextChange:new ka("contextChange"),reset:new ka("reset"),update:new ka("update"),postrender:new ka("postrender"),prerender:new ka("prerender"),resize:new ka("resize")},i.globalUniforms=new Pa({projectionMatrix:new na},!0),i.addSystem(yg,"mask").addSystem(Zf,"context").addSystem(Hg,"state").addSystem(Fg,"shader").addSystem(Jg,"texture").addSystem(cg,"geometry").addSystem(ag,"framebuffer").addSystem(zg,"scissor").addSystem(Ag,"stencil").addSystem(Bg,"projection").addSystem(Ig,"textureGC").addSystem(Xf,"filter").addSystem(Cg,"renderTexture").addSystem(Yf,"batch"),i.initPlugins(t.__plugins),r.context?i.context.initFromContext(r.context):i.context.initFromOptions({alpha:!!i.transparent,antialias:r.antialias,premultipliedAlpha:i.transparent&&"notMultiplied"!==i.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,of(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return ba(t,e),t.create=function(e){if(pf())return new t(e);throw new Error("WebGL unsupported in this browser, use \"pixi.js-legacy\" for fallback canvas2d support.")},t.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error("Whoops! The name \""+t+"\" is already in use");for(var i in this[t]=r,this.runners)this.runners[i].add(r);return this},t.prototype.render=function(e,t,r,i,n){if(this.renderingToScreen=!t,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(t||(this._lastObjectRendered=e),!n){var o=e.enableTempParent();e.updateTransform(),e.disableTempParent(o)}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},t.registerPlugin=function(e,r){t.__plugins=t.__plugins||{},t.__plugins[e]=r},t}(Kg);var tc=function(){return function(){this.texArray=null,this.blend=0,this.type=Aa.TRIANGLES,this.start=0,this.size=0,this.data=null}}(),uc=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},e}(),Lg=function(){function e(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type");}},e}(),Mg=function(e){function t(t){var r=e.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=Gb.for2d(),r.size=4*aa.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return ba(t,e),t.prototype.contextChange=function(){var e=this.renderer.gl;aa.PREFER_ENV===za.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),aa.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=mg(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,r=t._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;e.length<i;)e.push(new tc);for(;r.length<n;)r.push(new uc);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,r=this.MAX_TEXTURES,i=t._textureArrayPool,n=this.renderer.batch,o=this._tempBoundTextures,a=this.renderer.textureGC.count,s=++ia._globalBatch,u=0,p=i[0],h=0;n.copyBoundTextures(o,r);for(var $=0;$<this._bufferSize;++$){var l=e[$];e[$]=null,l._batchEnabled!==s&&(p.count>=r&&(n.boundArray(p,o,s,r),this.buildDrawCalls(p,h,$),h=$,p=i[++u],++s),l._batchEnabled=s,l.touched=a,p.elements[p.count++]=l)}p.count>0&&(n.boundArray(p,o,s,r),this.buildDrawCalls(p,h,this._bufferSize),++u,++s);for($=0;$<o.length;$++)o[$]=null;ia._globalBatch=s},t.prototype.buildDrawCalls=function(e,r,i){var n=this._bufferedElements,o=this._attributeBuffer,a=this._indexBuffer,s=this.vertexSize,u=t._drawCallPool,p=this._dcIndex,h=this._aIndex,$=this._iIndex,l=u[p];l.start=this._iIndex,l.texArray=e;for(var d=r;d<i;++d){var c=n[d],f=c._texture.baseTexture,m=sf[f.alphaMode?1:0][c.blendMode];n[d]=null,r<d&&l.blend!==m&&(l.size=$-l.start,r=d,(l=u[++p]).texArray=e,l.start=$),this.packInterleavedGeometry(c,o,a,h,$),h+=c.vertexData.length/2*s,$+=c.indices.length,l.blend=m}r<i&&(l.size=$-l.start,++p),this._dcIndex=p,this._aIndex=h,this._iIndex=$},t.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this._packedGeometries,t=this._attributeBuffer,r=this._indexBuffer;aa.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(t.rawBinaryData),e[this._flushId]._indexBuffer.update(r),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,r=this.renderer,i=r.gl,n=r.state,o=t._drawCallPool,a=null,s=0;s<e;s++){var u=o[s],p=u.texArray,h=u.type,$=u.size,l=u.start,d=u.blend;a!==p&&(a=p,this.bindAndClearTexArray(p)),this.state.blendMode=d,n.set(this.state),i.drawElements(h,$,i.UNSIGNED_SHORT,2*l)}},t.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),aa.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var t=ub(Math.ceil(e/8)),r=cd(t),i=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new Lg(i*this.vertexSize*4)),n},t.prototype.getIndexBuffer=function(e){var t=ub(Math.ceil(e/12)),r=cd(t),i=12*t;this._iBuffers.length<=r&&(this._iBuffers.length=r+1);var n=this._iBuffers[r];return n||(this._iBuffers[r]=n=new Uint16Array(i)),n},t.prototype.packInterleavedGeometry=function(e,t,r,i,n){for(var o=t.uint32View,a=t.float32View,s=i/this.vertexSize,u=e.uvs,p=e.indices,h=e.vertexData,$=e._texture.baseTexture._batchLocation,l=Math.min(e.worldAlpha,1),d=l<1&&e._texture.baseTexture.alphaMode?ad(e._tintRGB,l):e._tintRGB+(255*l<<24),c=0;c<h.length;c+=2)a[i++]=h[c],a[i++]=h[c+1],a[i++]=u[c],a[i++]=u[c+1],o[i++]=d,a[i++]=$;for(c=0;c<p.length;c++)r[n++]=s+p[c]},t._drawCallPool=[],t._textureArrayPool=[],t}(rd),Ng=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error("Fragment template must contain \"%count%\".");if(t.indexOf("%forloop%")<0)throw new Error("Fragment template must contain \"%forloop%\".")}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=Pa.from({uSamplers:t},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new kc(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new na,default:this.defaultGroupCache[e]};return new lc(this.programCache[e],n)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"},e}(),Fd=function(e){function t(t){void 0===t&&(t=!1);var r=e.call(this)||this;return r._buffer=new sa(null,t,!1),r._indexBuffer=new sa(null,t,!0),r.addAttribute("aVertexPosition",r._buffer,2,!1,ta.FLOAT).addAttribute("aTextureCoord",r._buffer,2,!1,ta.FLOAT).addAttribute("aColor",r._buffer,4,!0,ta.UNSIGNED_BYTE).addAttribute("aTextureId",r._buffer,1,!0,ta.FLOAT).addIndex(r._indexBuffer),r}return ba(t,e),t}(ec),Gd="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Hd="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Og=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:Gd,fragment:Hd,geometryClass:Fd,vertexSize:6},e),r=t.vertex,i=t.fragment,n=t.vertexSize,o=t.geometryClass;return function(e){function t(t){var a=e.call(this,t)||this;return a.shaderGenerator=new Ng(r,i),a.geometryClass=o,a.vertexSize=n,a}return ba(t,e),t}(Mg)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return Gd},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return Hd},enumerable:!1,configurable:!0}),e}(),k=Og.create();aa.SORTABLE_CHILDREN=!1;var Hb=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?fa.EMPTY:((t=t||new fa(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,n=s>n?s:n,r=o>r?o:r,this.minX=e,this.minY=i,this.maxX=n,this.maxY=r},t.prototype.addFrame=function(t,e,i,n,r){this.addFrameMatrix(t.worldTransform,e,i,n,r)},t.prototype.addFrameMatrix=function(t,e,i,n,r){var s=t.a,o=t.b,a=t.c,h=t.d,p=t.tx,l=t.ty,d=this.minX,m=this.minY,u=this.maxX,c=this.maxY,f=s*e+a*i+p,y=o*e+h*i+l;d=f<d?f:d,m=y<m?y:m,u=f>u?f:u,c=y>c?y:c,d=(f=s*n+a*i+p)<d?f:d,m=(y=o*n+h*i+l)<m?y:m,u=f>u?f:u,c=y>c?y:c,d=(f=s*e+a*r+p)<d?f:d,m=(y=o*e+h*r+l)<m?y:m,u=f>u?f:u,c=y>c?y:c,d=(f=s*n+a*r+p)<d?f:d,m=(y=o*n+h*r+l)<m?y:m,u=f>u?f:u,c=y>c?y:c,this.minX=d,this.minY=m,this.maxX=u,this.maxY=c},t.prototype.addVertexData=function(t,e,i){for(var n=this.minX,r=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],p=t[a+1];n=h<n?h:n,r=p<r?p:r,s=h>s?h:s,o=p>o?p:o}this.minX=n,this.minY=r,this.maxX=s,this.maxY=o},t.prototype.addVertices=function(t,e,i,n){this.addVerticesMatrix(t.worldTransform,e,i,n)},t.prototype.addVerticesMatrix=function(t,e,i,n,r,s){void 0===r&&(r=0),void 0===s&&(s=r);for(var o=t.a,a=t.b,h=t.c,p=t.d,l=t.tx,d=t.ty,m=this.minX,u=this.minY,c=this.maxX,f=this.maxY,y=i;y<n;y+=2){var b=e[y],x=e[y+1],$=o*b+h*x+l,v=p*x+a*b+d;m=Math.min(m,$-r),c=Math.max(c,$+r),u=Math.min(u,v-s),f=Math.max(f,v+s)}this.minX=m,this.minY=u,this.maxX=c,this.maxY=f},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=r&&n<=s){var o=this.minX,a=this.minY,h=this.maxX,p=this.maxY;this.minX=i<o?i:o,this.minY=n<a?n:a,this.maxX=r>h?r:h,this.maxY=s>p?s:p}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=r&&n<=s){var o=this.minX,a=this.minY,h=this.maxX,p=this.maxY;this.minX=i<o?i:o,this.minY=n<a?n:a,this.maxX=r>h?r:h,this.maxY=s>p?s:p}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,i,n,r,s){t-=r,e-=s,i+=r,n+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n},t}(),Pg=function(t,e){return(Pg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function vc(t,e){function i(){this.constructor=t}Pg(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Ib=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Df,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Hb,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return vc(e,t),e.mixin=function(t){for(var i=Object.keys(t),n=0;n<i.length;++n){var r=i[n];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new fa),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new fa),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Hb);var e=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var s=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=n,this._bounds.updateID+=this._boundsID-r,s},e.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,i,n,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=r,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new Qg),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*xf},set:function(t){this.transform.rotation=t*yf},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1);(this._mask=t,this._mask)&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),e}(tb.d),Qg=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return vc(e,t),e}(Ib);function Rg(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}Ib.prototype.displayObjectUpdateTransform=Ib.prototype.updateTransform;var wc=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=aa.SORTABLE_CHILDREN,e.sortDirty=!1,e}return vc(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var n=0;n<e.length;n++)this.addChild(e[n]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(t);vb(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var n=0;n<e.length;n++)this.removeChild(e[n]);else{var r=e[0],s=this.children.indexOf(r);if(-1===s)return null;r.parent=null,r.transform._parentID=-1,vb(this.children,s,1),this._boundsID++,this.onChildrenChange(s),r.emit("removed",this),this.emit("childRemoved",r,this,s)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,vb(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var i,n=t,r=e-n;if(r>0&&r<=e){i=this.children.splice(n,r);for(var s=0;s<i.length;++s)i[s].parent=null,i[s].transform&&(i[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(s=0;s<i.length;++s)i[s].emit("removed",this),this.emit("childRemoved",i[s],this,s);return i}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var n=this.children[e];n._lastSortedIndex=e,t||0===n.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(Rg),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,i){void 0===i&&(i=!1);var n=t.prototype.getLocalBounds.call(this,e);if(!i)for(var r=0,s=this.children.length;r<s;++r){var o=this.children[r];o.visible&&o.updateTransform()}return n},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);n=0;for(var r=this.children.length;n<r;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof e?e:e&&e.children,n=this.removeChildren(0,this.children.length);if(i)for(var r=0;r<n.length;++r)n[r].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(Ib);wc.prototype.containerUpdateTransform=wc.prototype.updateTransform;(function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"})(Ga||($d=Ga={},$d)),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(Ha||(Zd=Ha={},Zd));var ib={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var r=Math.ceil(t/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}},Id=function(){function t(){this.color=16777215,this.alpha=1,this.texture=la.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=la.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Sg=function(t,e){return(Sg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Jb(t,e){function r(){this.constructor=t}Sg(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Jd={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var r=t.points,i=t.holes,a=e.points,n=e.indices;if(r.length>=6){for(var s=[],l=0;l<i.length;l++){var o=i[l];s.push(r.length/2),r=r.concat(o.points)}var h=Zc.d(r,s,2);if(!h)return;var $=a.length/2;for(l=0;l<h.length;l+=3)n.push(h[l]+$),n.push(h[l+1]+$),n.push(h[l+2]+$);for(l=0;l<r.length;l++)a.push(r[l])}}},Kd={build:function(t){var e,r,i=t.shape,a=t.points,n=i.x,s=i.y;if(a.length=0,t.type===ea.CIRC)e=i.radius,r=i.radius;else{var l=t.shape;e=l.width,r=l.height}if(0!==e&&0!==r){var o=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(e+r));o/=2.3;for(var h=2*Math.PI/o,$=0;$<o-.5;$++)a.push(n+Math.sin(-h*$)*e,s+Math.cos(-h*$)*r);a.push(a[0],a[1])}},triangulate:function(t,e){var r=t.points,i=e.points,a=e.indices,n=i.length/2,s=n,l=t.shape,o=t.matrix,h=l.x,$=l.y;i.push(t.matrix?o.a*h+o.c*$+o.tx:h,t.matrix?o.b*h+o.d*$+o.ty:$);for(var u=0;u<r.length;u+=2)i.push(r[u],r[u+1]),a.push(n++,s,n)}},Tg={build:function(t){var e=t.shape,r=e.x,i=e.y,a=e.width,n=e.height,s=t.points;s.length=0,s.push(r,i,r+a,i,r+a,i+n,r,i+n)},triangulate:function(t,e){var r=t.points,i=e.points,a=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),e.indices.push(a,a+1,a+2,a+1,a+2,a+3)}};function Wa(t,e,r){return t+(e-t)*r}function Kb(t,e,r,i,a,n,s){void 0===s&&(s=[]);for(var l=s,o=0,h=0,$=0,u=0,p=0,c=0,x=0,d=0;x<=20;++x)o=Wa(t,r,d=x/20),h=Wa(e,i,d),$=Wa(r,a,d),u=Wa(i,n,d),p=Wa(o,$,d),c=Wa(h,u,d),l.push(p,c);return l}var Ug={build:function(t){var e=t.shape,r=t.points,i=e.x,a=e.y,n=e.width,s=e.height,l=Math.max(0,Math.min(e.radius,Math.min(n,s)/2));r.length=0,l?(Kb(i,a+l,i,a,i+l,a,r),Kb(i+n-l,a,i+n,a,i+n,a+l,r),Kb(i+n,a+s-l,i+n,a+s,i+n-l,a+s,r),Kb(i+l,a+s,i,a+s,i,a+s-l,r)):r.push(i,a,i+n,a,i+n,a+s,i,a+s)},triangulate:function(t,e){for(var r=t.points,i=e.points,a=e.indices,n=i.length/2,s=Zc.d(r,null,2),l=0,o=s.length;l<o;l+=3)a.push(s[l]+n),a.push(s[l+1]+n),a.push(s[l+2]+n);for(l=0,o=r.length;l<o;l++)i.push(r[l],r[++l])}};function Ld(t,e,r,i,a,n,s,l){var o,h;s?(o=i,h=-r):(o=-i,h=r);var $=t-r*a+o,u=e-i*a+h,p=t+r*n+o,c=e+i*n+h;return l.push($,u),l.push(p,c),2}function Xa(t,e,r,i,a,n,s,l){var o=r-t,h=i-e,$=Math.atan2(o,h),u=Math.atan2(a-t,n-e);l&&$<u?$+=2*Math.PI:!l&&$>u&&(u+=2*Math.PI);var p=$,c=u-$,x=Math.abs(c),d=Math.sqrt(o*o+h*h),v=1+(15*x*Math.sqrt(d)/Math.PI>>0),f=c/v;if(p+=f,l){s.push(t,e),s.push(r,i);for(var N=1,y=p;N<v;N++,y+=f)s.push(t,e),s.push(t+Math.sin(y)*d,e+Math.cos(y)*d);s.push(t,e),s.push(a,n)}else{s.push(r,i),s.push(t,e);for(N=1,y=p;N<v;N++,y+=f)s.push(t+Math.sin(y)*d,e+Math.cos(y)*d),s.push(t,e);s.push(a,n),s.push(t,e)}return 2*v}function Vg(t,e){var r=t.shape,i=t.points||r.points.slice(),a=e.closePointEps;if(0!==i.length){var n=t.lineStyle,s=new Ea(i[0],i[1]),l=new Ea(i[i.length-2],i[i.length-1]),o=r.type!==ea.POLY||r.closeStroke,h=Math.abs(s.x-l.x)<a&&Math.abs(s.y-l.y)<a;if(o){i=i.slice(),h&&(i.pop(),i.pop(),l.set(i[i.length-2],i[i.length-1]));var $=.5*(s.x+l.x),u=.5*(l.y+s.y);i.unshift($,u),i.push($,u)}var p=e.points,c=i.length/2,x=i.length,d=p.length/2,v=n.width/2,f=v*v,N=n.miterLimit*n.miterLimit,y=i[0],g=i[1],m=i[2],K=i[3],b=0,_=0,P=-(g-K),S=y-m,A=0,w=0,E=Math.sqrt(P*P+S*S);P/=E,S/=E,P*=v,S*=v;var L=n.alignment,M=2*(1-L),C=2*L;o||(n.cap===Ha.ROUND?x+=Xa(y-P*(M-C)*.5,g-S*(M-C)*.5,y-P*M,g-S*M,y+P*C,g+S*C,p,!0)+2:n.cap===Ha.SQUARE&&(x+=Ld(y,g,P,S,M,C,!0,p))),p.push(y-P*M,g-S*M),p.push(y+P*C,g+S*C);for(var I=1;I<c-1;++I){y=i[2*(I-1)],g=i[2*(I-1)+1],m=i[2*I],K=i[2*I+1],b=i[2*(I+1)],_=i[2*(I+1)+1],P=-(g-K),S=y-m,P/=E=Math.sqrt(P*P+S*S),S/=E,P*=v,S*=v,A=-(K-_),w=m-b,A/=E=Math.sqrt(A*A+w*w),w/=E,A*=v,w*=v;var D=m-y,T=g-K,R=m-b,O=_-K,B=T*R-O*D,U=B<0;if(Math.abs(B)<.1)p.push(m-P*M,K-S*M),p.push(m+P*C,K+S*C);else{var H=(-P+y)*(-S+K)-(-P+m)*(-S+g),F=(-A+b)*(-w+K)-(-A+m)*(-w+_),G=(D*F-R*H)/B,q=(O*H-T*F)/B,j=(G-m)*(G-m)+(q-K)*(q-K),z=m+(G-m)*M,W=K+(q-K)*M,k=m-(G-m)*C,V=K-(q-K)*C,J=U?M:C;j<=Math.min(D*D+T*T,R*R+O*O)+J*J*f?n.join===Ga.BEVEL||j/f>N?(U?(p.push(z,W),p.push(m+P*C,K+S*C),p.push(z,W),p.push(m+A*C,K+w*C)):(p.push(m-P*M,K-S*M),p.push(k,V),p.push(m-A*M,K-w*M),p.push(k,V)),x+=2):n.join===Ga.ROUND?U?(p.push(z,W),p.push(m+P*C,K+S*C),x+=Xa(m,K,m+P*C,K+S*C,m+A*C,K+w*C,p,!0)+4,p.push(z,W),p.push(m+A*C,K+w*C)):(p.push(m-P*M,K-S*M),p.push(k,V),x+=Xa(m,K,m-P*M,K-S*M,m-A*M,K-w*M,p,!1)+4,p.push(m-A*M,K-w*M),p.push(k,V)):(p.push(z,W),p.push(k,V)):(p.push(m-P*M,K-S*M),p.push(m+P*C,K+S*C),n.join===Ga.BEVEL||j/f>N||(n.join===Ga.ROUND?x+=U?Xa(m,K,m+P*C,K+S*C,m+A*C,K+w*C,p,!0)+2:Xa(m,K,m-P*M,K-S*M,m-A*M,K-w*M,p,!1)+2:(U?(p.push(k,V),p.push(k,V)):(p.push(z,W),p.push(z,W)),x+=2)),p.push(m-A*M,K-w*M),p.push(m+A*C,K+w*C),x+=2)}}y=i[2*(c-2)],g=i[2*(c-2)+1],m=i[2*(c-1)],P=-(g-(K=i[2*(c-1)+1])),S=y-m,P/=E=Math.sqrt(P*P+S*S),S/=E,P*=v,S*=v,p.push(m-P*M,K-S*M),p.push(m+P*C,K+S*C),o||(n.cap===Ha.ROUND?x+=Xa(m-P*(M-C)*.5,K-S*(M-C)*.5,m-P*M,K-S*M,m+P*C,K+S*C,p,!1)+2:n.cap===Ha.SQUARE&&(x+=Ld(m,K,P,S,M,C,!1,p)));var Y=e.indices,Q=ib.epsilon*ib.epsilon;for(I=d;I<x+d-2;++I)y=p[2*I],g=p[2*I+1],m=p[2*(I+1)],K=p[2*(I+1)+1],b=p[2*(I+2)],_=p[2*(I+2)+1],Math.abs(y*(K-_)+m*(_-g)+b*(g-K))<Q||Y.push(I,I+1,I+2)}}function Wg(t,e){var r=0,i=t.shape,a=t.points||i.points,n=i.type!==ea.POLY||i.closeStroke;if(0!==a.length){var s=e.points,l=e.indices,o=a.length/2,h=s.length/2,$=h;for(s.push(a[0],a[1]),r=1;r<o;r++)s.push(a[2*r],a[2*r+1]),l.push($,$+1),$++;n&&l.push($,h)}}function Md(t,e){t.lineStyle.native?Wg(t,e):Vg(t,e)}var jb,Xg=function(t){function e(e,r,i,a,n,s){void 0===s&&(s=0);n=n||a/2;for(var l=-1*Math.PI/2+s,o=2*i,h=eb/o,$=[],u=0;u<o;u++){var p=u%2?n:a,c=u*h+l;$.push(e+p*Math.cos(c),r+p*Math.sin(c))}return t.call(this,$)||this}return Jb(e,t),e}(zb),Nd=function(){function t(){}return t.curveTo=function(t,e,r,i,a,n){var s=n[n.length-2],l=n[n.length-1]-e,o=s-t,h=i-e,$=r-t,u=Math.abs(l*$-o*h);if(u<1e-8||0===a)return n[n.length-2]===t&&n[n.length-1]===e||n.push(t,e),null;var p=l*l+o*o,c=h*h+$*$,x=l*h+o*$,d=a*Math.sqrt(p)/u,v=a*Math.sqrt(c)/u,f=d*x/p,N=v*x/c,y=d*$+v*o,g=d*h+v*l,m=o*(v+f),K=l*(v+f),b=$*(d+N),_=h*(d+N);return{cx:y+t,cy:g+e,radius:a,startAngle:Math.atan2(K-g,m-y),endAngle:Math.atan2(_-g,b-y),anticlockwise:o*h>$*l}},t.arc=function(t,e,r,i,a,n,s,l,o){for(var h=s-n,$=ib._segmentsCount(Math.abs(h)*a,40*Math.ceil(Math.abs(h)/eb)),u=h/(2*$),p=2*u,c=Math.cos(u),x=Math.sin(u),d=$-1,v=d%1/d,f=0;f<=d;++f){var N=u+n+p*(f+v*f),y=Math.cos(N),g=-Math.sin(N);o.push((c*y+x*g)*a+r,(c*-g+x*y)*a+i)}},t}(),Yg=function(){function t(){}return t.curveLength=function(t,e,r,i,a,n,s,l){for(var o=0,h=0,$=0,u=0,p=0,c=0,x=0,d=0,v=0,f=0,N=0,y=t,g=e,m=1;m<=10;++m)f=y-(d=(x=(c=(p=1-(h=m/10))*p)*p)*t+3*c*h*r+3*p*($=h*h)*a+(u=$*h)*s),N=g-(v=x*e+3*c*h*i+3*p*$*n+u*l),y=d,g=v,o+=Math.sqrt(f*f+N*N);return o},t.curveTo=function(e,r,i,a,n,s,l){var o=l[l.length-2],h=l[l.length-1];l.length-=2;var $=ib._segmentsCount(t.curveLength(o,h,e,r,i,a,n,s)),u=0,p=0,c=0,x=0,d=0;l.push(o,h);for(var v=1,f=0;v<=$;++v)c=(p=(u=1-(f=v/$))*u)*u,d=(x=f*f)*f,l.push(c*o+3*p*f*e+3*u*x*i+d*n,c*h+3*p*f*r+3*u*x*a+d*s)},t}(),Zg=function(){function t(){}return t.curveLength=function(t,e,r,i,a,n){var s=t-2*r+a,l=e-2*i+n,o=2*r-2*t,h=2*i-2*e,$=4*(s*s+l*l),u=4*(s*o+l*h),p=o*o+h*h,c=2*Math.sqrt($+u+p),x=Math.sqrt($),d=2*$*x,v=2*Math.sqrt(p),f=u/x;return(d*c+x*u*(c-v)+(4*p*$-u*u)*Math.log((2*x+f+c)/(f+v)))/(4*d)},t.curveTo=function(e,r,i,a,n){for(var s=n[n.length-2],l=n[n.length-1],o=ib._segmentsCount(t.curveLength(s,l,e,r,i,a)),h=0,$=0,u=1;u<=o;++u){var p=u/o;h=s+(e-s)*p,$=l+(r-l)*p,n.push(h+(e+(i-e)*p-h)*p,$+(r+(a-r)*p-$)*p)}},t}(),$g=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),xc=((jb={})[ea.POLY]=Jd,jb[ea.CIRC]=Kd,jb[ea.ELIP]=Kd,jb[ea.RECT]=Tg,jb[ea.RREC]=Ug,jb),Od=[],Lb=[],Pd=function(){function t(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=i,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),Ya=new Ea,_g=new Hb,ah=function(t){function e(){var e=t.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new Hb,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return Jb(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Lb.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Od.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,r,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null);var a=new Pd(t,e,r,i);return this.graphicsData.push(a),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var r=new Pd(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,r=0;r<e.length;++r){var i=e[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,Ya):Ya.copyFrom(t),i.shape.contains(Ya.x,Ya.y))){var a=!1;if(i.holes)for(var n=0;n<i.holes.length;n++){if(i.holes[n].shape.contains(Ya.x,Ya.y)){a=!0;break}}if(!a)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,r=this.graphicsData,i=null,a=null;this.batches.length>0&&(a=(i=this.batches[this.batches.length-1]).style);for(var n=this.shapeIndex;n<r.length;n++){this.shapeIndex++;var s=r[n],l=s.fillStyle,o=s.lineStyle;xc[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var h=0;h<2;h++){var $=0===h?l:o;if($.visible){var u=$.texture.baseTexture,p=this.indices.length,c=this.points.length/2;u.wrapMode=Tb.REPEAT,0===h?this.processFill(s):this.processLine(s);var x=this.points.length/2-c;0!==x&&(i&&!this._compareStyles(a,$)&&(i.end(p,c),i=null),i||((i=Od.pop()||new $g).begin($,p,c),this.batches.push(i),a=$),this.addUvs(this.points,e,$.texture,c,x,$.matrix))}}}var d=this.indices.length,v=this.points.length/2;if(i&&i.end(d,v),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var f=v>65535&&t;this.indicesUint16=f?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&t.texture.baseTexture===e.texture.baseTexture&&t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var r=this.graphicsData[t],i=r.fillStyle,a=r.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(a&&!a.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,r=t.length;e<r;e++)for(var i=t[e],a=0;a<i.size;a++){var n=i.start+a;this.indicesUint16[n]=this.indicesUint16[n]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,r=0;r<t.length;r++)if(t[r].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++ia._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Lb.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,i=this.textureIds,a=Lb.pop();a||((a=new tc).texArray=new uc),a.texArray.count=0,a.start=0,a.size=0,a.type=Aa.TRIANGLES;var n=0,s=null,l=0,o=!1,h=Aa.TRIANGLES,$=0;this.drawCalls.push(a);for(e=0;e<this.batches.length;e++){var u=this.batches[e],p=u.style,c=p.texture.baseTexture;o!==!!p.native&&(h=(o=!!p.native)?Aa.LINES:Aa.TRIANGLES,s=null,n=8,t++),s!==c&&(s=c,c._batchEnabled!==t&&(8===n&&(t++,n=0,a.size>0&&((a=Lb.pop())||((a=new tc).texArray=new uc),this.drawCalls.push(a)),a.start=$,a.size=0,a.texArray.count=0,a.type=h),c.touched=1,c._batchEnabled=t,c._batchLocation=n,c.wrapMode=10497,a.texArray.elements[a.texArray.count++]=c,n++)),a.size+=u.size,$+=u.size,l=c._batchLocation,this.addColors(r,p.color,p.alpha,u.attribSize),this.addTextureIds(i,l,u.attribSize)}ia._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,r=this.colors,i=this.textureIds,a=new ArrayBuffer(3*t.length*4),n=new Float32Array(a),s=new Uint32Array(a),l=0,o=0;o<t.length/2;o++)n[l++]=t[2*o],n[l++]=t[2*o+1],n[l++]=e[2*o],n[l++]=e[2*o+1],s[l++]=r[o],n[l++]=i[o];this._buffer.update(a),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),Jd.triangulate(t,this)):xc[t.type].triangulate(t,this)},e.prototype.processLine=function(t){Md(t,this);for(var e=0;e<t.holes.length;e++)Md(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var r=t[e];xc[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=_g,r=na.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var a=this.graphicsData[i],n=a.shape,s=a.type,l=a.lineStyle,o=a.matrix||na.IDENTITY,h=0;if(l&&l.visible){var $=l.alignment;h=l.width,s===ea.POLY?h*=.5+Math.abs(.5-$):h*=Math.max(0,$)}if(r!==o&&(e.isEmpty()||(t.addBoundsMatrix(e,r),e.clear()),r=o),s===ea.RECT||s===ea.RREC){var u=n;e.addFramePad(u.x,u.y,u.x+u.width,u.y+u.height,h,h)}else if(s===ea.CIRC){var p=n;e.addFramePad(p.x,p.y,p.x,p.y,p.radius+h,p.radius+h)}else if(s===ea.ELIP){var c=n;e.addFramePad(c.x,c.y,c.x,c.y,c.width+h,c.height+h)}else{var x=n;t.addVerticesMatrix(r,x.points,0,x.points.length,h,h)}}e.isEmpty()||t.addBoundsMatrix(e,r),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var r=0;r<t.length/2;r++){var i=t[2*r],a=t[2*r+1];t[2*r]=e.a*i+e.c*a+e.tx,t[2*r+1]=e.b*i+e.d*a+e.ty}},e.prototype.addColors=function(t,e,r,i){for(var a=ad((e>>16)+(65280&e)+((255&e)<<16),r);i-->0;)t.push(a)},e.prototype.addTextureIds=function(t,e,r){for(;r-->0;)t.push(e)},e.prototype.addUvs=function(t,e,r,i,a,n){void 0===n&&(n=null);for(var s=0,l=e.length,o=r.frame;s<a;){var h=t[2*(i+s)],$=t[2*(i+s)+1];if(n){var u=n.a*h+n.c*$+n.tx;$=n.b*h+n.d*$+n.ty,h=u}s++,e.push(h/o.width,$/o.height)}var p=r.baseTexture;(o.width<p.width||o.height<p.height)&&this.adjustUvs(e,r,l,a)},e.prototype.adjustUvs=function(t,e,r,i){for(var a=e.baseTexture,n=r+2*i,s=e.frame,l=s.width/a.width,o=s.height/a.height,h=s.x/s.width,$=s.y/s.height,u=Math.floor(t[r]+1e-6),p=Math.floor(t[r+1]+1e-6),c=r+2;c<n;c+=2)u=Math.min(u,Math.floor(t[c]+1e-6)),p=Math.min(p,Math.floor(t[c+1]+1e-6));h-=u,$-=p;for(c=r;c<n;c+=2)t[c]=(t[c]+h)*l,t[c+1]=(t[c+1]+$)*o},e.BATCHABLE_SIZE=100,e}(Fd),bh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Ha.BUTT,e.join=Ga.MITER,e.miterLimit=10,e}return Jb(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(Id),ch=new Float32Array(3),yc={},dh=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r._geometry=e||new ah,r._geometry.refCount++,r.shader=null,r.state=Gb.for2d(),r._fillStyle=new Id,r._lineStyle=new bh,r._matrix=null,r._holeMode=!1,r.currentPath=null,r.batches=[],r.batchTint=-1,r.batchDirty=-1,r.vertexData=null,r.pluginName="batch",r._transformID=-1,r.tint=16777215,r.blendMode=X.NORMAL,r}return Jb(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t){if(void 0===t&&(t=null),"number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){if("number"==typeof t){xb("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var e=arguments,r=e[0],i=e[1],a=e[2],n=e[3],s=e[4],l=e[5],o=e[6];t={width:r,texture:i,color:a,alpha:n,matrix:s,alignment:l,native:o},Object.keys(t).forEach(function(e){return void 0===t[e]&&delete t[e]})}t=Object.assign({width:0,texture:la.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Ha.BUTT,join:Ga.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var h=t.width>0&&t.alpha>0;return h?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:h},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new zb,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new zb,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var r=this.currentPath.points,i=r[r.length-2],a=r[r.length-1];return i===t&&a===e||r.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,r,i){this._initCurve();var a=this.currentPath.points;return 0===a.length&&this.moveTo(0,0),Zg.curveTo(t,e,r,i,a),this},e.prototype.bezierCurveTo=function(t,e,r,i,a,n){return this._initCurve(),Yg.curveTo(t,e,r,i,a,n,this.currentPath.points),this},e.prototype.arcTo=function(t,e,r,i,a){this._initCurve(t,e);var n=this.currentPath.points,s=Nd.curveTo(t,e,r,i,a,n);if(s){var l=s.cx,o=s.cy,h=s.radius,$=s.startAngle,u=s.endAngle,p=s.anticlockwise;this.arc(l,o,h,$,u,p)}return this},e.prototype.arc=function(t,e,r,i,a,n){if(void 0===n&&(n=!1),i===a)return this;if(!n&&a<=i?a+=eb:n&&i<=a&&(i+=eb),0===a-i)return this;var s=t+Math.cos(i)*r,l=e+Math.sin(i)*r,o=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;if(h){var $=Math.abs(h[h.length-2]-s),u=Math.abs(h[h.length-1]-l);$<o&&u<o||h.push(s,l)}else this.moveTo(s,l),h=this.currentPath.points;return Nd.arc(s,l,t,e,r,i,a,n,h),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:la.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){if(t instanceof la){xb("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments,r=e[0],i=e[1],a=e[2],n=e[3];t={texture:r,color:i,alpha:a,matrix:n},Object.keys(t).forEach(function(e){return void 0===t[e]&&delete t[e]})}t=Object.assign({texture:la.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var s=t.alpha>0;return s?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:s},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,r,i){return this.drawShape(new fa(t,e,r,i))},e.prototype.drawRoundedRect=function(t,e,r,i,a){return this.drawShape(new Bf(t,e,r,i,a))},e.prototype.drawCircle=function(t,e,r){return this.drawShape(new zf(t,e,r))},e.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new Af(t,e,r,i))},e.prototype.drawPolygon=function(){for(var t,e=arguments,r=[],i=0;i<arguments.length;i++)r[i]=e[i];var a=!0,n=r[0];n.points?(a=n.closeStroke,t=n.points):t=Array.isArray(r[0])?r[0]:r;var s=new zb(t);return s.closeStroke=a,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.drawStar=function(t,e,r,i,a,n){return void 0===n&&(n=0),this.drawPolygon(new Xg(t,e,r,i,a,n))},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===ea.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,r=t.context.supports.uint32Indices;e.updateBatches(r),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,r=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(t.points);for(var i=0;i<r;i++){var a=t.batches[i],n=a.style.color,s=new Float32Array(this.vertexData.buffer,4*a.attribStart*2,2*a.attribSize),l=new Float32Array(t.uvsFloat32.buffer,4*a.attribStart*2,2*a.attribSize),o={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*a.start,a.size),uvs:l,_batchRGB:Zb(n),_tintRGB:n,_texture:a.style.texture,alpha:a.style.alpha,worldAlpha:1};this.batches[i]=o}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,r=this.batches.length;e<r;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),r=this._geometry,i=this.tint,a=this.worldAlpha,n=e.uniforms,s=r.drawCalls;n.translationMatrix=this.transform.worldTransform,n.tint[0]=(i>>16&255)/255*a,n.tint[1]=(i>>8&255)/255*a,n.tint[2]=(255&i)/255*a,n.tint[3]=a,t.shader.bind(e),t.geometry.bind(r,e),t.state.set(this.state);for(var l=0,o=s.length;l<o;l++)this._renderDrawCallDirect(t,r.drawCalls[l])},e.prototype._renderDrawCallDirect=function(t,e){for(var r=e.texArray,i=e.type,a=e.size,n=e.start,s=r.count,l=0;l<s;l++)t.texture.bind(r.elements[l],l);t.geometry.draw(i,a,n)},e.prototype._resolveDirectShader=function(t){var e=this.shader,r=this.pluginName;if(!e){if(!yc[r]){for(var i=t.plugins.batch.MAX_TEXTURES,a=new Int32Array(i),n=0;n<i;n++)a[n]=n;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new na,default:Pa.from({uSamplers:a},!0)},l=t.plugins[r]._shader.program;yc[r]=new lc(l,s)}e=yc[r]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,r=e.minX,i=e.minY,a=e.maxX,n=e.maxY;this._bounds.addFrame(this.transform,r,i,a,n)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Zb(this.tint,ch),e=0;e<this.batches.length;e++){var r=this.batches[e],i=r._batchRGB,a=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);r._tintRGB=(a>>16)+(65280&a)+((255&a)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,r=e.a,i=e.b,a=e.c,n=e.d,s=e.tx,l=e.ty,o=this._geometry.points,h=this.vertexData,$=0,u=0;u<o.length;u+=2){var p=o[u],c=o[u+1];h[$++]=r*p+a*c+s,h[$++]=n*c+i*p+l}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e._TEMP_POINT=new Ea,e}(wc);var eh=Pb&&Pb.__extends||function(){var t=function(i,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(i,r)};return function(i,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=i}t(i,r),i.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),fh=window.PIXI?window.PIXI.Graphics:dh,Qd=function(t){function i(i,r,o){void 0===r&&(r={});var s=t.call(this)||this;s.graphicsOptions={x:0,y:0,width:100,height:100,fill:0,lineWidth:1,lineColor:16777215},s.graphicsOptions=Object.assign(s.graphicsOptions,i),s.physicsOptions=r;var p=s.graphicsOptions.width/2,n=s.graphicsOptions.height/2;return s.pivot.x=p,s.pivot.y=n,s._update=o,s.graphicsOptions.radius?s._body=ha.Bodies.circle(s.graphicsOptions.x,s.graphicsOptions.y,s.graphicsOptions.radius,s.physicsOptions):s._body=ha.Bodies.rectangle(s.graphicsOptions.x+p,s.graphicsOptions.y+n,s.graphicsOptions.width,s.graphicsOptions.height,s.physicsOptions),s}return eh(i,t),Object.defineProperty(i.prototype,"body",{get:function(){return this._body},enumerable:!1,configurable:!0}),i.prototype.update=function(){this._update({position:this._body.position,rotation:this._body.angle})},i}(fh);Pb.PhysicsGraphics=Qd;var Rd=ra&&ra.__assign||function(){return(Rd=Object.assign||function(r){for(var n,e=1,t=arguments.length;e<t;e++)for(var i in n=arguments[e])Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i]);return r}).apply(this,arguments)},Sd=ra&&ra.__spreadArray||function(r,n){for(var e=0,t=n.length,i=r.length;e<t;e++,i++)r[i]=n[e];return r};function Td(r,n){return window[n]?Promise.resolve(window[n]):new Promise(function(e,t){var i=document.createElement("script");i.onload=function(){e(n&&window.varName)},i.onerror=function(r){i.onload=null,i.onerror=null,document.body.removeChild(i),t(r)},i.src=r,i.async=!0,document.body.appendChild(i)})}function gh(r,n){Array.isArray(n)&&(n.x=n[0],n.y=n[1],n.width=0,n.height=0),r.centerX=r.x+r.width/2,r.centerY=r.y+r.height/2,n.centerX=n.x+n.width/2,n.centerY=n.y+n.height/2,r.halfWidth=r.width/2,r.halfHeight=r.height/2,n.halfWidth=n.width/2,n.halfHeight=n.height/2;var e=r.centerX-n.centerX,t=r.centerY-n.centerY,i=r.halfWidth+n.halfWidth,a=r.halfHeight+n.halfHeight;return Math.abs(e)<i&&Math.abs(t)<a}ra.loadScript=Td,ra.hitTestRectangle=gh;var zc={};function hh(r){function n(r){var n;return Array.isArray(r)&&(n=Sd([],r),r=n[0]),new Promise(function(e,t){window.PIXI.utils.TextureCache[r]?e(window.PIXI.utils.TextureCache[r]):window.PIXI.loader.add(n||r).load(function(){var n=window.PIXI.loader.resources[r].texture;e(n)})})}return /\.json$/.test(r)?zc[r]?n(zc[r]):fetch(r).then(function(r){return r.json()}).then(function(e){var t=r.replace("index.json",""),i=e.map(function(r){return t+r});return zc[r]=i,n(i)}):n(r)}ra.textureRecources=hh;var ga=window.Sk,ih=function(r){return ga.misceval.callsimOrSuspend(ga.builtins.property,new ga.builtin.func(r),new ga.builtin.func(function(){}))};function Ud(r,n){var e=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];n||(t=new ga.builtins.tuple(t));var a=new ga.builtin.dict(e);return r(t,a)};return e.co_kwargs=!0,e}ra.defineGetter=ih,ra.genkwaFunc=Ud;var Vd=function(r,n){return ga.misceval.callsimOrSuspend(ga.builtins.property,new ga.builtin.func(function(e){return"function"==typeof r?r(e):ga.ffi.remapToPy(e[r][n])}),new ga.builtin.func(function(e,t){"function"==typeof n?n(e,t):e[r][n]=t.v}))};ra.defineProperty=Vd;var jh=function(r,n,e,t){return new ga.builtin.func(function(n){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];return ga.misceval.callsimOrSuspend(ga.misceval.buildClass(r,function(r,a){a.__init__=new ga.builtin.func(function(r){r.graph=new PIXI.Graphics;var e=r.graph;t.apply(void 0,Sd([n,e],i));var a=r.graph.width/2,$=r.graph.height/2,o=r.graph.graphicsData[0].shape.x,p=r.graph.graphicsData[0].shape.y;r.graph.isCircle?(r.graph.pivot.set(2*a,2*$),r.graph.position.set(2*a,2*a)):(r.graph.pivot.set(o+a,p+$),r.graph.position.set(o+a,p+$))}),a.rotation=Vd(function(r){return ga.ffi.remapToPy(r.rotation)},function(r,n){r.physicGraphics?ha.Body.setAngle(r.physicGraphics._body,n.v):r.graph.rotation=n.v}),a.physicsImpostor=new ga.builtin.func(Ud(function(r,n){n=ga.ffi.remapToJs(n);var t=r[0],i=r[1],a=r[2];i=ga.ffi.remapToJs(i||n.is_static)||!1;var $=!1;a=ga.ffi.remapToJs(a||n.physicsOptions)||{};var o=t.graph,p=o.graphicsData,s=o.width,c=o.height,h=o.line,u=o.rotation,l={};t.graph.isCircle&&($=!0,l.radius=p[0].shape.radius),t.graph.isFilled&&(l.fill=p[0].fillStyle.color),t.physicGraphics=new Qd(Rd({x:p[0].shape.x,y:p[0].shape.y,width:s,height:c,lineWidth:h.width,lineColor:h.color},l),Rd({isCircle:$,isStatic:i},a),function(r){var n=r.position,e=r.rotation;t.graph.position=n,t.graph.rotation=e}),ha.Body.setAngle(t.physicGraphics._body,u),e.addToWorld(t.physicGraphics)},!0))}))})};ra.upgradeGraphics=jh;var kh=window.Sk,Wd={"./pgzrun/__init__.js":"https://cdn.jsdelivr.net/gh/lipten/skulpt-pygame-zero@physics-engine/dist/pygame-zero.js"},Xd={load:function(e){return kh.misceval.promiseToSuspension(new Promise(function(n,t){Td("https://cdn.bootcdn.net/ajax/libs/pixi.js/5.3.4/pixi.min.js","PIXI").then(function(){fetch(Wd[e]).then(function(e){var t=e.text();n(t)})})}))},matchModelName:function(e){return Object.keys(Wd).includes(e)},setContainer:function(e){this.container=e},_onRunning:function(e){this.app=e}};Nb.PyGameZero=Xd,window.PyGameZero=Xd;if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=Nb}else if(typeof define==="function"&&define.amd){define(function(){return Nb})}})();